function bnsls2
fprintf('   Loading AT lattice (%s)\n', mfilename);

global THERING
Energy = 3.0e9;
%GLOBVAL.E0 = Energy;  % This might disappear in the future
%GLOBVAL.LatticeFile = 'bnsls2';
%FAMLIST=cell(0);
AP = aperture('AP',1000*[-0.035, 0.035, -0.017, 0.017],'AperturePass');
L0 =   158.391580;  %1.584e+02;	% design length  [m]
C0 =   299792458; 	% speed of light [m/s]
HarmNumber = 264;
RF	= rfcavity('RF' , 0, 1.2e6, HarmNumber*C0/L0, HarmNumber ,'CavityPass');
BD1=rbend('BD', 1.300000, 0.146452, 0.073226, 0.073226, [-0.554856,  -4.303332, 0.0], 'BndMPoleSymplectic4Pass');
BD2=rbend('BD', 1.300000, 0.146452, 0.073226, 0.073226, [-0.554856,  -4.303332, 0.0], 'BndMPoleSymplectic4Pass');
BF =rbend('BF', 1.240000, 0.057025, 0.028513, 0.028513, [ 0.820065,   3.602693, 0.0], 'BndMPoleSymplectic4Pass');
QD=quadrupole('QD0', 0.300000,  -1.309077677853, 'StrMPoleSymplectic4Pass');
QF=quadrupole('QF0', 0.300000,   2.007214978555, 'StrMPoleSymplectic4Pass');
QG=quadrupole('QG0', 0.300000,   1.223904061423, 'StrMPoleSymplectic4Pass');
A1SF1=sextupole('SF0', 0.120000,   0.481808158147, 'StrMPoleSymplectic4Pass');
A1SF2=sextupole('SF0', 0.120000,   0.481808158147, 'StrMPoleSymplectic4Pass');
A2SF1=sextupole('SF0', 0.120000,   0.481808158147, 'StrMPoleSymplectic4Pass');
A2SF2=sextupole('SF0', 0.120000,   0.481808158147, 'StrMPoleSymplectic4Pass');
A3SF1=sextupole('SF0', 0.120000,   0.481808158147, 'StrMPoleSymplectic4Pass');
A3SF2=sextupole('SF0', 0.120000,   0.481808158147, 'StrMPoleSymplectic4Pass');
A4SF1=sextupole('SF0', 0.120000,   0.481808158147, 'StrMPoleSymplectic4Pass');
A4SF2=sextupole('SF0', 0.120000,   0.481808158147, 'StrMPoleSymplectic4Pass');
A1SD1=sextupole('SD0', 0.120000,  -0.504049330456, 'StrMPoleSymplectic4Pass');
A1SD2=sextupole('SD0', 0.120000,  -0.504049330456, 'StrMPoleSymplectic4Pass');
A2SD1=sextupole('SD0', 0.120000,  -0.504049330456, 'StrMPoleSymplectic4Pass');
A2SD2=sextupole('SD0', 0.120000,  -0.504049330456, 'StrMPoleSymplectic4Pass');
A3SD1=sextupole('SD0', 0.120000,  -0.504049330456, 'StrMPoleSymplectic4Pass');
A3SD2=sextupole('SD0', 0.120000,  -0.504049330456, 'StrMPoleSymplectic4Pass');
A4SD1=sextupole('SD0', 0.120000,  -0.504049330456, 'StrMPoleSymplectic4Pass');
A4SD2=sextupole('SD0', 0.120000,  -0.504049330456, 'StrMPoleSymplectic4Pass');
ISP20 = monitor('BPM','IdentityPass');
ISP2FU = drift('MON1', 0.020000, 'DriftPass');
ISP2FD = drift('MON2', 0.020000, 'DriftPass');
ISP2 = [ISP2FU,ISP20,ISP2FD];
A1P10 = monitor('BPM','IdentityPass');
A1P1FU = drift('MON1', 0.020000, 'DriftPass');
A1P1FD = drift('MON2', 0.020000, 'DriftPass');
A1P1 = [A1P1FU,A1P10,A1P1FD];
A1P20 = monitor('BPM','IdentityPass');
A1P2FU = drift('MON1', 0.020000, 'DriftPass');
A1P2FD = drift('MON2', 0.020000, 'DriftPass');
A1P2 = [A1P2FU,A1P20,A1P2FD];
A1P30 = monitor('BPM','IdentityPass');
A1P3FU = drift('MON1', 0.020000, 'DriftPass');
A1P3FD = drift('MON2', 0.020000, 'DriftPass');
A1P3 = [A1P3FU,A1P30,A1P3FD];
A1P40 = monitor('BPM','IdentityPass');
A1P4FU = drift('MON1', 0.020000, 'DriftPass');
A1P4FD = drift('MON2', 0.020000, 'DriftPass');
A1P4 = [A1P4FU,A1P40,A1P4FD];
A1P50 = monitor('BPM','IdentityPass');
A1P5FU = drift('MON1', 0.020000, 'DriftPass');
A1P5FD = drift('MON2', 0.020000, 'DriftPass');
A1P5 = [A1P5FU,A1P50,A1P5FD];
A1P60 = monitor('BPM','IdentityPass');
A1P6FU = drift('MON1', 0.020000, 'DriftPass');
A1P6FD = drift('MON2', 0.020000, 'DriftPass');
A1P6 = [A1P6FU,A1P60,A1P6FD];
A1P70 = monitor('BPM','IdentityPass');
A1P7FU = drift('MON1', 0.020000, 'DriftPass');
A1P7FD = drift('MON2', 0.020000, 'DriftPass');
A1P7 = [A1P7FU,A1P70,A1P7FD];
DSP10 = monitor('BPM','IdentityPass');
DSP1FU = drift('MON1', 0.020000, 'DriftPass');
DSP1FD = drift('MON2', 0.020000, 'DriftPass');
DSP1 = [DSP1FU,DSP10,DSP1FD];
DSP20 = monitor('BPM','IdentityPass');
DSP2FU = drift('MON1', 0.020000, 'DriftPass');
DSP2FD = drift('MON2', 0.020000, 'DriftPass');
DSP2 = [DSP2FU,DSP20,DSP2FD];
A2P10 = monitor('BPM','IdentityPass');
A2P1FU = drift('MON1', 0.020000, 'DriftPass');
A2P1FD = drift('MON2', 0.020000, 'DriftPass');
A2P1 = [A2P1FU,A2P10,A2P1FD];
A2P20 = monitor('BPM','IdentityPass');
A2P2FU = drift('MON1', 0.020000, 'DriftPass');
A2P2FD = drift('MON2', 0.020000, 'DriftPass');
A2P2 = [A2P2FU,A2P20,A2P2FD];
A2P30 = monitor('BPM','IdentityPass');
A2P3FU = drift('MON1', 0.020000, 'DriftPass');
A2P3FD = drift('MON2', 0.020000, 'DriftPass');
A2P3 = [A2P3FU,A2P30,A2P3FD];
A2P40 = monitor('BPM','IdentityPass');
A2P4FU = drift('MON1', 0.020000, 'DriftPass');
A2P4FD = drift('MON2', 0.020000, 'DriftPass');
A2P4 = [A2P4FU,A2P40,A2P4FD];
A2P50 = monitor('BPM','IdentityPass');
A2P5FU = drift('MON1', 0.020000, 'DriftPass');
A2P5FD = drift('MON2', 0.020000, 'DriftPass');
A2P5 = [A2P5FU,A2P50,A2P5FD];
A2P60 = monitor('BPM','IdentityPass');
A2P6FU = drift('MON1', 0.020000, 'DriftPass');
A2P6FD = drift('MON2', 0.020000, 'DriftPass');
A2P6 = [A2P6FU,A2P60,A2P6FD];
A2P70 = monitor('BPM','IdentityPass');
A2P7FU = drift('MON1', 0.020000, 'DriftPass');
A2P7FD = drift('MON2', 0.020000, 'DriftPass');
A2P7 = [A2P7FU,A2P70,A2P7FD];
CSP10 = monitor('BPM','IdentityPass');
CSP1FU = drift('MON1', 0.020000, 'DriftPass');
CSP1FD = drift('MON2', 0.020000, 'DriftPass');
CSP1 = [CSP1FU,CSP10,CSP1FD];
CSP20 = monitor('BPM','IdentityPass');
CSP2FU = drift('MON1', 0.020000, 'DriftPass');
CSP2FD = drift('MON2', 0.020000, 'DriftPass');
CSP2 = [CSP2FU,CSP20,CSP2FD];
A3P10 = monitor('BPM','IdentityPass');
A3P1FU = drift('MON1', 0.020000, 'DriftPass');
A3P1FD = drift('MON2', 0.020000, 'DriftPass');
A3P1 = [A3P1FU,A3P10,A3P1FD];
A3P20 = monitor('BPM','IdentityPass');
A3P2FU = drift('MON1', 0.020000, 'DriftPass');
A3P2FD = drift('MON2', 0.020000, 'DriftPass');
A3P2 = [A3P2FU,A3P20,A3P2FD];
A3P30 = monitor('BPM','IdentityPass');
A3P3FU = drift('MON1', 0.020000, 'DriftPass');
A3P3FD = drift('MON2', 0.020000, 'DriftPass');
A3P3 = [A3P3FU,A3P30,A3P3FD];
A3P40 = monitor('BPM','IdentityPass');
A3P4FU = drift('MON1', 0.020000, 'DriftPass');
A3P4FD = drift('MON2', 0.020000, 'DriftPass');
A3P4 = [A3P4FU,A3P40,A3P4FD];
A3P50 = monitor('BPM','IdentityPass');
A3P5FU = drift('MON1', 0.020000, 'DriftPass');
A3P5FD = drift('MON2', 0.020000, 'DriftPass');
A3P5 = [A3P5FU,A3P50,A3P5FD];
A3P60 = monitor('BPM','IdentityPass');
A3P6FU = drift('MON1', 0.020000, 'DriftPass');
A3P6FD = drift('MON2', 0.020000, 'DriftPass');
A3P6 = [A3P6FU,A3P60,A3P6FD];
A3P70 = monitor('BPM','IdentityPass');
A3P7FU = drift('MON1', 0.020000, 'DriftPass');
A3P7FD = drift('MON2', 0.020000, 'DriftPass');
A3P7 = [A3P7FU,A3P70,A3P7FD];
XSP10 = monitor('BPM','IdentityPass');
XSP1FU = drift('MON1', 0.020000, 'DriftPass');
XSP1FD = drift('MON2', 0.020000, 'DriftPass');
XSP1 = [XSP1FU,XSP10,XSP1FD];
XSP20 = monitor('BPM','IdentityPass');
XSP2FU = drift('MON1', 0.020000, 'DriftPass');
XSP2FD = drift('MON2', 0.020000, 'DriftPass');
XSP2 = [XSP2FU,XSP20,XSP2FD];
A4P10 = monitor('BPM','IdentityPass');
A4P1FU = drift('MON1', 0.020000, 'DriftPass');
A4P1FD = drift('MON2', 0.020000, 'DriftPass');
A4P1 = [A4P1FU,A4P10,A4P1FD];
A4P20 = monitor('BPM','IdentityPass');
A4P2FU = drift('MON1', 0.020000, 'DriftPass');
A4P2FD = drift('MON2', 0.020000, 'DriftPass');
A4P2 = [A4P2FU,A4P20,A4P2FD];
A4P30 = monitor('BPM','IdentityPass');
A4P3FU = drift('MON1', 0.020000, 'DriftPass');
A4P3FD = drift('MON2', 0.020000, 'DriftPass');
A4P3 = [A4P3FU,A4P30,A4P3FD];
A4P40 = monitor('BPM','IdentityPass');
A4P4FU = drift('MON1', 0.020000, 'DriftPass');
A4P4FD = drift('MON2', 0.020000, 'DriftPass');
A4P4 = [A4P4FU,A4P40,A4P4FD];
A4P50 = monitor('BPM','IdentityPass');
A4P5FU = drift('MON1', 0.020000, 'DriftPass');
A4P5FD = drift('MON2', 0.020000, 'DriftPass');
A4P5 = [A4P5FU,A4P50,A4P5FD];
A4P60 = monitor('BPM','IdentityPass');
A4P6FU = drift('MON1', 0.020000, 'DriftPass');
A4P6FD = drift('MON2', 0.020000, 'DriftPass');
A4P6 = [A4P6FU,A4P60,A4P6FD];
A4P70 = monitor('BPM','IdentityPass');
A4P7FU = drift('MON1', 0.020000, 'DriftPass');
A4P7FD = drift('MON2', 0.020000, 'DriftPass');
A4P7 = [A4P7FU,A4P70,A4P7FD];
ISP10 = monitor('BPM','IdentityPass');
ISP1FU = drift('MON1', 0.020000, 'DriftPass');
ISP1FD = drift('MON2', 0.020000, 'DriftPass');
ISP1 = [ISP1FU,ISP10,ISP1FD];
ISCXW20=corrector('CH', 0, [0 0], 'CorrectorPass');
ISCXW2FU = drift('MON3H', 0.075000, 'DriftPass');
ISCXW2FD = drift('MON4H', 0.075000, 'DriftPass');
ISCXW2 = [ISCXW2FU,ISCXW20,ISCXW2FD];
A1CX10=corrector('CH', 0, [0 0], 'CorrectorPass');
A1CX1FU = drift('MON3H', 0.075000, 'DriftPass');
A1CX1FD = drift('MON4H', 0.075000, 'DriftPass');
A1CX1 = [A1CX1FU,A1CX10,A1CX1FD];
A1CX20=corrector('CH', 0, [0 0], 'CorrectorPass');
A1CX2FU = drift('MON3H', 0.075000, 'DriftPass');
A1CX2FD = drift('MON4H', 0.075000, 'DriftPass');
A1CX2 = [A1CX2FU,A1CX20,A1CX2FD];
A1CX30=corrector('CH', 0, [0 0], 'CorrectorPass');
A1CX3FU = drift('MON3H', 0.075000, 'DriftPass');
A1CX3FD = drift('MON4H', 0.075000, 'DriftPass');
A1CX3 = [A1CX3FU,A1CX30,A1CX3FD];
DSCXW10=corrector('CH', 0, [0 0], 'CorrectorPass');
DSCXW1FU = drift('MON3H', 0.075000, 'DriftPass');
DSCXW1FD = drift('MON4H', 0.075000, 'DriftPass');
DSCXW1 = [DSCXW1FU,DSCXW10,DSCXW1FD];
DSCXW20=corrector('CH', 0, [0 0], 'CorrectorPass');
DSCXW2FU = drift('MON3H', 0.075000, 'DriftPass');
DSCXW2FD = drift('MON4H', 0.075000, 'DriftPass');
DSCXW2 = [DSCXW2FU,DSCXW20,DSCXW2FD];
A2CX10=corrector('CH', 0, [0 0], 'CorrectorPass');
A2CX1FU = drift('MON3H', 0.075000, 'DriftPass');
A2CX1FD = drift('MON4H', 0.075000, 'DriftPass');
A2CX1 = [A2CX1FU,A2CX10,A2CX1FD];
A2CX20=corrector('CH', 0, [0 0], 'CorrectorPass');
A2CX2FU = drift('MON3H', 0.075000, 'DriftPass');
A2CX2FD = drift('MON4H', 0.075000, 'DriftPass');
A2CX2 = [A2CX2FU,A2CX20,A2CX2FD];
A2CX30=corrector('CH', 0, [0 0], 'CorrectorPass');
A2CX3FU = drift('MON3H', 0.075000, 'DriftPass');
A2CX3FD = drift('MON4H', 0.075000, 'DriftPass');
A2CX3 = [A2CX3FU,A2CX30,A2CX3FD];
XSCXW10=corrector('CH', 0, [0 0], 'CorrectorPass');
XSCXW1FU = drift('MON3H', 0.075000, 'DriftPass');
XSCXW1FD = drift('MON4H', 0.075000, 'DriftPass');
XSCXW1 = [XSCXW1FU,XSCXW10,XSCXW1FD];
XSCXW20=corrector('CH', 0, [0 0], 'CorrectorPass');
XSCXW2FU = drift('MON3H', 0.075000, 'DriftPass');
XSCXW2FD = drift('MON4H', 0.075000, 'DriftPass');
XSCXW2 = [XSCXW2FU,XSCXW20,XSCXW2FD];
A3CX10=corrector('CH', 0, [0 0], 'CorrectorPass');
A3CX1FU = drift('MON3H', 0.075000, 'DriftPass');
A3CX1FD = drift('MON4H', 0.075000, 'DriftPass');
A3CX1 = [A3CX1FU,A3CX10,A3CX1FD];
A3CX20=corrector('CH', 0, [0 0], 'CorrectorPass');
A3CX2FU = drift('MON3H', 0.075000, 'DriftPass');
A3CX2FD = drift('MON4H', 0.075000, 'DriftPass');
A3CX2 = [A3CX2FU,A3CX20,A3CX2FD];
A3CX30=corrector('CH', 0, [0 0], 'CorrectorPass');
A3CX3FU = drift('MON3H', 0.075000, 'DriftPass');
A3CX3FD = drift('MON4H', 0.075000, 'DriftPass');
A3CX3 = [A3CX3FU,A3CX30,A3CX3FD];
CSCXW10=corrector('CH', 0, [0 0], 'CorrectorPass');
CSCXW1FU = drift('MON3H', 0.075000, 'DriftPass');
CSCXW1FD = drift('MON4H', 0.075000, 'DriftPass');
CSCXW1 = [CSCXW1FU,CSCXW10,CSCXW1FD];
CSCXW20=corrector('CH', 0, [0 0], 'CorrectorPass');
CSCXW2FU = drift('MON3H', 0.075000, 'DriftPass');
CSCXW2FD = drift('MON4H', 0.075000, 'DriftPass');
CSCXW2 = [CSCXW2FU,CSCXW20,CSCXW2FD];
A4CX10=corrector('CH', 0, [0 0], 'CorrectorPass');
A4CX1FU = drift('MON3H', 0.075000, 'DriftPass');
A4CX1FD = drift('MON4H', 0.075000, 'DriftPass');
A4CX1 = [A4CX1FU,A4CX10,A4CX1FD];
A4CX20=corrector('CH', 0, [0 0], 'CorrectorPass');
A4CX2FU = drift('MON3H', 0.075000, 'DriftPass');
A4CX2FD = drift('MON4H', 0.075000, 'DriftPass');
A4CX2 = [A4CX2FU,A4CX20,A4CX2FD];
A4CX30=corrector('CH', 0, [0 0], 'CorrectorPass');
A4CX3FU = drift('MON3H', 0.075000, 'DriftPass');
A4CX3FD = drift('MON4H', 0.075000, 'DriftPass');
A4CX3 = [A4CX3FU,A4CX30,A4CX3FD];
ISCXW10=corrector('CH', 0, [0 0], 'CorrectorPass');
ISCXW1FU = drift('MON3H', 0.075000, 'DriftPass');
ISCXW1FD = drift('MON4H', 0.075000, 'DriftPass');
ISCXW1 = [ISCXW1FU,ISCXW10,ISCXW1FD];
A1CY10=corrector('CV', 0, [0 0], 'CorrectorPass');
A1CY1FU = drift('MON3V', 0.075000, 'DriftPass');
A1CY1FD = drift('MON4V', 0.075000, 'DriftPass');
A1CY1 = [A1CY1FU,A1CY10,A1CY1FD];
A1CY20=corrector('CV', 0, [0 0], 'CorrectorPass');
A1CY2FU = drift('MON3V', 0.075000, 'DriftPass');
A1CY2FD = drift('MON4V', 0.075000, 'DriftPass');
A1CY2 = [A1CY2FU,A1CY20,A1CY2FD];
A1CY30=corrector('CV', 0, [0 0], 'CorrectorPass');
A1CY3FU = drift('MON3V', 0.075000, 'DriftPass');
A1CY3FD = drift('MON4V', 0.075000, 'DriftPass');
A1CY3 = [A1CY3FU,A1CY30,A1CY3FD];
A1CY40=corrector('CV', 0, [0 0], 'CorrectorPass');
A1CY4FU = drift('MON3V', 0.075000, 'DriftPass');
A1CY4FD = drift('MON4V', 0.075000, 'DriftPass');
A1CY4 = [A1CY4FU,A1CY40,A1CY4FD];
A2CY10=corrector('CV', 0, [0 0], 'CorrectorPass');
A2CY1FU = drift('MON3V', 0.075000, 'DriftPass');
A2CY1FD = drift('MON4V', 0.075000, 'DriftPass');
A2CY1 = [A2CY1FU,A2CY10,A2CY1FD];
A2CY20=corrector('CV', 0, [0 0], 'CorrectorPass');
A2CY2FU = drift('MON3V', 0.075000, 'DriftPass');
A2CY2FD = drift('MON4V', 0.075000, 'DriftPass');
A2CY2 = [A2CY2FU,A2CY20,A2CY2FD];
A2CY30=corrector('CV', 0, [0 0], 'CorrectorPass');
A2CY3FU = drift('MON3V', 0.075000, 'DriftPass');
A2CY3FD = drift('MON4V', 0.075000, 'DriftPass');
A2CY3 = [A2CY3FU,A2CY30,A2CY3FD];
A2CY40=corrector('CV', 0, [0 0], 'CorrectorPass');
A2CY4FU = drift('MON3V', 0.075000, 'DriftPass');
A2CY4FD = drift('MON4V', 0.075000, 'DriftPass');
A2CY4 = [A2CY4FU,A2CY40,A2CY4FD];
A3CY10=corrector('CV', 0, [0 0], 'CorrectorPass');
A3CY1FU = drift('MON3V', 0.075000, 'DriftPass');
A3CY1FD = drift('MON4V', 0.075000, 'DriftPass');
A3CY1 = [A3CY1FU,A3CY10,A3CY1FD];
A3CY20=corrector('CV', 0, [0 0], 'CorrectorPass');
A3CY2FU = drift('MON3V', 0.075000, 'DriftPass');
A3CY2FD = drift('MON4V', 0.075000, 'DriftPass');
A3CY2 = [A3CY2FU,A3CY20,A3CY2FD];
A3CY30=corrector('CV', 0, [0 0], 'CorrectorPass');
A3CY3FU = drift('MON3V', 0.075000, 'DriftPass');
A3CY3FD = drift('MON4V', 0.075000, 'DriftPass');
A3CY3 = [A3CY3FU,A3CY30,A3CY3FD];
A3CY40=corrector('CV', 0, [0 0], 'CorrectorPass');
A3CY4FU = drift('MON3V', 0.075000, 'DriftPass');
A3CY4FD = drift('MON4V', 0.075000, 'DriftPass');
A3CY4 = [A3CY4FU,A3CY40,A3CY4FD];
A4CY10=corrector('CV', 0, [0 0], 'CorrectorPass');
A4CY1FU = drift('MON3V', 0.075000, 'DriftPass');
A4CY1FD = drift('MON4V', 0.075000, 'DriftPass');
A4CY1 = [A4CY1FU,A4CY10,A4CY1FD];
A4CY20=corrector('CV', 0, [0 0], 'CorrectorPass');
A4CY2FU = drift('MON3V', 0.075000, 'DriftPass');
A4CY2FD = drift('MON4V', 0.075000, 'DriftPass');
A4CY2 = [A4CY2FU,A4CY20,A4CY2FD];
A4CY30=corrector('CV', 0, [0 0], 'CorrectorPass');
A4CY3FU = drift('MON3V', 0.075000, 'DriftPass');
A4CY3FD = drift('MON4V', 0.075000, 'DriftPass');
A4CY3 = [A4CY3FU,A4CY30,A4CY3FD];
A4CY40=corrector('CV', 0, [0 0], 'CorrectorPass');
A4CY4FU = drift('MON3V', 0.075000, 'DriftPass');
A4CY4FD = drift('MON4V', 0.075000, 'DriftPass');
A4CY4 = [A4CY4FU,A4CY40,A4CY4FD];
KCK=drift('KCK', 0.775000, 'DriftPass');
B1=drift('B1', 0.200000, 'DriftPass');
B2=drift('B2', 0.200000, 'DriftPass');
B3=drift('B3', 0.200000, 'DriftPass');
B4=drift('B4', 0.200000, 'DriftPass');
BR1=drift('BR1', 0.200000, 'DriftPass');
BR2=drift('BR2', 0.200000, 'DriftPass');
BR3=drift('BR3', 0.200000, 'DriftPass');
BR4=drift('BR4', 0.200000, 'DriftPass');
DB=drift('DB', 0.413000, 'DriftPass');
DBM=drift('DBM', 0.410895, 'DriftPass');
D1=drift('D1', 0.465000, 'DriftPass');
DAIN1=drift('DAIN1', 0.515000, 'DriftPass');
DAIN2=drift('DAIN2', 0.985000, 'DriftPass');
DAIN3=drift('DAIN3', 1.370000, 'DriftPass');
DAIN4=drift('DAIN4', 0.200000, 'DriftPass');
DAIN5=drift('DAIN5', 0.200000, 'DriftPass');
DAIN6=drift('DAIN6', 0.450000, 'DriftPass');
DQ1=drift('DQ1', 0.285000, 'DriftPass');
DQ2=drift('DQ2', 0.096000, 'DriftPass');
DQ3=drift('DQ3', 0.200000, 'DriftPass');
DQ4=drift('DQ4', 0.180000, 'DriftPass');
DQ5=drift('DQ5', 0.180000, 'DriftPass');
DQ6=drift('DQ6', 0.200000, 'DriftPass');
DQKM=drift('DQKM', 0.421000, 'DriftPass');
DQK=drift('DQK', 0.510000, 'DriftPass');
DS1=drift('DS1', 0.170000, 'DriftPass');
DS2=drift('DS2', 0.170000, 'DriftPass');
DS3=drift('DS3', 0.100000, 'DriftPass');
DKMX=drift('DKMX', 0.173500, 'DriftPass');
DKMY=drift('DKMY', 0.173500, 'DriftPass');
DKMM=drift('DKMM', 0.228500, 'DriftPass');
DA1=drift('DA1', 0.200000, 'DriftPass');
DA2=drift('DA2', 1.770000, 'DriftPass');
DA3=drift('DA3', 2.150000, 'DriftPass');
DAEX1=drift('DAEX1', 0.200000, 'DriftPass');
DAEX2=drift('DAEX2', 0.275000, 'DriftPass');
DAEX3=drift('DAEX3', 0.275000, 'DriftPass');
DAEX4=drift('DAEX4', 0.700000, 'DriftPass');
DAEX5=drift('DAEX5', 0.200000, 'DriftPass');
DAEX6=drift('DAEX6', 0.300000, 'DriftPass');
DAEX7=drift('DAEX7', 0.995000, 'DriftPass');
KICKD=drift('KICKD', 0.775000, 'DriftPass');
MK1 = monitor('MK1','IdentityPass');
MK2 = monitor('MK2','IdentityPass');
INJ = monitor('INJ','IdentityPass');
EXTR = monitor('EXTR','IdentityPass');
IS2=[MK1, DAIN1, INJ, DAIN2, BR3, DAIN3, ISP2, DAIN4, BR4, DAIN5, ...
ISCXW2, DAIN6];
A1=[QF, DBM, BD1, DQ1, A1P1, DQ2, A1CY1, DQ3, QG, DQ4, A1CX1, DQ5, QD, ...
DQ6, BF, DS1, A1SF1, DS2, A1P2, DS3, BD1, DKMX, A1CX2, DKMX, BF, DKMM, A1P3, ...
DKMM, BD1, DKMY, A1CY2, DKMY, BF, DS1, A1SD1, DS2, A1P4, DS3, BD1, D1, BF, D1, ...
BD1, DS1, A1SD2, DS2, A1P5, DS3, BF, DKMY, A1CY3, DKMY, BD1, DKMM, A1P6, DKMM, ...
BF, DKMX, A1CX3, DKMX, BD1, DS1, A1SF2, DS2, A1P7, DS3, BF, DQ6, QD, DQK, QG, ...
DQ3, A1CY4, DQKM, BD1, DB, QF];
DS=[DA1, DSCXW1, DA2, DSP1, DA3, MK2, MK1, DA3, DSP2, DA2, DSCXW2, DA1];

A2=[QF, DB, BD1, DQKM, A2CY1, DQ3, QG, DQK, QD, DQ6, BF, DS1, A2SF1, DS2, ...
A2P1, DS3, BD1, DKMX, A2CX1, DKMX, BF, DKMM, A2P2, DKMM, BD1, DKMY, A2CY2, ...
DKMY, BF, DS1, A2SD1, DS2, A2P3, DS3, BD1, D1, BF, D1, BD1, DS1, A2SD2, DS2, ...
A2P4, DS3, BF, DKMY, A2CY3, DKMY, BD1, DKMM, A2P5, DKMM, BF, DKMX, A2CX2, DKMX, ...
BD1, DS1, A2SF2, DS2, A2P6, DS3, BF, DQ6, QD, DQ5, A2CX3, DQ4, QG, DQ3, A2CY4, ...
DQ2, A2P7, DQ1, BD1, DBM, QF];
XS=[DAEX1, B1, DAEX2, KCK, DAEX3, XSCXW1, DAEX4, XSP1, DAEX5, B2, DAEX6, ...
EXTR, DAEX7, MK2, MK1, DAEX7, DAEX6, B3, DAEX5, XSP2, DAEX4, XSCXW2, DAEX3, ...
KICKD, DAEX2, B4, DAEX1];
A3=[QF, DBM, BD2, DQ1, A3P1, DQ2, A3CY1, DQ3, QG, DQ4, A3CX1, DQ5, QD, ...
DQ6, BF, DS1, A3SF1, DS2, A3P2, DS3, BD2, DKMX, A3CX2, DKMX, BF, DKMM, A3P3, ...
DKMM, BD2, DKMY, A3CY2, DKMY, BF, DS1, A3SD1, DS2, A3P4, DS3, BD2, D1, BF, D1, ...
BD2, DS1, A3SD2, DS2, A3P5, DS3, BF, DKMY, A3CY3, DKMY, BD2, DKMM, A3P6, DKMM, ...
BF, DKMX, A3CX3, DKMX, BD2, DS1, A3SF2, DS2, A3P7, DS3, BF, DQ6, QD, DQK, QG, ...
DQ3, A3CY4, DQKM, BD2, DB, QF];
CS=[DA1, CSCXW1, DA2, CSP1, DA3, MK2, RF, MK1, DA3, CSP2, DA2, CSCXW2, DA1];
A4=[QF, DB, BD2, DQKM, A4CY1, DQ3, QG, DQK, QD, DQ6, BF, DS1, A4SF1, DS2, ...
A4P1, DS3, BD2, DKMX, A4CX1, DKMX, BF, DKMM, A4P2, DKMM, BD2, DKMY, A4CY2, ...
DKMY, BF, DS1, A4SD1, DS2, A4P3, DS3, BD2, D1, BF, D1, BD2, DS1, A4SD2, DS2, ...
A4P4, DS3, BF, DKMY, A4CY3, DKMY, BD2, DKMM, A4P5, DKMM, BF, DKMX, A4CX2, DKMX, ...
BD2, DS1, A4SF2, DS2, A4P6, DS3, BF, DQ6, QD, DQ5, A4CX3, DQ4, QG, DQ3, A4CY4, ...
DQ2, A4P7, DQ1, BD2, DBM, QF];
IS1=[DAIN6, ISCXW1, DAIN5, BR1, DAIN4, ISP1, DAIN3, BR2, DAIN2, DAIN1, MK2];

RING=[IS2, A1, DS, A2, XS, A3, CS, A4, IS1];

buildlat(RING);
%evalin('caller','global THERING FAMLIST GLOBVAL');
THERING = setcellstruct(THERING, 'Energy', 1:length(THERING), Energy);
%clear global FAMLIST
%evalin('base','clear LOSSFLAG');
L0_tot = findspos(THERING, length(THERING)+1);
fprintf('   L0 = %.6f\n', L0_tot);
fprintf('   RF = %.6f MHz\n', HarmNumber*C0/L0_tot/1e6)


% Compute initial tunes
[InitialTunes, InitialChro] = tunechrom(THERING, 0, [9.6432 3.4072], 'chrom', 'coupling');
fprintf('   Tunes: nu_x=%g, nu_y=%g \n', InitialTunes(1), InitialTunes(2));
fprintf('   Chromaticities: xi_x=%g, xi_y=%g\n', InitialChro(1), InitialChro(2));
