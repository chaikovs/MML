<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of tunespaceplot</title>
  <meta name="keywords" content="tunespaceplot">
  <meta name="description" content="TUNESPACEPLOT draws a tune diagram">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">at</a> &gt; <a href="index.html">atphysics</a> &gt; tunespaceplot.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for at/atphysics&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>tunespaceplot
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>TUNESPACEPLOT draws a tune diagram</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function R = tunespaceplot(XTUNE,YTUNE,RESORDER,varargin); </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">TUNESPACEPLOT draws a tune diagram
  resonance lines: m*nu_x + n*nu_y = p

  TUNESPACEPLOT(XTUNE, YTUNE, ORDER)

  XTUNE = [XTUNEMIN,XTUNEMAX] 
  YTUNE = [YTUNEMIN,YTUNEMAX] - plotting range in tune space
  RESORDER - resonance order: |m| + |n|

  EXAMPLES
  1. tunespaceplot([18 19], [10 11] ,4)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function R = tunespaceplot(XTUNE,YTUNE,RESORDER,varargin);</a>
0002 <span class="comment">%TUNESPACEPLOT draws a tune diagram</span>
0003 <span class="comment">%  resonance lines: m*nu_x + n*nu_y = p</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%  TUNESPACEPLOT(XTUNE, YTUNE, ORDER)</span>
0006 <span class="comment">%</span>
0007 <span class="comment">%  XTUNE = [XTUNEMIN,XTUNEMAX]</span>
0008 <span class="comment">%  YTUNE = [YTUNEMIN,YTUNEMAX] - plotting range in tune space</span>
0009 <span class="comment">%  RESORDER - resonance order: |m| + |n|</span>
0010 <span class="comment">%</span>
0011 <span class="comment">%  EXAMPLES</span>
0012 <span class="comment">%  1. tunespaceplot([18 19], [10 11] ,4)</span>
0013 
0014 <span class="comment">% TUNESPACEPLOT(XTUNE, YTUNE, ORDER, FIGHANDLE)</span>
0015 <span class="comment">% TUNESPACEPLOT(XTUNE, YTUNE, ORDER, FIGHANDLE)</span>
0016 
0017 <span class="comment">%</span>
0018 <span class="comment">% Modified by Laurent S. Nadolski</span>
0019 
0020 <span class="keyword">if</span> nargin&gt;3
0021     <span class="keyword">if</span> ishandle(varargin{1}) &amp; strcmp(get(varargin{1},<span class="string">'Type'</span>),<span class="string">'figure'</span>)
0022         <span class="comment">% Plot tune space plot</span>
0023         figure(varargin{1});
0024     <span class="keyword">else</span> <span class="comment">% create new figure</span>
0025         figure
0026         axes;   
0027     <span class="keyword">end</span>
0028 <span class="keyword">end</span>
0029 <span class="keyword">if</span> nargin&gt;4
0030     LINEARGS = varargin(2:end);
0031 <span class="keyword">else</span>
0032     LINEARGS = {};
0033 <span class="keyword">end</span>
0034 
0035 
0036 axis([XTUNE,YTUNE]);
0037 axis square
0038         
0039 
0040 R = zeros(8*length(RESORDER),6);
0041 NLMAX = 0;
0042 <span class="keyword">for</span> r = RESORDER
0043     <span class="keyword">for</span> m = 0:r
0044         n = r-m;
0045         
0046         <span class="comment">% Lower</span>
0047         p1 = ceil(m*XTUNE(1)+n*YTUNE(1));
0048         p2 = floor(m*XTUNE(2)+n*YTUNE(1));
0049         
0050             
0051         <span class="keyword">for</span> p =p1:p2 
0052             <span class="keyword">if</span> m <span class="comment">% lines with m=0 do not cross upper and lower sides</span>
0053                 NLMAX = NLMAX+1;
0054                 R(NLMAX,:) = [abs(m)+abs(n),m,n,p,(p-n*YTUNE(1))/m,YTUNE(1)];
0055             <span class="keyword">end</span>
0056         <span class="keyword">end</span>
0057         
0058         <span class="comment">% Left</span>
0059         p1 = ceil(m*XTUNE(1)+n*YTUNE(1));
0060         p2 = floor(m*XTUNE(1)+n*YTUNE(2));
0061         
0062         
0063         <span class="keyword">for</span> p =p1:p2
0064             <span class="keyword">if</span> n <span class="comment">% lines with n=0 do not cross left and right sides</span>
0065                 NLMAX = NLMAX+1;
0066                 R(NLMAX,:) = [abs(m)+abs(n),m,n,p,XTUNE(1),(p-m*XTUNE(1))/n];
0067             <span class="keyword">end</span>
0068         <span class="keyword">end</span>
0069         
0070         <span class="comment">% Upper</span>
0071         p1 = ceil(m*XTUNE(1)+n*YTUNE(2));
0072         p2 = floor(m*XTUNE(2)+n*YTUNE(2));
0073         
0074         <span class="keyword">for</span> p=p1:p2
0075             <span class="keyword">if</span> m
0076                 NLMAX = NLMAX+1;
0077                 R(NLMAX,:) = [abs(m)+abs(n),m,n,p,(p-n*YTUNE(2))/m,YTUNE(2)];
0078             <span class="keyword">end</span>
0079         <span class="keyword">end</span>
0080         
0081         <span class="comment">% Right</span>
0082         p1 = ceil(m*XTUNE(2)+n*YTUNE(1));
0083         p2 = floor(m*XTUNE(2)+n*YTUNE(2));
0084         
0085         <span class="keyword">for</span> p=p1:p2
0086             <span class="keyword">if</span> n
0087                 NLMAX = NLMAX+1;
0088                 R(NLMAX,:) = [abs(m)+abs(n),m,n,p,XTUNE(2),(p-m*XTUNE(2))/n];
0089             <span class="keyword">end</span>
0090         <span class="keyword">end</span>
0091         
0092         <span class="comment">% ========================</span>
0093         n = -r+m;
0094         
0095         <span class="comment">% Lower</span>
0096         p1 = ceil(m*XTUNE(1)+n*YTUNE(1));
0097         p2 = floor(m*XTUNE(2)+n*YTUNE(1));
0098         
0099         <span class="keyword">for</span> p =p1:p2 
0100             <span class="keyword">if</span> m <span class="comment">% lines with m=0 do not cross upper and lower sides</span>
0101                 NLMAX = NLMAX+1;
0102                 R(NLMAX,:) = [abs(m)+abs(n),m,n,p,(p-n*YTUNE(1))/m,YTUNE(1)];
0103             <span class="keyword">end</span>
0104         <span class="keyword">end</span>
0105         
0106         <span class="comment">% Left</span>
0107         <span class="comment">% Note: negative n</span>
0108         p1 = floor(m*XTUNE(1)+n*YTUNE(1));
0109         p2 = ceil(m*XTUNE(1)+n*YTUNE(2));
0110         
0111         <span class="keyword">for</span> p =p2:p1
0112             <span class="keyword">if</span> n <span class="comment">% lines with n=0 do not cross left and right sides</span>
0113                 NLMAX = NLMAX+1;
0114                 R(NLMAX,:) = [abs(m)+abs(n),m,n,p,XTUNE(1),(p-m*XTUNE(1))/n];
0115             <span class="keyword">end</span>
0116         <span class="keyword">end</span>
0117         
0118         <span class="comment">% Upper</span>
0119         p1 = ceil(m*XTUNE(1)+n*YTUNE(2));
0120         p2 = floor(m*XTUNE(2)+n*YTUNE(2));
0121         
0122         <span class="keyword">for</span> p=p1:p2
0123             <span class="keyword">if</span> m
0124                 NLMAX = NLMAX+1;
0125                 R(NLMAX,:) = [abs(m)+abs(n),m,n,p,(p-n*YTUNE(2))/m,YTUNE(2)];
0126             <span class="keyword">end</span>
0127         <span class="keyword">end</span>
0128         
0129         <span class="comment">% Right</span>
0130         <span class="comment">% Note: negative n</span>
0131         
0132         p1 = floor(m*XTUNE(2)+n*YTUNE(1));
0133         p2 = ceil(m*XTUNE(2)+n*YTUNE(2));
0134         <span class="keyword">for</span> p=p2:p1
0135             <span class="keyword">if</span> n
0136                 NLMAX = NLMAX+1;
0137                 R(NLMAX,:) = [abs(m)+abs(n),m,n,p,XTUNE(2),(p-m*XTUNE(2))/n];
0138             <span class="keyword">end</span>
0139         <span class="keyword">end</span>
0140     <span class="keyword">end</span>
0141 <span class="keyword">end</span>
0142 <span class="comment">%R = sortrows(R(1:NLMAX,:));</span>
0143 R = unique(R(1:NLMAX,:),<span class="string">'rows'</span>);
0144 [temp,I,J] = unique(R(:,1:4),<span class="string">'rows'</span>);
0145 K = I(find(diff([0;I])==2))-1;
0146 
0147 RESNUM = [R(K,1:4)]; <span class="comment">% [o, m, n, p] O = |m| + |n|</span>
0148 X1 = R(K,5);
0149 X2 = R(K+1,5);
0150 Y1 = R(K,6);
0151 Y2 = R(K+1,6);
0152 
0153 
0154 <span class="comment">% Remove accidental lines that are on the box edge</span>
0155 K1 = (X1==X2) &amp; (X1==XTUNE(1));
0156 K2 = (X1==X2) &amp; (X1==XTUNE(2));
0157 K3 = (Y1==Y2) &amp; (Y1==YTUNE(1));
0158 K4 = (Y1==Y2) &amp; (Y1==YTUNE(2));
0159 
0160 K = find(~(K1 | K2 | K3 | K4));
0161 
0162 
0163 RESNUM = RESNUM(K,:);
0164 X1 = X1(K);
0165 X2 = X2(K);
0166 Y1 = Y1(K);
0167 Y2 = Y2(K);
0168 
0169 
0170 R = [RESNUM,X1,Y1,X2,Y2];
0171 
0172 
0173 
0174 
0175 
0176 
0177 NL = size(RESNUM,1);
0178 <span class="keyword">for</span> i = 1:NL
0179     hl = line([X1(i) X2(i)],[Y1(i) Y2(i)]);
0180     <span class="keyword">if</span> ~isempty(LINEARGS)
0181         set(hl,LINEARGS{:});
0182     <span class="keyword">end</span>
0183 <span class="keyword">end</span>
0184 
0185 
0186</pre></div>
<hr><address>Generated on Mon 21-May-2007 15:26:45 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>