<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of bpmcortwiss2excel</title>
  <meta name="keywords" content="bpmcortwiss2excel">
  <meta name="description" content="execute spear3 init">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="#">applications</a> &gt; <a href="index.html">orbit</a> &gt; bpmcortwiss2excel.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for applications/orbit&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>bpmcortwiss2excel
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>execute spear3 init</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function twiss_excel </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">execute spear3 init
load Optics structure from GetTwiss2
load bpm and cor structures
dump bpm and cor structures to EXCEL</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function twiss_excel</a>
0002 <span class="comment">%execute spear3 init</span>
0003 <span class="comment">%load Optics structure from GetTwiss2</span>
0004 <span class="comment">%load bpm and cor structures</span>
0005 <span class="comment">%dump bpm and cor structures to EXCEL</span>
0006 
0007 clear bpm cor
0008 spear3init;                                                    <span class="comment">%set up middleware and run sp3v81f deck</span>
0009 <span class="keyword">global</span> THERING
0010 Optics = GetTwiss2(THERING,0,1:length(THERING));               <span class="comment">%load structure with optical parameters</span>
0011 Optics;                                                         <span class="comment">%show what Optics contains</span>
0012 ATindx=ATIndex(THERING);                                       <span class="comment">%AATindx has indices for each family</span>
0013 
0014 ibpm=ATindx.BPM;                                               <span class="comment">%select BPMs</span>
0015 bpm.name    =Optics.name(ibpm,:);
0016 bpm.name    =getfamilydata(<span class="string">'BPMx'</span>,<span class="string">'CommonNames'</span>);
0017 bpm.status  =getfamilydata(<span class="string">'BPMx'</span>,<span class="string">'Status'</span>);
0018 bpm.s       =Optics.s(ibpm);
0019 bpm.phix    =Optics.phix(ibpm);
0020 bpm.betax   =Optics.betax(ibpm);
0021 bpm.alfax   =Optics.alfax(ibpm);
0022 bpm.etax    =Optics.etax(ibpm);
0023 bpm.phiy    =Optics.phiy(ibpm);
0024 bpm.betay   =Optics.betay(ibpm);
0025 bpm.alfay   =Optics.alfay(ibpm);
0026 struct2excel(bpm)
0027 
0028 icor=ATindx.COR;                                               <span class="comment">%select CORs</span>
0029 cor.name    =Optics.name(icor,:);
0030 cor.x_name  =getfamilydata(<span class="string">'HCM'</span>,<span class="string">'CommonNames'</span>);
0031 cor.x_status=getfamilydata(<span class="string">'HCM'</span>,<span class="string">'Status'</span>);
0032 cor.y_name  =getfamilydata(<span class="string">'VCM'</span>,<span class="string">'CommonNames'</span>);
0033 cor.y_status=getfamilydata(<span class="string">'VCM'</span>,<span class="string">'Status'</span>);
0034 cor.s       =Optics.s(icor);
0035 cor.phix    =Optics.phix(icor);
0036 cor.betax   =Optics.betax(icor);
0037 cor.alfax   =Optics.alfax(icor);
0038 cor.etax    =Optics.etax(icor);
0039 cor.phiy    =Optics.phiy(icor);
0040 cor.betay   =Optics.betay(icor);
0041 cor.alfay   =Optics.alfay(icor);
0042 struct2excel(cor)</pre></div>
<hr><address>Generated on Mon 21-May-2007 15:32:41 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>