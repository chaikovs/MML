<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of setrframp2</title>
  <meta name="keywords" content="setrframp2">
  <meta name="description" content="SETRFRAMP2 - Loads a new AC ramp the the RF voltage">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">machine</a> &gt; <a href="#">Soleil</a> &gt; <a href="index.html">Booster</a> &gt; setrframp2.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for machine/Soleil/Booster&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>setrframp2
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>SETRFRAMP2 - Loads a new AC ramp the the RF voltage</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function setrampRF2(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> SETRFRAMP2 - Loads a new AC ramp the the RF voltage

  INPUTS
  1. AC ramp maximum between 0 and 5 in kV
        0 means 0 kV
        5 means mean 500 kV at maximum 

  NOTES
  1. do not forget the DC value which is added


  See Also <a href="getrframp2.html" class="code" title="function rampe = getrampRF2(varargin)">getrframp2</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="getrframp.html" class="code" title="function rampe = getrampRF(varargin)">getrframp</a>	GETRFRAMP - Reads RF ramp for Booster ring</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function setrampRF2(varargin)</a>
0002 <span class="comment">% SETRFRAMP2 - Loads a new AC ramp the the RF voltage</span>
0003 <span class="comment">%</span>
0004 <span class="comment">%  INPUTS</span>
0005 <span class="comment">%  1. AC ramp maximum between 0 and 5 in kV</span>
0006 <span class="comment">%        0 means 0 kV</span>
0007 <span class="comment">%        5 means mean 500 kV at maximum</span>
0008 <span class="comment">%</span>
0009 <span class="comment">%  NOTES</span>
0010 <span class="comment">%  1. do not forget the DC value which is added</span>
0011 <span class="comment">%</span>
0012 <span class="comment">%</span>
0013 <span class="comment">%  See Also getrframp2</span>
0014 
0015 <span class="comment">%</span>
0016 <span class="comment">%  Written by Laurent S. Nadolski</span>
0017 
0018 DisplayFlag = 1;
0019 devName = <span class="string">'BOO/RF/RAMPETENSION'</span>; <span class="comment">% Device avec controle 1er point = dernier point + refus ecrire Tension superieur Ã  8 kV</span>
0020 
0021 <span class="keyword">for</span> i = length(varargin):-1:1
0022     <span class="keyword">if</span> strcmpi(varargin{i},<span class="string">'Display'</span>)
0023         DisplayFlag = 1;
0024         varargin(i) = [];
0025     <span class="keyword">elseif</span> strcmpi(varargin{i},<span class="string">'NoDisplay'</span>)
0026         DisplayFlag = O;
0027         varargin(i) = [];
0028     <span class="keyword">elseif</span> strcmpi(varargin{i},<span class="string">'NoArchive'</span>)
0029         ArchiveFlag = O;
0030         varargin(i) = [];
0031     <span class="keyword">elseif</span> strcmpi(varargin{i},<span class="string">'Archive'</span>)
0032         ArchiveFlag = 1;
0033         varargin(i) = [];
0034     <span class="keyword">end</span>
0035 <span class="keyword">end</span>
0036 
0037 <span class="keyword">if</span> isempty(varargin)
0038     disp(<span class="string">'Missing factor exiting ...'</span>)
0039     <span class="keyword">return</span>;
0040 <span class="keyword">else</span>
0041     factor = varargin{1};
0042     <span class="keyword">if</span> factor &gt; 10
0043         error(<span class="string">'Too large'</span>)
0044     <span class="keyword">end</span>
0045 <span class="keyword">end</span>
0046 
0047 rampe = <a href="getrframp.html" class="code" title="function rampe = getrampRF(varargin)">getrframp</a>(<span class="string">'NoDisplay'</span>);
0048 
0049 figure
0050 
0051 plot(rampe*100)
0052 
0053 rampe2 = rampe/2;
0054 rampe2= rampe/max(rampe)*factor;
0055 
0056 hold on
0057 plot(rampe2*100,<span class="string">'r.'</span>)
0058 hold off
0059 legend(<span class="string">'Old RF voltage Ramp'</span>,<span class="string">'New RF voltage ramp'</span>)
0060 grid on
0061 ylabel(<span class="string">'RF voltage (kV)'</span>);
0062 title(<span class="string">'RF ramp'</span>)
0063 addlabel(1,0,sprintf(<span class="string">'%s'</span>, datestr(clock)));
0064 
0065 
0066 reply = input(<span class="string">'Do you want to apply this ramp? Y/N [N]: '</span>,<span class="string">'s'</span>);
0067 
0068 <span class="keyword">if</span> isempty(reply)
0069     reply = <span class="string">'N'</span>;
0070 <span class="keyword">end</span>
0071 
0072 <span class="keyword">switch</span> reply
0073     <span class="keyword">case</span> <span class="string">'Y'</span>    
0074         <span class="comment">% write the new ramp</span>
0075         tango_command_inout2(devName, <span class="string">'Stop'</span>);
0076         tango_write_attribute2(devName,<span class="string">'waveformData'</span>,rampe2)
0077         tango_command_inout2(devName, <span class="string">'Start'</span>);
0078     <span class="keyword">otherwise</span>
0079         disp(<span class="string">'Ramp not applied'</span>)
0080 <span class="keyword">end</span>
0081</pre></div>
<hr><address>Generated on Mon 21-May-2007 15:35:27 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>