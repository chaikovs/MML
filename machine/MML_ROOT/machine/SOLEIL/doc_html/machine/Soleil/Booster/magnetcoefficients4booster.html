<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of magnetcoefficients4booster</title>
  <meta name="keywords" content="magnetcoefficients4booster">
  <meta name="description" content="MAGNETCOEFFICIENTS - Retrieves coefficient dor converion between Physics and Hardware units">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">machine</a> &gt; <a href="#">Soleil</a> &gt; <a href="index.html">Booster</a> &gt; magnetcoefficients4booster.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for machine/Soleil/Booster&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>magnetcoefficients4booster
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>MAGNETCOEFFICIENTS - Retrieves coefficient dor converion between Physics and Hardware units</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function [C, Leff, MagnetType, A] = magnetcoefficients4booster(MagnetCoreType) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">MAGNETCOEFFICIENTS - Retrieves coefficient dor converion between Physics and Hardware units
[C, Leff, MagnetType, A] = magnetcoefficients(MagnetCoreType)

 INPUTS
 1. MagnetCoreType - Family name or type of magnet

 OUTPUTS
 1. C vector coefficients for the polynomial expansion of the magnet field
    based on magnet measurements
 2. Leff - Effective length
 3. MagnetType
 4. A - vector coefficients for the polynomial expansion of the magnet field
        based on magnet measurements

 C and A are vector coefficients for the polynomial expansion of the magnet field
 based on magnet measurements.  
 
 The amp2k and k2amp functions convert between the two types of units. 
   amp2k returns BLeff, B'Leff, or B&quot;Leff scaled by Brho if A-coefficients are used. 
   amp2k returns B    , B'    , or B&quot;     scaled by Brho if C-coefficients are used. 

 The A coefficients are direct from magnet measurements:
   (a7/I0)*I^8+(a6/I0)*I^7+(a5/I0)*I^6+(a4/I0)*I^5+(a3/I0)*I^4+(a2/I0)*I^3+(a1/I0)*I^2+a0*I = B*Leff or B'*Leff or B&quot;*Leff
   A = [a7 a6 a5 a4 a3 a2 a1 a0]

 C coefficients have been scaled to field (AT units, except correctors) and includes a DC term:
   c8 * I^8+ c7 * I^7+ c6 * I^6 + c5 * I^5 + c4 * I^4 + c3 * I^3 + c2 * I^2 + c1*I + c0 = B or B' or B&quot;
   C = [c8 c7 c6 c5 c4 c3 c2 c1 c0]

 For dipole:      k = B / Brho      (for AT: KickAngle = BLeff / Brho)
 For quadrupole:  k = B'/ Brho
 For sextupole:   k = B&quot;/ Brho / 2  (to be compatible with AT)
                  (all coefficients all divided by 2 for sextupoles)

 MagnetCoreType is the magnet measurements name for the magnet core (string, string matrix, or cell)
   For SOLEIL:   BEND
                 Q1 - Q10 S1 - S10, 
                 QT, HCOR, VCOR, FHCOR, FVCOR 

 Leff is the effective length of the magnet</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [C, Leff, MagnetType, A] = magnetcoefficients4booster(MagnetCoreType)</a>
0002 <span class="comment">%MAGNETCOEFFICIENTS - Retrieves coefficient dor converion between Physics and Hardware units</span>
0003 <span class="comment">%[C, Leff, MagnetType, A] = magnetcoefficients(MagnetCoreType)</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% INPUTS</span>
0006 <span class="comment">% 1. MagnetCoreType - Family name or type of magnet</span>
0007 <span class="comment">%</span>
0008 <span class="comment">% OUTPUTS</span>
0009 <span class="comment">% 1. C vector coefficients for the polynomial expansion of the magnet field</span>
0010 <span class="comment">%    based on magnet measurements</span>
0011 <span class="comment">% 2. Leff - Effective length</span>
0012 <span class="comment">% 3. MagnetType</span>
0013 <span class="comment">% 4. A - vector coefficients for the polynomial expansion of the magnet field</span>
0014 <span class="comment">%        based on magnet measurements</span>
0015 <span class="comment">%</span>
0016 <span class="comment">% C and A are vector coefficients for the polynomial expansion of the magnet field</span>
0017 <span class="comment">% based on magnet measurements.</span>
0018 <span class="comment">%</span>
0019 <span class="comment">% The amp2k and k2amp functions convert between the two types of units.</span>
0020 <span class="comment">%   amp2k returns BLeff, B'Leff, or B&quot;Leff scaled by Brho if A-coefficients are used.</span>
0021 <span class="comment">%   amp2k returns B    , B'    , or B&quot;     scaled by Brho if C-coefficients are used.</span>
0022 <span class="comment">%</span>
0023 <span class="comment">% The A coefficients are direct from magnet measurements:</span>
0024 <span class="comment">%   (a7/I0)*I^8+(a6/I0)*I^7+(a5/I0)*I^6+(a4/I0)*I^5+(a3/I0)*I^4+(a2/I0)*I^3+(a1/I0)*I^2+a0*I = B*Leff or B'*Leff or B&quot;*Leff</span>
0025 <span class="comment">%   A = [a7 a6 a5 a4 a3 a2 a1 a0]</span>
0026 <span class="comment">%</span>
0027 <span class="comment">% C coefficients have been scaled to field (AT units, except correctors) and includes a DC term:</span>
0028 <span class="comment">%   c8 * I^8+ c7 * I^7+ c6 * I^6 + c5 * I^5 + c4 * I^4 + c3 * I^3 + c2 * I^2 + c1*I + c0 = B or B' or B&quot;</span>
0029 <span class="comment">%   C = [c8 c7 c6 c5 c4 c3 c2 c1 c0]</span>
0030 <span class="comment">%</span>
0031 <span class="comment">% For dipole:      k = B / Brho      (for AT: KickAngle = BLeff / Brho)</span>
0032 <span class="comment">% For quadrupole:  k = B'/ Brho</span>
0033 <span class="comment">% For sextupole:   k = B&quot;/ Brho / 2  (to be compatible with AT)</span>
0034 <span class="comment">%                  (all coefficients all divided by 2 for sextupoles)</span>
0035 <span class="comment">%</span>
0036 <span class="comment">% MagnetCoreType is the magnet measurements name for the magnet core (string, string matrix, or cell)</span>
0037 <span class="comment">%   For SOLEIL:   BEND</span>
0038 <span class="comment">%                 Q1 - Q10 S1 - S10,</span>
0039 <span class="comment">%                 QT, HCOR, VCOR, FHCOR, FVCOR</span>
0040 <span class="comment">%</span>
0041 <span class="comment">% Leff is the effective length of the magnet</span>
0042 
0043 <span class="comment">%</span>
0044 <span class="comment">% Written by M. Yoon 4/8/03</span>
0045 <span class="comment">% Modified By Laurent Nadolski</span>
0046 
0047 <span class="comment">% NOTE: The skew quad magnets need to be updated</span>
0048 <span class="comment">% NOTE: The skew quad magnet is distributed on two types of core,</span>
0049 <span class="comment">%       therefore might need to pass in device list</span>
0050 <span class="comment">%       same could be true with quadshunt (current switched into many types of cores)</span>
0051 <span class="comment">% NOTE: All 'C' coefficients divided by Leff at bottom of program: C/Leff</span>
0052 <span class="comment">% NOTE: Make sure the sign on the 'C' coefficients is reversed where positive current generates negative K-values</span>
0053 
0054 
0055 <span class="keyword">if</span> nargin &lt; 1
0056     error(<span class="string">'MagnetCoreType input required'</span>);
0057 <span class="keyword">end</span>
0058 
0059 
0060 <span class="comment">% For a string matrix</span>
0061 <span class="keyword">if</span> iscell(MagnetCoreType)
0062     <span class="keyword">for</span> i = 1:size(MagnetCoreType,1)
0063         <span class="keyword">for</span> j = 1:size(MagnetCoreType,2)
0064             [C{i,j}, Leff{i,j}, MagnetType{i,j}, A{i,j}] = magnetcoefficients(MagnetCoreType{i});
0065         <span class="keyword">end</span>
0066     <span class="keyword">end</span>
0067     <span class="keyword">return</span>
0068 <span class="keyword">end</span>
0069 
0070 <span class="comment">% For a string matrix</span>
0071 <span class="keyword">if</span> size(MagnetCoreType,1) &gt; 1
0072     C=[]; Leff=[]; MagnetType=[]; A=[];
0073     <span class="keyword">for</span> i = 1:size(MagnetCoreType,1)
0074         [C1, Leff1, MagnetType1, A1] = magnetcoefficients(MagnetCoreType(i,:));
0075         C(i,:) = C1;
0076         Leff(i,:) = Leff1;
0077         MagnetType = strvcat(MagnetType, MagnetType1);
0078         A(i,:) = A1;
0079     <span class="keyword">end</span>
0080     <span class="keyword">return</span>
0081 <span class="keyword">end</span>
0082 
0083 <span class="comment">%%%%</span>
0084 <span class="keyword">switch</span> upper(deblank(MagnetCoreType))
0085     
0086     <span class="keyword">case</span> <span class="string">'BEND'</span>    <span class="comment">% 1052.43 mm</span>
0087         i0= 525.0; <span class="comment">% 525 A &lt;--&gt; (1.71 T) &lt;--&gt; 2.75 GeV</span>
0088         Leff=1.05243;
0089         a7= 0.0;
0090         a6=-0.0;
0091         a5= 0.0;
0092         a4=-0.0;
0093         a3= 0.0;
0094         a2=-0.0;
0095         a1= 0.0;
0096         a0= 1.71*Leff/i0;
0097         
0098         c8 = -a7/(i0^7);           <span class="comment">%negative signs added for defocusing</span>
0099         c7 = -a6/(i0^6);
0100         c6 = -a5/(i0^5);
0101         c5 = -a4/(i0^4);
0102         c4 = -a3/(i0^3);
0103         c3 = -a2/(i0^2);
0104         c2 =  a1/i0;
0105         c1 =  a0;
0106         c0 =  0.0;
0107         MagnetType = <span class="string">'BEND'</span>; 
0108                 
0109     <span class="keyword">case</span> {<span class="string">'QF'</span>,<span class="string">'QD'</span>}   <span class="comment">% 320 mm quadrupole</span>
0110         <span class="comment">% Find the current from the given polynomial for B'Leff</span>
0111         Leff=0.320;
0112         i0=  260;
0113         a7=  0.0;
0114         a6=  0.0;
0115         a5=  0.0;
0116         a4=  0.0;
0117         a3=  0.0;
0118         a2=  0.0;
0119         a1=  0.0;
0120         a0=  2.15*Leff*getbrho/i0; <span class="comment">% K= 2.15 m-2 &lt;--&gt; 260 A</span>
0121         
0122         c8 = 0.0;
0123         c7 = 0.0;
0124         c6 = a5/(i0^5);
0125         c5 = a4/(i0^4);
0126         c4 = a3/(i0^3);
0127         c3 = a2/(i0^2);
0128         c2 = a1/i0;
0129         c1 = a0;
0130         c0 = 0.0;
0131         MagnetType = <span class="string">'quad'</span>;        
0132         
0133     <span class="keyword">case</span> {<span class="string">'SF'</span>,<span class="string">'SD'</span>}    <span class="comment">% 160 mm focusing sextupole</span>
0134     <span class="comment">% Find the current from the given polynomial for B''Leff</span>
0135         a7=  0.0;
0136         a6=  0.0;
0137         a5= -0.0;
0138         a4=  0.0;
0139         a3= -0.0;
0140         a2=  0.0;
0141         a1=  0.0;
0142         a0=  4.1327e+06;
0143         i0=  100.0;
0144 
0145         c8 = 0.0;
0146         c7 = 0.0;
0147         c6 = a5/(i0^5);
0148         c5 = a4/(i0^4);
0149         c4 = a3/(i0^3);
0150         c3 = a2/(i0^2);
0151         c2 = a1/i0;
0152         c1 = a0;
0153         c0 = 0.0;
0154         MagnetType = <span class="string">'sext'</span>;
0155         Leff=0.160;
0156                     
0157     <span class="keyword">case</span> {<span class="string">'HCOR'</span>}    <span class="comment">% 16 cm horizontal corrector</span>
0158         <span class="comment">% Magnet Spec: Theta = 0.8e-3 radians @ 2.75 GeV and 10 amps</span>
0159         <span class="comment">% Theta = BLeff / Brho    [radians]</span>
0160         <span class="comment">% Therefore,</span>
0161         <span class="comment">%       Theta = ((BLeff/Amp)/ Brho) * I</span>
0162         <span class="comment">%       BLeff/Amp = 0.8e-3 * getbrho(2.75) / 10</span>
0163         <span class="comment">%       B*Leff = a0 * I   =&gt; a0 = 0.8e-3 * getbrho(2.75) / 10</span>
0164         <span class="comment">%</span>
0165         <span class="comment">% The C coefficients are w.r.t B</span>
0166         <span class="comment">%       B = c0 + c1*I = (0 + a0*I)/Leff</span>
0167         <span class="comment">% However, AT uses Theta in radians so the A coefficients</span>
0168         <span class="comment">% must be used for correctors with the middle layer with</span>
0169         <span class="comment">% the addition of the DC term</span>
0170         
0171         <span class="comment">% Find the current from the given polynomial for BLeff and B</span>
0172         <span class="comment">% NOTE: AT used BLeff (A) for correctors</span>
0173         Leff = .16;
0174         imax = 10;
0175         cormax = 0.8e-3 ; <span class="comment">% 0.8 mrad for imax = 10 A</span>
0176         MagnetType = <span class="string">'COR'</span>;       
0177         A = [0 cormax*getbrho(2.75)/imax]; 
0178         C = [0 A 0] / Leff;
0179         <span class="keyword">return</span>
0180         
0181     <span class="keyword">case</span> {<span class="string">'VCOR'</span>}    <span class="comment">% 16 cm vertical corrector</span>
0182         <span class="comment">% Find the current from the given polynomial for BLeff and B</span>
0183         Leff = .16;
0184         imax = 10;
0185         cormax = 0.8e-3 ; <span class="comment">% 0.8 mrad for imax = 10 A</span>
0186         MagnetType = <span class="string">'COR'</span>;       
0187         A = [0 cormax*getbrho(2.75)/imax]; 
0188         C = [0 A 0] / Leff;
0189         <span class="keyword">return</span>
0190     
0191 <span class="keyword">otherwise</span> 
0192         error(sprintf(<span class="string">'MagnetCoreType %s is not unknown'</span>, MagnetCoreType));
0193         <span class="comment">%k = 0;</span>
0194         <span class="comment">%MagnetType = '';</span>
0195         <span class="comment">%return</span>
0196 <span class="keyword">end</span>
0197 
0198 A = [a7 a6 a5 a4 a3 a2 a1 a0];
0199 C = [c8 c7 c6 c5 c4 c3 c2 c1 c0] / Leff;
0200 
0201 MagnetType = upper(MagnetType);
0202 
0203 
0204 <span class="comment">% Power Series Denominator (Factoral) be AT compatible</span>
0205 <span class="keyword">if</span> strcmpi(MagnetType,<span class="string">'SEXT'</span>)
0206     C = C / 2;
0207 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Mon 21-May-2007 15:35:27 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>