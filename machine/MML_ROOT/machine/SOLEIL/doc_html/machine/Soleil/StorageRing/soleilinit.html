<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of soleilinit</title>
  <meta name="keywords" content="soleilinit">
  <meta name="description" content="SOLEILINIT - Initializes params for SOLEIL control in MATLAB">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">machine</a> &gt; <a href="#">Soleil</a> &gt; <a href="index.html">StorageRing</a> &gt; soleilinit.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for machine/Soleil/StorageRing&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>soleilinit
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>SOLEILINIT - Initializes params for SOLEIL control in MATLAB</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function soleilinit(OperationalMode) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">SOLEILINIT - Initializes params for SOLEIL control in MATLAB

 Written by Laurent S. Nadolski, Synchrotron SOLEIL
 
==========================
 Accelerator Family Fields
==========================
 FamilyName            BPMx, HCOR, etc
 CommonNames           Shortcut name for each element
 DeviceList            [Sector, Number]
 ElementList           number in list
 Position              m, if thick, it is not the magnet center

 MONITOR FIELD
 Mode                  online/manual/special/simulator
 TangoNames            Device Tango Names
 Units                 Physics or HW
 HW2PhysicsFcn         function handle used to convert from hardware to physics units ==&gt; inline will not compile, see below
 HW2PhysicsParams      params used for conversion function
 Physics2HWFcn         function handle used to convert from physics to hardware units
 Physics2HWParams      params used for conversion function
 HWUnits               units for Hardware 'A';
 PhysicsUnits          units for physics 'Rad';
 Handles               monitor handle

 SETPOINT FIELDS
 Mode                  online/manual/special/simulator
 TangoNames            Devices tango names
 Units                 hardware or physics
 HW2PhysicsFcn         function handle used to convert from hardware to physics units
 HW2PhysicsParams      params used for conversion function
 Physics2HWFcn         function handle used to convert from physics to hardware units
 Physics2HWParams      params used for conversion function
 HWUnits               units for Hardware 'A';
 PhysicsUnits          units for physics 'Rad';
 Range                 minsetpoint, maxsetpoint;
 Tolerance             setpoint-monitor
 Handles               setpoint handle

=============================================
 Accelerator Toolbox Simulation Fields
=============================================
 ATType                Quad, Sext, etc
 ATIndex               index in THERING
 ATParamGroup      param group

============
 Family List
============
    BPMx
    BPMz
    HCOR
    VCOR
    BEND
    Q1 to Q10
    S1 to S10
    RF
    TUNE
    DCCT
    Machine Params

 NOTES
   All sextupoles have H and V corrector and skew quadrupole windings

  See Also setpathsoleil, setpathmml, <a href="aoinit.html" class="code" title="function aoinit(SubMachineName)">aoinit</a>, setoperionalmode, <a href="updateatindex.html" class="code" title="function updateatindex">updateatindex</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="setoperationalmode.html" class="code" title="function setoperationalmode(ModeNumber)">setoperationalmode</a>	SETOPERATIONALMODE - Switches between the various operational modes</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="aoinit.html" class="code" title="function aoinit(SubMachineName)">aoinit</a>	AOINIT - Initialization function for the Matlab Middle Layer (MML)</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function setfamilydata_local(Family)</a></li></ul>
<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function soleilinit(OperationalMode)</a>
0002 <span class="comment">%SOLEILINIT - Initializes params for SOLEIL control in MATLAB</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% Written by Laurent S. Nadolski, Synchrotron SOLEIL</span>
0005 <span class="comment">%</span>
0006 <span class="comment">%==========================</span>
0007 <span class="comment">% Accelerator Family Fields</span>
0008 <span class="comment">%==========================</span>
0009 <span class="comment">% FamilyName            BPMx, HCOR, etc</span>
0010 <span class="comment">% CommonNames           Shortcut name for each element</span>
0011 <span class="comment">% DeviceList            [Sector, Number]</span>
0012 <span class="comment">% ElementList           number in list</span>
0013 <span class="comment">% Position              m, if thick, it is not the magnet center</span>
0014 <span class="comment">%</span>
0015 <span class="comment">% MONITOR FIELD</span>
0016 <span class="comment">% Mode                  online/manual/special/simulator</span>
0017 <span class="comment">% TangoNames            Device Tango Names</span>
0018 <span class="comment">% Units                 Physics or HW</span>
0019 <span class="comment">% HW2PhysicsFcn         function handle used to convert from hardware to physics units ==&gt; inline will not compile, see below</span>
0020 <span class="comment">% HW2PhysicsParams      params used for conversion function</span>
0021 <span class="comment">% Physics2HWFcn         function handle used to convert from physics to hardware units</span>
0022 <span class="comment">% Physics2HWParams      params used for conversion function</span>
0023 <span class="comment">% HWUnits               units for Hardware 'A';</span>
0024 <span class="comment">% PhysicsUnits          units for physics 'Rad';</span>
0025 <span class="comment">% Handles               monitor handle</span>
0026 <span class="comment">%</span>
0027 <span class="comment">% SETPOINT FIELDS</span>
0028 <span class="comment">% Mode                  online/manual/special/simulator</span>
0029 <span class="comment">% TangoNames            Devices tango names</span>
0030 <span class="comment">% Units                 hardware or physics</span>
0031 <span class="comment">% HW2PhysicsFcn         function handle used to convert from hardware to physics units</span>
0032 <span class="comment">% HW2PhysicsParams      params used for conversion function</span>
0033 <span class="comment">% Physics2HWFcn         function handle used to convert from physics to hardware units</span>
0034 <span class="comment">% Physics2HWParams      params used for conversion function</span>
0035 <span class="comment">% HWUnits               units for Hardware 'A';</span>
0036 <span class="comment">% PhysicsUnits          units for physics 'Rad';</span>
0037 <span class="comment">% Range                 minsetpoint, maxsetpoint;</span>
0038 <span class="comment">% Tolerance             setpoint-monitor</span>
0039 <span class="comment">% Handles               setpoint handle</span>
0040 <span class="comment">%</span>
0041 <span class="comment">%=============================================</span>
0042 <span class="comment">% Accelerator Toolbox Simulation Fields</span>
0043 <span class="comment">%=============================================</span>
0044 <span class="comment">% ATType                Quad, Sext, etc</span>
0045 <span class="comment">% ATIndex               index in THERING</span>
0046 <span class="comment">% ATParamGroup      param group</span>
0047 <span class="comment">%</span>
0048 <span class="comment">%============</span>
0049 <span class="comment">% Family List</span>
0050 <span class="comment">%============</span>
0051 <span class="comment">%    BPMx</span>
0052 <span class="comment">%    BPMz</span>
0053 <span class="comment">%    HCOR</span>
0054 <span class="comment">%    VCOR</span>
0055 <span class="comment">%    BEND</span>
0056 <span class="comment">%    Q1 to Q10</span>
0057 <span class="comment">%    S1 to S10</span>
0058 <span class="comment">%    RF</span>
0059 <span class="comment">%    TUNE</span>
0060 <span class="comment">%    DCCT</span>
0061 <span class="comment">%    Machine Params</span>
0062 <span class="comment">%</span>
0063 <span class="comment">% NOTES</span>
0064 <span class="comment">%   All sextupoles have H and V corrector and skew quadrupole windings</span>
0065 <span class="comment">%</span>
0066 <span class="comment">%  See Also setpathsoleil, setpathmml, aoinit, setoperionalmode, updateatindex</span>
0067 
0068 <span class="keyword">if</span> nargin &lt; 1
0069     OperationalMode = 1;
0070 <span class="keyword">end</span>
0071 
0072 <span class="keyword">global</span> GLOBVAL THERING
0073 
0074 <span class="comment">%==============================</span>
0075 <span class="comment">%% load AcceleratorData structure</span>
0076 <span class="comment">%==============================</span>
0077 
0078 Mode             = <span class="string">'Simulator'</span>;
0079 setad([]);       <span class="comment">%clear AcceleratorData memory</span>
0080 AD.SubMachine = <span class="string">'StorageRing'</span>;   <span class="comment">% Will already be defined if setpathmml was used</span>
0081 AD.Energy        = 2.7391; <span class="comment">% Energy in GeV needed for magnet calibration. Do not remove!</span>
0082 
0083 setad(AD);
0084 
0085 <span class="comment">%%%%%%%%%%%%%%%%%%%%</span>
0086 <span class="comment">% ACCELERATOR OBJECT</span>
0087 <span class="comment">%%%%%%%%%%%%%%%%%%%%</span>
0088 
0089 setao([]);   <span class="comment">%clear previous AcceleratorObjects</span>
0090 
0091 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0092 <span class="comment">% BPM</span>
0093 <span class="comment">% status field designates if BPM in use</span>
0094 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0095 <span class="comment">%% BPMX Horizontal plane</span>
0096 ifam = <span class="string">'BPMx'</span>;
0097 AO.(ifam).FamilyName               = ifam;
0098 AO.(ifam).FamilyType               = <span class="string">'BPM'</span>;
0099 AO.(ifam).MemberOf                 = {<span class="string">'BPM'</span>; <span class="string">'HBPM'</span>; <span class="string">'PlotFamily'</span>; <span class="string">'Archivable'</span>};
0100 AO.(ifam).Monitor.Mode             = Mode;
0101 <span class="comment">%AO.(ifam).Monitor.Mode             = 'Special';</span>
0102 AO.(ifam).Monitor.Units            = <span class="string">'Hardware'</span>;
0103 AO.(ifam).Monitor.HWUnits          = <span class="string">'mm'</span>;
0104 AO.(ifam).Monitor.PhysicsUnits     = <span class="string">'m'</span>;
0105 <span class="comment">%AO.(ifam).Monitor.SpecialFunctionGet = 'gethturnbyturn';</span>
0106 <span class="comment">% Get mapping from TANGO static database</span>
0107 map = tango_get_db_property(<span class="string">'anneau'</span>,<span class="string">'tracy_bpm_mapping'</span>);
0108 
0109 cellindex = cell2mat(regexpi(map,<span class="string">'C[0-9]'</span>,<span class="string">'once'</span>))+1;
0110 numindex  = cell2mat(regexpi(map,<span class="string">'\.[0-9]'</span>,<span class="string">'once'</span>))+1;
0111 elemindex = cell2mat(regexpi(map,<span class="string">'BPM[0-9]'</span>,<span class="string">'once'</span>))+3;
0112 sep       = cell2mat(regexpi(map,<span class="string">'::'</span>,<span class="string">'once'</span>))-1;
0113 dev       = regexprep(map,<span class="string">'^BPM\d*::'</span>,<span class="string">''</span>)';
0114 
0115 nb = size(map,2);
0116 
0117 <span class="keyword">for</span> k = 1:nb,
0118     AO.(ifam).DeviceList(k,:)  = [str2double(map{k}(cellindex(k):cellindex(k)+1)) str2double(map{k}(numindex(k):end))];
0119     AO.(ifam).ElementList(k,:) = str2double(map{k}(elemindex(k):sep(k)));
0120 <span class="keyword">end</span>
0121 
0122 AO.(ifam).ElementList = (1:120)';
0123 AO.(ifam).DeviceName(:,:)               = dev;
0124 AO.(ifam).Monitor.TangoNames(:,:)       = strcat(dev, <span class="string">'/XPosSA'</span>);
0125 AO.(ifam).CommonNames(:,:)              = [repmat(<span class="string">'BPMx'</span>,nb,1) num2str((1:nb)',<span class="string">'%03d'</span>)];
0126 
0127 AO.(ifam).Status                        = ones(nb,1);
0128 AO.(ifam).Monitor.HW2PhysicsParams(:,:) = 1e-3*ones(nb,1);
0129 AO.(ifam).Monitor.Physics2HWParams(:,:) = 1e3*ones(nb,1);
0130 
0131 <span class="comment">% 2 lignes ajoutes pour test debug bpm versus le reste du monde</span>
0132 AO.(ifam).Monitor.Handles(:,1)       = NaN*ones(nb,1);
0133 AO.(ifam).Monitor.DataType         = <span class="string">'Scalar'</span>;
0134 
0135 <span class="comment">% Group</span>
0136 AO.(ifam).GroupId = tango_group_create2(<span class="string">'BPM'</span>);
0137 tango_group_add(AO.(ifam).GroupId,AO.(ifam).DeviceName');
0138 
0139 AO.(ifam).History.TangoNames(:,:)       = strcat(dev, <span class="string">'/XPosSAHistory'</span>);
0140 
0141 <span class="comment">%% BPMZ Vertical plane</span>
0142 ifam = <span class="string">'BPMz'</span>; 
0143 AO.(ifam) = AO.BPMx; <span class="comment">% the same as BPMx</span>
0144 AO.(ifam).MemberOf                 = {<span class="string">'BPM'</span>; <span class="string">'VBPM'</span>; <span class="string">'PlotFamily'</span>; <span class="string">'Archivable'</span>};
0145 AO.(ifam).Monitor.Mode             = <span class="string">'Online'</span>;
0146 <span class="comment">%AO.(ifam).Monitor.Mode             = 'Special';</span>
0147 <span class="comment">% except those fields</span>
0148 AO.(ifam).FamilyName              = ifam;
0149 AO.(ifam).Monitor.TangoNames(:,:)  = strcat(dev,<span class="string">'/ZPosSA'</span>);
0150 AO.(ifam).CommonNames(:,:) = [repmat(<span class="string">'BPMz'</span>,nb,1) num2str((1:nb)',<span class="string">'%03d'</span>)];
0151 AO.(ifam).Monitor.DataType         = <span class="string">'Scalar'</span>;
0152 AO.(ifam).Monitor.Handles(:,1)     = NaN*ones(nb,1);
0153 <span class="comment">%AO.(ifam).Monitor.SpecialFunctionGet = 'getvturnbyturn';</span>
0154 
0155 AO.(ifam).Status = AO.(ifam).Status(:);
0156 AO.(ifam).Status = AO.(ifam).Status(:);
0157 
0158 <span class="comment">%TODO</span>
0159 <span class="comment">% AO.(ifam).Sum.Monitor = AO.(ifam).Monitor;</span>
0160 <span class="comment">% AO.(ifam).Q = AO.(ifam).Monitor;</span>
0161 
0162 setao(AO); <span class="comment">% mandatory to avoid empty AO message with magnetcoefficients</span>
0163 
0164 <span class="comment">% Make BPM group</span>
0165 <span class="comment">% AO.(ifam).GroupID = tango_group_create('BPM');</span>
0166 <span class="comment">% AO.(ifam).GroupID = AO.(ifam).GroupID;</span>
0167 <span class="comment">% name = lower(getfamilydata(BPMFamily{1},'DeviceName'));</span>
0168 <span class="comment">% tango_group_add(AO.(ifam).GroupID,{name{:}});</span>
0169 <span class="comment">% tango_group_dump(AO.(ifam).GroupID)</span>
0170 <span class="comment">% tango_group_size(AO.(ifam).GroupID,0)</span>
0171 
0172 <span class="comment">%===========================================================</span>
0173 <span class="comment">% Corrector data: status field designates if corrector in use</span>
0174 <span class="comment">%===========================================================</span>
0175 
0176 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0177 <span class="comment">%% SLOW HORIZONTAL CORRECTORS</span>
0178 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0179 ifam = <span class="string">'HCOR'</span>;
0180 AO.(ifam).FamilyName               = ifam;
0181 AO.(ifam).FamilyType               = <span class="string">'COR'</span>;
0182 AO.(ifam).MemberOf                 = {<span class="string">'MachineConfig'</span>; <span class="string">'HCOR'</span>; <span class="string">'COR'</span>; <span class="string">'Magnet'</span>; <span class="string">'PlotFamily'</span>; <span class="string">'Archivable'</span>};
0183 
0184 AO.(ifam).Monitor.Mode             = Mode;
0185 AO.(ifam).Monitor.DataType         = <span class="string">'Scalar'</span>;
0186 AO.(ifam).Monitor.Units            = <span class="string">'Hardware'</span>;
0187 AO.(ifam).Monitor.HWUnits          = <span class="string">'A'</span>;
0188 AO.(ifam).Monitor.PhysicsUnits     = <span class="string">'rad'</span>;
0189 AO.(ifam).Monitor.HW2PhysicsFcn    = @amp2k;
0190 AO.(ifam).Monitor.Physics2HWFcn    = @k2amp;
0191 
0192 <span class="comment">% Get mapping from TANGO static database</span>
0193 map  = tango_get_db_property(<span class="string">'anneau'</span>,<span class="string">'tracy_correctorH_mapping'</span>);
0194 devC = regexprep(map,<span class="string">'^CH\d*::'</span>,<span class="string">''</span>)';
0195 
0196 <span class="comment">% Get all potential correctors (in each sextupoles)</span>
0197 mapS = tango_get_db_property(<span class="string">'anneau'</span>,<span class="string">'tracy_sextupole_mapping'</span>);
0198 cellindex  = cell2mat(regexpi(mapS,<span class="string">'C[0-9]'</span>,<span class="string">'once'</span>))+1;
0199 devS = regexprep(mapS,<span class="string">'^SX\d*::'</span>,<span class="string">''</span>)';
0200 
0201 nb = size(mapS,2);
0202 
0203 <span class="comment">% Create full list of 120 potential correctors</span>
0204 cellnum0 = 1; num = 0;
0205 <span class="keyword">for</span> k = 1:nb,
0206    cellnum = str2double(mapS{k}(cellindex(k):cellindex(k)+1));       
0207    <span class="keyword">if</span> (cellnum ~= cellnum0)
0208        cellnum0 = cellnum;
0209        num = 1;
0210    <span class="keyword">else</span>
0211        num = num + 1;
0212    <span class="keyword">end</span>
0213    AO.(ifam).DeviceList(k,:) = [cellnum num];
0214 <span class="keyword">end</span>
0215 AO.(ifam).ElementList(:,:)= (1:nb)';
0216 
0217 dev = strcat(devS,<span class="string">'-CH'</span>);
0218 
0219 <span class="comment">% Select working correctors</span>
0220 AO.(ifam).Status = ones(nb,1);
0221 jk = 1;
0222 <span class="keyword">for</span> k = 1:nb,
0223         <span class="keyword">if</span> isempty(strmatch(devC{jk},dev{k}))
0224             AO.(ifam).Status(k) = 0;
0225         <span class="keyword">else</span>
0226             <span class="keyword">if</span> (jk &lt; size(devC,1)), jk = jk + 1; <span class="keyword">end</span>;
0227         <span class="keyword">end</span>
0228 <span class="keyword">end</span>
0229 
0230 AO.(ifam).DeviceName(:,:)            = dev;
0231 AO.(ifam).CommonNames(:,:)           = [repmat(AO.(ifam).FamilyName,nb,1) num2str((1:nb)',<span class="string">'%03d'</span>)];
0232 AO.(ifam).Monitor.TangoNames(:,:)    = strcat(dev,<span class="string">'/current'</span>);
0233 
0234 AO.(ifam).Monitor.Range(:,:)        = repmat([-10 10],nb,1); <span class="comment">% 10 A for 0.8 mrad</span>
0235 AO.(ifam).Monitor.Handles(:,1)       = NaN*ones(nb,1);
0236 
0237 <span class="comment">%Load fields from datablock</span>
0238 <span class="comment">% AT use the &quot;A-coefficients&quot; for correctors plus an offset</span>
0239 [C, Leff, MagnetType, coefficients] = magnetcoefficients(AO.(ifam).FamilyName);
0240 
0241 <span class="keyword">for</span> ii = 1:nb,
0242     AO.(ifam).Monitor.HW2PhysicsParams{1}(ii,:)  = coefficients;
0243     AO.(ifam).Monitor.Physics2HWParams{1}(ii,:)  = coefficients;
0244 <span class="keyword">end</span>
0245 
0246 
0247 AO.(ifam).Status = AO.(ifam).Status(:);
0248 
0249 AO.(ifam).Setpoint = AO.(ifam).Monitor; 
0250 AO.(ifam).Desired  = AO.(ifam).Monitor;
0251 AO.(ifam).Setpoint.MemberOf  = {<span class="string">'PlotFamily'</span>};
0252 AO.(ifam).Setpoint.TangoNames(:,:)    = strcat(dev,<span class="string">'/currentPM'</span>);
0253 
0254 AO.(ifam).Setpoint.Tolerance(:,:)    = 1e-2*ones(nb,1);
0255 AO.(ifam).Setpoint.DeltaRespMat(:,:) = ones(nb,1)*0.5e-4*1; <span class="comment">% 2*25 urad (half used for kicking)</span>
0256 
0257 AO.(ifam).Voltage.TangoNames(:,:)    = strcat(dev,<span class="string">'/voltage'</span>);
0258 AO.(ifam).Monitor.MemberOf           = {<span class="string">'PlotFamily'</span>};
0259 <span class="comment">% AO.(ifam).SumOffset.TangoNames(:,:)     = strcat(dev,'/ecart2');</span>
0260 <span class="comment">% AO.(ifam).SumOffset.MemberOf           = {'PlotFamily'};</span>
0261 <span class="comment">% AO.(ifam).Ecart.TangoNames(:,:)      = strcat(dev,'/ecart1');</span>
0262 <span class="comment">% AO.(ifam).Ecart.MemberOf           = {'PlotFamily'};</span>
0263 
0264 AO.(ifam).Profibus.BoardNumber = int32(0);
0265 AO.(ifam).Profibus.Group       = int32(1);
0266 AO.(ifam).Profibus.DeviceName  = <span class="string">'ANS/AE/DP.CH'</span>;
0267 
0268 <span class="comment">%convert response matrix kicks to HWUnits (after AO is loaded to AppData)</span>
0269 setao(AO);   <span class="comment">%required to make physics2hw function</span>
0270 AO.(ifam).Setpoint.DeltaRespMat = physics2hw(AO.(ifam).FamilyName,<span class="string">'Setpoint'</span>, <span class="keyword">...</span>
0271     AO.(ifam).Setpoint.DeltaRespMat, AO.(ifam).DeviceList);
0272 
0273 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0274 <span class="comment">%% SLOW VERTICAL CORRECTORS</span>
0275 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0276 ifam = <span class="string">'VCOR'</span>;
0277 AO.(ifam).FamilyName               = ifam;
0278 AO.(ifam).FamilyType               = <span class="string">'COR'</span>;
0279 AO.(ifam).MemberOf                 = {<span class="string">'MachineConfig'</span>; <span class="string">'VCOR'</span>; <span class="string">'COR'</span>; <span class="string">'Magnet'</span>; <span class="string">'PlotFamily'</span>; <span class="string">'Archivable'</span>};
0280 
0281 AO.(ifam).Monitor.Mode             = Mode;
0282 AO.(ifam).Monitor.DataType         = <span class="string">'Scalar'</span>;
0283 AO.(ifam).Monitor.Units            = <span class="string">'Hardware'</span>;
0284 AO.(ifam).Monitor.HWUnits          = <span class="string">'A'</span>;
0285 AO.(ifam).Monitor.PhysicsUnits     = <span class="string">'rad'</span>;
0286 AO.(ifam).Monitor.HW2PhysicsFcn = @amp2k;
0287 AO.(ifam).Monitor.Physics2HWFcn = @k2amp;
0288 
0289 <span class="comment">% Get mapping from TANGO static database</span>
0290 map = tango_get_db_property(<span class="string">'anneau'</span>,<span class="string">'tracy_correctorV_mapping'</span>);
0291 devC = regexprep(map,<span class="string">'^CV\d*::'</span>,<span class="string">''</span>)';
0292 
0293 <span class="comment">% Create full list of 120 potential correctors</span>
0294 cellnum0 = 1; num = 0;
0295 <span class="keyword">for</span> k = 1:nb,
0296    cellnum = str2double(mapS{k}(cellindex(k):cellindex(k)+1));       
0297    <span class="keyword">if</span> (cellnum ~= cellnum0)
0298        cellnum0 = cellnum;
0299        num = 1;
0300    <span class="keyword">else</span>
0301        num = num + 1;
0302    <span class="keyword">end</span>
0303    AO.(ifam).DeviceList(k,:) = [cellnum num];
0304 <span class="keyword">end</span>
0305 AO.(ifam).ElementList(:,:)= (1:nb)';
0306 
0307 dev = strcat(devS,<span class="string">'-CV'</span>);
0308 
0309 <span class="comment">% Select working correctors</span>
0310 AO.(ifam).Status = ones(nb,1);
0311 jk = 1;
0312 <span class="keyword">for</span> k = 1:nb,
0313     <span class="keyword">if</span> isempty(strmatch(devC{jk},dev{k}))
0314         AO.(ifam).Status(k) = 0;
0315     <span class="keyword">else</span>
0316         <span class="keyword">if</span> (jk &lt; size(devC,1)), jk = jk + 1; <span class="keyword">end</span>;
0317     <span class="keyword">end</span>
0318 <span class="keyword">end</span>
0319 
0320 AO.(ifam).DeviceName(:,:)            = dev;
0321 AO.(ifam).CommonNames(:,:)           = [repmat(AO.(ifam).FamilyName,nb,1) num2str((1:nb)',<span class="string">'%03d'</span>)];
0322 AO.(ifam).Monitor.TangoNames(:,:)    = strcat(dev,<span class="string">'/current'</span>);
0323 AO.(ifam).Monitor.Range(:,:)      = repmat([-14 14],nb,1); <span class="comment">% 10 A for 0.8 mrad</span>
0324 AO.(ifam).Monitor.Handles(:,1)    = NaN*ones(nb,1);
0325 
0326 <span class="comment">%Load fields from datablock</span>
0327 <span class="comment">% AT use the &quot;A-coefficients&quot; for correctors plus an offset</span>
0328 [C, Leff, MagnetType, coefficients] = magnetcoefficients(AO.(ifam).FamilyName);
0329 
0330 <span class="keyword">for</span> ii = 1:nb,
0331     AO.(ifam).Monitor.HW2PhysicsParams{1}(ii,:)  = coefficients;
0332     AO.(ifam).Monitor.Physics2HWParams{1}(ii,:)  = coefficients;
0333 <span class="keyword">end</span>
0334 
0335 AO.(ifam).Setpoint = AO.(ifam).Monitor;
0336 AO.(ifam).Desired = AO.(ifam).Monitor;
0337 
0338 AO.(ifam).Setpoint.MemberOf  = {<span class="string">'PlotFamily'</span>};
0339 AO.(ifam).Setpoint.TangoNames(:,:)   = strcat(dev,<span class="string">'/currentPM'</span>);
0340 AO.(ifam).Setpoint.Tolerance(:,:)    = 1e-2*ones(nb,1);
0341 <span class="comment">%AO.(ifam).Setpoint.DeltaRespMat(:,:) = ones(nb,1)*1e-5*2; % 2*25 urad (half used for kicking)</span>
0342 AO.(ifam).Setpoint.DeltaRespMat(:,:) = ones(nb,1)*1e-4*2; <span class="comment">% 2*25 urad (half used for kicking)</span>
0343 
0344 AO.(ifam).Profibus.BoardNumber = int32(0);
0345 AO.(ifam).Profibus.Group       = int32(1);
0346 AO.(ifam).Profibus.DeviceName  = <span class="string">'ANS/AE/DP.CV'</span>;
0347 
0348 <span class="comment">%convert response matrix kicks to HWUnits (after AO is loaded to AppData)</span>
0349 setao(AO);   <span class="comment">%required to make physics2hw function</span>
0350 AO.(ifam).Setpoint.DeltaRespMat = physics2hw(AO.(ifam).FamilyName,<span class="string">'Setpoint'</span>, <span class="keyword">...</span>
0351     AO.(ifam).Setpoint.DeltaRespMat, AO.(ifam).DeviceList);
0352 
0353 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0354 <span class="comment">%% Skew Quadrupole data</span>
0355 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0356 
0357 ifam = <span class="string">'QT'</span>;
0358 AO.(ifam).FamilyName               = ifam;
0359 AO.(ifam).FamilyType               = <span class="string">'SkewQuad'</span>;
0360 AO.(ifam).MemberOf                 = {<span class="string">'MachineConfig'</span>; <span class="string">'Magnet'</span>; <span class="string">'PlotFamily'</span>; <span class="string">'Archivable'</span>};
0361 
0362 HW2Physics = 1.0;
0363 AO.(ifam).Monitor.Mode             = Mode;
0364 AO.(ifam).Monitor.DataType         = <span class="string">'Scalar'</span>;
0365 AO.(ifam).Monitor.Units            = <span class="string">'Hardware'</span>;
0366 AO.(ifam).Monitor.HWUnits          = <span class="string">'A'</span>;
0367 AO.(ifam).Monitor.PhysicsUnits     = <span class="string">'meter^-2'</span>;
0368 AO.(ifam).Monitor.HW2PhysicsFcn = @amp2k;
0369 AO.(ifam).Monitor.Physics2HWFcn = @k2amp;
0370 
0371 <span class="comment">% Get mapping from TANGO static database</span>
0372 map = tango_get_db_property(<span class="string">'anneau'</span>,<span class="string">'tracy_QT_mapping'</span>);
0373 devC = regexprep(map,<span class="string">'^QT\d*::'</span>,<span class="string">''</span>)';
0374 
0375 <span class="comment">% Create full list of 120 potential correctors</span>
0376 cellnum0 = 1; num = 0;
0377 <span class="keyword">for</span> k = 1:nb,
0378    cellnum = str2double(mapS{k}(cellindex(k):cellindex(k)+1));       
0379    <span class="keyword">if</span> (cellnum ~= cellnum0)
0380        cellnum0 = cellnum;
0381        num = 1;
0382    <span class="keyword">else</span>
0383        num = num + 1;
0384    <span class="keyword">end</span>
0385    AO.(ifam).DeviceList(k,:) = [cellnum num];
0386 <span class="keyword">end</span>
0387 AO.(ifam).ElementList(:,:)= (1:nb)';
0388 
0389 dev = strcat(devS,<span class="string">'-QT'</span>);
0390 
0391 <span class="comment">% Select working correctors</span>
0392 AO.(ifam).Status = ones(nb,1);
0393 jk = 1;
0394 <span class="keyword">for</span> k = 1:nb,
0395     <span class="keyword">if</span> k == 24
0396         AO.(ifam).Status(k) = 0; <span class="comment">%%%%%%%%%%%%%%%%%%% situation du 11 mars  2007 S1 [12 7] en quad</span>
0397     <span class="keyword">end</span>
0398 
0399     <span class="keyword">if</span> isempty(strmatch(devC{jk},dev{k}))
0400         AO.(ifam).Status(k) = 0;
0401     <span class="keyword">else</span>
0402         <span class="keyword">if</span> (jk &lt; size(devC,1)), jk = jk + 1; <span class="keyword">end</span>;
0403     <span class="keyword">end</span>
0404 <span class="keyword">end</span>
0405 
0406 AO.(ifam).DeviceName(:,:)            = dev;
0407 AO.(ifam).CommonNames(:,:)           = [repmat(AO.(ifam).FamilyName,nb,1) num2str((1:nb)',<span class="string">'%03d'</span>)];
0408 AO.(ifam).Monitor.TangoNames(:,:)    = strcat(dev,<span class="string">'/current'</span>);
0409 AO.(ifam).Monitor.Range(:,:) = repmat([-7 7],nb,1); <span class="comment">% 10 A for 0.8 mrad</span>
0410 AO.(ifam).Monitor.Handles(:,1)    = NaN*ones(nb,1);
0411 
0412 <span class="comment">% Load coeeficients fot thin element</span>
0413 coefficients = magnetcoefficients(AO.(ifam).FamilyName);
0414 
0415 <span class="keyword">for</span> ii=1:nb,
0416     AO.(ifam).Monitor.HW2PhysicsParams{1}(ii,:)  = coefficients;
0417     AO.(ifam).Monitor.Physics2HWParams{1}(ii,:)  = coefficients;
0418 <span class="keyword">end</span>
0419 
0420 <span class="comment">% AO.(ifam).Monitor.HW2PhysicsParams(ii,:)                  = HW2Physics*ScaleFactor;</span>
0421 <span class="comment">% AO.(ifam).Monitor.Physics2HWParams(ii,:)                  = ScaleFactor/HW2Physics;</span>
0422 
0423 AO.(ifam).Setpoint = AO.(ifam).Monitor;
0424 AO.(ifam).Desired = AO.(ifam).Monitor;
0425 AO.(ifam).Setpoint.MemberOf  = {<span class="string">'PlotFamily'</span>};
0426 AO.(ifam).Setpoint.TangoNames(:,:)    = strcat(dev,<span class="string">'/currentPM'</span>);
0427 
0428 AO.(ifam).Setpoint.Tolerance(:,:) = 1000*ones(nb,1);
0429 AO.(ifam).Setpoint.DeltaRespMat(:,:) = 3*ones(nb,1);
0430 AO.(ifam).Setpoint.DeltaSkewK = 1; <span class="comment">% for SkewQuad efficiency toward dispersion .</span>
0431 
0432 AO.(ifam).Profibus.BoardNumber = int32(0);
0433 AO.(ifam).Profibus.Group       = int32(1);
0434 AO.(ifam).Profibus.DeviceName  = <span class="string">'ANS/AE/DP.QT'</span>;
0435 
0436 <span class="comment">%convert response matrix kicks to HWUnits (after AO is loaded to AppData)</span>
0437 setao(AO);   <span class="comment">%required to make physics2hw function</span>
0438 AO.(ifam).Setpoint.DeltaRespMat = physics2hw(AO.(ifam).FamilyName, <span class="string">'Setpoint'</span>, <span class="keyword">...</span>
0439                        AO.(ifam).Setpoint.DeltaRespMat, AO.(ifam).DeviceList);
0440 
0441 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0442 <span class="comment">%% FAST HORIZONTAL CORRECTORS</span>
0443 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0444 ifam = <span class="string">'FHCOR'</span>;
0445 AO.(ifam).FamilyName               = ifam;
0446 AO.(ifam).FamilyType               = <span class="string">'FCOR'</span>;
0447 AO.(ifam).MemberOf                 = {<span class="string">'FCOR'</span>; <span class="string">'Magnet'</span>; <span class="string">'PlotFamily'</span>; <span class="string">'Archivable'</span>};
0448 
0449 AO.(ifam).Monitor.Mode             = Mode;
0450 AO.(ifam).Monitor.DataType         = <span class="string">'Scalar'</span>;
0451 AO.(ifam).Monitor.Units            = <span class="string">'Hardware'</span>;
0452 AO.(ifam).Monitor.HWUnits          = <span class="string">'A'</span>;
0453 AO.(ifam).Monitor.PhysicsUnits     = <span class="string">'rad'</span>;
0454 AO.(ifam).Monitor.HW2PhysicsFcn = @amp2k;
0455 AO.(ifam).Monitor.Physics2HWFcn = @k2amp;
0456 
0457 <span class="comment">% Get mapping from TANGO static database</span>
0458 map = tango_get_db_property(<span class="string">'anneau'</span>,<span class="string">'tracy_fastcorrectorH_mapping'</span>);
0459 cellindex  = cell2mat(regexpi(map,<span class="string">'-C[0-9]'</span>,<span class="string">'once'</span>))+2;
0460 numindex = cell2mat(regexpi(map,<span class="string">'\.[0-9]'</span>,<span class="string">'once'</span>))+1;
0461 
0462 elemindex = cell2mat(regexpi(map,<span class="string">'CH[0-9]'</span>,<span class="string">'once'</span>))+2;
0463 sep = cell2mat(regexpi(map,<span class="string">'::'</span>,<span class="string">'once'</span>))-1;
0464 <span class="comment">% dev = deblank(regexprep(char(map),'^CH\d*::',''));</span>
0465 dev = regexprep(map,<span class="string">'^FCH\d*::'</span>,<span class="string">''</span>)';
0466 
0467 nb = size(map,2);
0468 cellnum0 = 1;
0469 indexmagnet = 0;
0470 
0471 <span class="keyword">for</span> k = 1:nb,
0472     cellnum = str2double(map{k}(cellindex(k):cellindex(k)+1));
0473     <span class="keyword">if</span> (cellnum == cellnum0)
0474         indexmagnet = indexmagnet + 1;
0475     <span class="keyword">else</span>
0476         indexmagnet = 1;
0477         cellnum0 = cellnum;
0478     <span class="keyword">end</span>
0479     AO.(ifam).DeviceList(k,:)        = [cellnum indexmagnet];
0480     AO.(ifam).ElementList(k,:)       = str2double(map{k}(elemindex(k):sep(k)));
0481 <span class="keyword">end</span>
0482 
0483 AO.(ifam).DeviceName(:,:)            = dev;
0484 AO.(ifam).CommonNames(:,:)           = [repmat(AO.(ifam).FamilyName,nb,1) num2str((1:nb)',<span class="string">'%02d'</span>)];
0485 
0486 AO.(ifam).Monitor.TangoNames(:,:)    = strcat(dev,<span class="string">'/current'</span>);
0487 AO.(ifam).Status = ones(nb,1);
0488 
0489 AO.(ifam).Monitor.Range(:,:)        = repmat([-10 10],nb,1); <span class="comment">% 10 A for 280 urad</span>
0490 AO.(ifam).Monitor.Handles(:,1)       = NaN*ones(nb,1);
0491 
0492 <span class="comment">%Load fields from datablock</span>
0493 <span class="comment">% AT use the &quot;A-coefficients&quot; for correctors plus an offset</span>
0494 [C, Leff, MagnetType, HCMcoefficients] = magnetcoefficients(AO.(ifam).FamilyName);
0495 
0496 <span class="keyword">for</span> ii=1:nb,
0497     AO.(ifam).Monitor.HW2PhysicsParams{1}(ii,:)  = HCMcoefficients;
0498     AO.(ifam).Monitor.Physics2HWParams{1}(ii,:)  = HCMcoefficients;
0499 
0500 <span class="keyword">end</span>
0501 
0502 AO.(ifam).Setpoint = AO.(ifam).Monitor;
0503 AO.(ifam).Desired = AO.(ifam).Monitor;
0504 AO.(ifam).Setpoint.MemberOf  = {<span class="string">'PlotFamily'</span>};
0505 AO.(ifam).Setpoint.Tolerance(:,:)    = 1000*ones(nb,1);
0506 AO.(ifam).Setpoint.DeltaRespMat(:,:) = 3*ones(nb,1);
0507 
0508 AO.(ifam).Status=AO.(ifam).Status(:);
0509 
0510 <span class="comment">%convert response matrix kicks to HWUnits (after AO is loaded to AppData)</span>
0511 setao(AO);   <span class="comment">%required to make physics2hw function</span>
0512 AO.(ifam).Setpoint.DeltaRespMat = physics2hw(AO.(ifam).FamilyName,<span class="string">'Setpoint'</span>, <span class="keyword">...</span>
0513     AO.(ifam).Setpoint.DeltaRespMat, AO.(ifam).DeviceList);
0514 
0515 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0516 <span class="comment">%% FAST VERTICAL CORRECTORS</span>
0517 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0518 ifam = <span class="string">'FVCOR'</span>;
0519 AO.(ifam).FamilyName               = ifam;
0520 AO.(ifam).FamilyType               = <span class="string">'FCOR'</span>;
0521 AO.(ifam).MemberOf                 = {<span class="string">'FCOR'</span>; <span class="string">'Magnet'</span>; <span class="string">'PlotFamily'</span>; <span class="string">'Archivable'</span>};
0522 
0523 AO.(ifam).Monitor.Mode             = Mode;
0524 AO.(ifam).Monitor.DataType         = <span class="string">'Scalar'</span>;
0525 AO.(ifam).Monitor.Units            = <span class="string">'Hardware'</span>;
0526 AO.(ifam).Monitor.HWUnits          = <span class="string">'A'</span>;
0527 AO.(ifam).Monitor.PhysicsUnits     = <span class="string">'rad'</span>;
0528 AO.(ifam).Monitor.HW2PhysicsFcn = @amp2k;
0529 AO.(ifam).Monitor.Physics2HWFcn = @k2amp;
0530 
0531 <span class="comment">% Get mapping from TANGO static database</span>
0532 map = tango_get_db_property(<span class="string">'anneau'</span>,<span class="string">'tracy_fastcorrectorV_mapping'</span>);
0533 cellindex  = cell2mat(regexpi(map,<span class="string">'-C[0-9]'</span>,<span class="string">'once'</span>))+2;
0534 elemindex = cell2mat(regexpi(map,<span class="string">'CV[0-9]'</span>,<span class="string">'once'</span>))+2;
0535 sep = cell2mat(regexpi(map,<span class="string">'::'</span>,<span class="string">'once'</span>))-1;
0536 <span class="comment">% dev = deblank(regexprep(char(map),'^CV\d*::',''));</span>
0537 dev = regexprep(map,<span class="string">'^FCV\d*::'</span>,<span class="string">''</span>)';
0538 
0539 nb = size(map,2);
0540 cellnum0 = 1;
0541 indexmagnet = 0;
0542 
0543 <span class="keyword">for</span> k = 1:nb,
0544     cellnum = str2double(map{k}(cellindex(k):cellindex(k)+1));
0545     <span class="keyword">if</span> (cellnum == cellnum0)
0546         indexmagnet = indexmagnet + 1;
0547     <span class="keyword">else</span>
0548         indexmagnet = 1;
0549         cellnum0 = cellnum;
0550     <span class="keyword">end</span>
0551     AO.(ifam).DeviceList(k,:)      = [cellnum indexmagnet];
0552     AO.(ifam).ElementList(k,:)       = str2double(map{k}(elemindex(k):sep(k)));
0553 <span class="keyword">end</span>
0554 
0555 AO.(ifam).DeviceName(:,:)            = dev;
0556 AO.(ifam).CommonNames(:,:)           = [repmat(AO.(ifam).FamilyName,nb,1) num2str((1:nb)',<span class="string">'%02d'</span>)];
0557 
0558 AO.(ifam).Monitor.TangoNames(:,:)    = strcat(dev,<span class="string">'/current'</span>);
0559 AO.(ifam).Status = ones(nb,1);
0560 AO.(ifam).Monitor.Range(:,:) = repmat([-14 14],nb,1); <span class="comment">% 10 A for 240 urad</span>
0561 AO.(ifam).Monitor.Handles(:,1)    = NaN*ones(nb,1);
0562 
0563 <span class="comment">%Load fields from datablock</span>
0564 <span class="comment">% AT use the &quot;A-coefficients&quot; for correctors plus an offset</span>
0565 [C, Leff, MagnetType, coefficients] = magnetcoefficients(AO.(ifam).FamilyName);
0566 
0567 <span class="keyword">for</span> ii=1:nb,
0568     AO.(ifam).Monitor.HW2PhysicsParams{1}(ii,:)  = coefficients;
0569     AO.(ifam).Monitor.Physics2HWParams{1}(ii,:)  = coefficients;
0570 <span class="keyword">end</span>
0571 
0572 AO.(ifam).Status=AO.(ifam).Status(:);
0573 
0574 AO.(ifam).Setpoint = AO.(ifam).Monitor;
0575 AO.(ifam).Desired = AO.(ifam).Monitor;
0576 AO.(ifam).Setpoint.MemberOf  = {<span class="string">'PlotFamily'</span>};
0577 AO.(ifam).Setpoint.Tolerance(:,:)    = 1000*ones(nb,1);
0578 AO.(ifam).Setpoint.DeltaRespMat(:,:) = 3*ones(nb,1);
0579 
0580 <span class="comment">%convert response matrix kicks to HWUnits (after AO is loaded to AppData)</span>
0581 setao(AO);   <span class="comment">%required to make physics2hw function</span>
0582 AO.(ifam).Setpoint.DeltaRespMat = physics2hw(AO.(ifam).FamilyName,<span class="string">'Setpoint'</span>, <span class="keyword">...</span>
0583     AO.(ifam).Setpoint.DeltaRespMat, AO.(ifam).DeviceList);
0584 
0585 <span class="comment">%=============================</span>
0586 <span class="comment">%        MAIN MAGNETS</span>
0587 <span class="comment">%=============================</span>
0588 
0589 <span class="comment">%==============</span>
0590 <span class="comment">%% DIPOLES</span>
0591 <span class="comment">%==============</span>
0592 
0593 <span class="comment">% *** BEND ***</span>
0594 ifam=<span class="string">'BEND'</span>;
0595 AO.(ifam).FamilyName                 = ifam;
0596 AO.(ifam).FamilyType                 = <span class="string">'BEND'</span>;
0597 AO.(ifam).MemberOf                   = {<span class="string">'MachineConfig'</span>; <span class="string">'BEND'</span>; <span class="string">'Magnet'</span>; <span class="string">'PlotFamily'</span>; <span class="string">'Archivable'</span>};
0598 HW2PhysicsParams                    = magnetcoefficients(<span class="string">'BEND'</span>);
0599 Physics2HWParams                    = HW2PhysicsParams;
0600 
0601 AO.(ifam).Monitor.Mode               = Mode;
0602 AO.(ifam).Monitor.DataType           = <span class="string">'Scalar'</span>;
0603 AO.(ifam).Monitor.Units              = <span class="string">'Hardware'</span>;
0604 <span class="comment">% AO.(ifam).Monitor.HW2PhysicsFcn      = @amp2k;</span>
0605 <span class="comment">% AO.(ifam).Monitor.Physics2HWFcn      = @k2amp;</span>
0606 <span class="comment">% waiting for energy calibration</span>
0607 AO.(ifam).Monitor.HW2PhysicsFcn      = @bend2gev;
0608 AO.(ifam).Monitor.Physics2HWFcn      = @gev2bend;
0609 AO.(ifam).Monitor.HWUnits            = <span class="string">'A'</span>;
0610 AO.(ifam).Monitor.PhysicsUnits       = <span class="string">'GeV'</span>;
0611 
0612 
0613 <span class="comment">% % Get mapping from TANGO static database</span>
0614 <span class="comment">% map       = tango_get_db_property('anneau','tracy_dipole_mapping');</span>
0615 <span class="comment">% cellindex = cell2mat(regexpi(map,'C[0-9]','once'))+1;</span>
0616 <span class="comment">% numindex  = cell2mat(regexpi(map,'\.[0-9]','once'))+1;</span>
0617 <span class="comment">% elemindex = cell2mat(regexpi(map,'BEND[0-9]','once'))+4;</span>
0618 <span class="comment">% sep       = cell2mat(regexpi(map,'::','once'))-1;</span>
0619 <span class="comment">% dev       = regexprep(map,'^BEND\d*::','')';</span>
0620 <span class="comment">%</span>
0621 <span class="comment">% nb = size(map,2);</span>
0622 <span class="comment">% for k = 1:nb,</span>
0623 <span class="comment">%     AO.(ifam).DeviceList(k,:) = [str2double(map{k}(cellindex(k):cellindex(k)+1)) str2double(map{k}(numindex(k):end))];</span>
0624 <span class="comment">%     AO.(ifam).ElementList(k,:)= str2double(map{k}(elemindex(k):sep(k)));</span>
0625 <span class="comment">% end</span>
0626 <span class="comment">% AO.(ifam).DeviceName(:,:)    = dev;</span>
0627 <span class="comment">% AO.(ifam).Monitor.TangoNames(:,:)  = strcat(dev,'/current');</span>
0628 <span class="comment">% AO.(ifam).Status = ones(nb,1);</span>
0629 <span class="comment">% AO.(ifam).Monitor.Handles(:,1) = NaN*ones(nb,1);</span>
0630 <span class="comment">%</span>
0631 <span class="comment">% for ii=1:nb,</span>
0632 <span class="comment">%     val = 1.0;</span>
0633 <span class="comment">%     AO.(ifam).Monitor.HW2PhysicsParams{1}(ii,:)                 = HW2PhysicsParams;</span>
0634 <span class="comment">%     AO.(ifam).Monitor.HW2PhysicsParams{2}(ii,:)                 = val;</span>
0635 <span class="comment">%     AO.(ifam).Monitor.Physics2HWParams{1}(ii,:)                 = Physics2HWParams;</span>
0636 <span class="comment">%     AO.(ifam).Monitor.Physics2HWParams{2}(ii,:)                 = val;</span>
0637 <span class="comment">% end</span>
0638 
0639 AO.(ifam).DeviceName(:,:) = {<span class="string">'ANS/AE/Dipole'</span>};
0640 AO.(ifam).Monitor.TangoNames(:,:)  = strcat(AO.(ifam).DeviceName(:,:),<span class="string">'/current'</span>);
0641 
0642 AO.(ifam).DeviceList(:,:) = [1 1];
0643 AO.(ifam).ElementList(:,:)= 1;
0644 AO.(ifam).Status          = 1;
0645 
0646 val = 1;
0647 AO.(ifam).Monitor.HW2PhysicsParams{1}(:,:) = HW2PhysicsParams;
0648 AO.(ifam).Monitor.HW2PhysicsParams{2}(:,:) = val;
0649 AO.(ifam).Monitor.Physics2HWParams{1}(:,:) = Physics2HWParams;
0650 AO.(ifam).Monitor.Physics2HWParams{2}(:,:) = val;
0651 AO.(ifam).Monitor.Range(:,:) = [0 560]; <span class="comment">% 525 A for 1.71T</span>
0652 
0653 AO.(ifam).Setpoint = AO.(ifam).Monitor;
0654 AO.(ifam).Desired  = AO.(ifam).Monitor;
0655 AO.(ifam).Setpoint.MemberOf  = {<span class="string">'PlotFamily'</span>};
0656 AO.(ifam).Setpoint.TangoNames(:,:)  = strcat(AO.(ifam).DeviceName,<span class="string">'/currentPM'</span>);
0657 
0658 AO.(ifam).Setpoint.Tolerance(:,:) = 0.05;
0659 AO.(ifam).Setpoint.DeltaRespMat(:,:) = 0.05;
0660 
0661 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0662 <span class="comment">%% QUADRUPOLE MAGNETS</span>
0663 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0664 
0665 map=tango_get_db_property(<span class="string">'anneau'</span>,<span class="string">'tracy_quadrupole_mapping'</span>);
0666 iifam = cell2mat(regexpi(map,<span class="string">'/Q'</span>,<span class="string">'once'</span>))+2;
0667 
0668 <span class="comment">% build mapping for the ten families</span>
0669 <span class="comment">% cleanup</span>
0670 <span class="keyword">for</span> k = 1:10,
0671     eval([[<span class="string">'map'</span> num2str(k)] <span class="string">'= [];'</span>]);
0672 <span class="keyword">end</span>
0673 
0674 <span class="comment">% do the job</span>
0675 <span class="keyword">for</span> k = 1:size(map,2)
0676     fam = map{k}(iifam(k));
0677     <span class="keyword">if</span> ((fam == <span class="string">'1'</span>) &amp;&amp; (~isempty(regexpi(map{k},<span class="string">'/Q10'</span>))))
0678         fam = <span class="string">'10'</span>;
0679     <span class="keyword">end</span>
0680     eval([[<span class="string">'map'</span> fam ] <span class="string">'='</span> <span class="string">'['</span> [<span class="string">'map'</span> fam] <span class="string">'  '</span> <span class="string">'map(k)'</span> <span class="string">' ];'</span> ]')
0681 <span class="keyword">end</span>
0682 
0683 <span class="comment">% quadrupole step for tune response matrix measurement for DNU = 1e-2</span>
0684 <span class="comment">% (depends on plane).</span>
0685 tune = [ 4e-3 1.4e-3 4e-3 1.5e-3 1.6e-3 1.3e-3 7e-4 1.9e-3 1.5e-3 1.5e-3]; 
0686     
0687 <span class="keyword">for</span> k = 1:10,
0688     cellindex  = cell2mat(regexpi(eval([<span class="string">'map'</span> num2str(k)]),<span class="string">'-C[0-9]'</span>,<span class="string">'once'</span>))+2;
0689     <span class="comment">% sep = cell2mat(regexpi(eval(['map' num2str(k)]),'::','once'))-1;</span>
0690     <span class="comment">% dev = deblank(regexprep(char(eval(['map' num2str(k)])),'^QP\d*::',''));</span>
0691     dev = regexprep(eval([<span class="string">'map'</span> num2str(k)]),<span class="string">'^QP\d*::'</span>,<span class="string">''</span>)';
0692     numindex = regexpi(eval([<span class="string">'map'</span> num2str(k)]),<span class="string">'\.[0-9]'</span>,<span class="string">'once'</span>);
0693 
0694     ifam = [<span class="string">'Q'</span> num2str(k)];
0695 
0696     AO.(ifam).FamilyName                 = ifam;
0697     AO.(ifam).FamilyType                 = <span class="string">'QUAD'</span>;
0698     AO.(ifam).MemberOf                   = {<span class="string">'MachineConfig'</span>; <span class="string">'QUAD'</span>; <span class="string">'Magnet'</span>; <span class="string">'PlotFamily'</span>; <span class="string">'Archivable'</span>};
0699     HW2PhysicsParams                    = magnetcoefficients(AO.(ifam).FamilyName);
0700     Physics2HWParams                    = magnetcoefficients(AO.(ifam).FamilyName);
0701 
0702     AO.(ifam).Monitor.Mode               = Mode;
0703     AO.(ifam).Monitor.DataType           = <span class="string">'Scalar'</span>;
0704     AO.(ifam).Monitor.Units              = <span class="string">'Hardware'</span>;
0705     AO.(ifam).Monitor.HWUnits            = <span class="string">'A'</span>;
0706     AO.(ifam).Monitor.PhysicsUnits       = <span class="string">'meter^-2'</span>;
0707     AO.(ifam).Monitor.HW2PhysicsFcn      = @amp2k;
0708     AO.(ifam).Monitor.Physics2HWFcn      = @k2amp;
0709 
0710     nb = size(eval([<span class="string">'map'</span> num2str(k)]),2);
0711     <span class="keyword">for</span> kk = 1:nb,
0712         <span class="keyword">if</span> isempty(numindex{kk})
0713             AO.(ifam).DeviceList(kk,:) = [str2double(eval([<span class="string">'map'</span> num2str(k) <span class="keyword">...</span>
0714                 <span class="string">'{kk}(cellindex(kk):cellindex(kk)+1)'</span>])) 1];
0715         <span class="keyword">else</span>
0716             AO.(ifam).DeviceList(kk,:) = [str2double(eval([<span class="string">'map'</span> num2str(k) <span class="keyword">...</span>
0717                 <span class="string">'{kk}(cellindex(kk):cellindex(kk)+1)'</span>])) <span class="keyword">...</span>
0718                 str2double(eval([<span class="string">'map'</span> num2str(k) <span class="string">'{kk}(numindex{kk}+1:end)'</span>]))];
0719         <span class="keyword">end</span>
0720         AO.(ifam).ElementList(kk,:)  = kk;
0721     <span class="keyword">end</span>
0722 
0723     AO.(ifam).DeviceName(:,:)    = dev;
0724     <span class="comment">%% Build common names</span>
0725     <span class="keyword">if</span> (nb &gt;= 10)
0726         AO.(ifam).CommonNames(:,:)   = [repmat(AO.(ifam).FamilyName,nb,1) num2str((1:nb)',<span class="string">'.%02d'</span>)];
0727     <span class="keyword">else</span>
0728         AO.(ifam).CommonNames(:,:)   = [repmat(AO.(ifam).FamilyName,nb,1) num2str((1:nb)',<span class="string">'.%1d'</span>)];
0729     <span class="keyword">end</span>
0730 
0731     AO.(ifam).Monitor.TangoNames(:,:)  = strcat(dev,<span class="string">'/current'</span>);
0732     AO.(ifam).Status = ones(nb,1);
0733     AO.(ifam).Monitor.Handles(:,1) = NaN*ones(nb,1);
0734 
0735     <span class="keyword">for</span> ii=1:nb,
0736         val = 1.0;
0737         AO.(ifam).Monitor.HW2PhysicsParams{1}(ii,:)                 = HW2PhysicsParams;
0738         AO.(ifam).Monitor.HW2PhysicsParams{2}(ii,:)                 = val;
0739         AO.(ifam).Monitor.Physics2HWParams{1}(ii,:)                 = Physics2HWParams;
0740         AO.(ifam).Monitor.Physics2HWParams{2}(ii,:)                 = val;
0741     <span class="keyword">end</span>
0742 
0743     <span class="comment">% Greg Portmann, visit mai</span>
0744     <span class="comment">%     AO.Q1.Monitor.HW2PhysicsParams{1} = 'Q1';</span>
0745     <span class="comment">%     AO.Q1.Monitor.Physics2HWParams{1} = 'Q1';</span>
0746 
0747     AO.(ifam).Setpoint = AO.(ifam).Monitor;
0748     AO.(ifam).Desired  = AO.(ifam).Monitor;
0749     AO.(ifam).Setpoint.MemberOf  = {<span class="string">'PlotFamily'</span>};
0750     AO.(ifam).Setpoint.TangoNames(:,:)  = strcat(dev,<span class="string">'/currentPM'</span>);
0751     
0752     AO.(ifam).Setpoint.Tolerance(:,:) = 0.05*ones(nb,1);
0753     AO.(ifam).Setpoint.DeltaRespMat(:,:) = tune(k)*ones(nb,1);
0754     <span class="keyword">if</span> k &lt; 6
0755         AO.(ifam).Profibus.BoardNumber = int32(1);
0756         AO.(ifam).Profibus.Group       = int32(k);
0757     <span class="keyword">else</span>
0758         AO.(ifam).Profibus.BoardNumber = int32(0);
0759         AO.(ifam).Profibus.Group       = int32(k-5);
0760     <span class="keyword">end</span>        
0761     AO.(ifam).Profibus.DeviceName  = <span class="string">'ANS/AE/DP.QP'</span>;
0762     
0763     <span class="comment">%convert response matrix kicks to HWUnits (after AO is loaded to AppData)</span>
0764     setao(AO);   <span class="comment">%required to make physics2hw function</span>
0765 <span class="comment">%     AO.(ifam).Setpoint.DeltaRespMat = physics2hw(AO.(ifam).FamilyName, ...</span>
0766 <span class="comment">%         'Setpoint',AO.(ifam).Setpoint.DeltaRespMat,AO.(ifam).DeviceList,2.75);</span>
0767     AO.(ifam).Setpoint.DeltaKBeta = 1; <span class="comment">% for betatron function measurement.</span>
0768     AO.(ifam).Setpoint.DeltaRespMat = 1; <span class="comment">% A</span>
0769 <span class="keyword">end</span>
0770 
0771 <span class="comment">% TODO : this is lattice dependent !</span>
0772 <span class="comment">% step for tuneshift of 1-e-2 in one of the planes</span>
0773 AO.Q1.Setpoint.DeltaRespMat = 0.4; <span class="comment">%A</span>
0774 AO.Q2.Setpoint.DeltaRespMat = 0.15;<span class="comment">%A</span>
0775 AO.Q3.Setpoint.DeltaRespMat = 0.5; <span class="comment">%A</span>
0776 AO.Q4.Setpoint.DeltaRespMat = 0.2; <span class="comment">%A</span>
0777 AO.Q5.Setpoint.DeltaRespMat = 0.2; <span class="comment">%A</span>
0778 AO.Q6.Setpoint.DeltaRespMat = 0.2; <span class="comment">%A</span>
0779 AO.Q7.Setpoint.DeltaRespMat = 0.2; <span class="comment">%A</span>
0780 AO.Q8.Setpoint.DeltaRespMat = 0.2; <span class="comment">%A</span>
0781 AO.Q9.Setpoint.DeltaRespMat = 0.2; <span class="comment">%A</span>
0782 AO.Q10.Setpoint.DeltaRespMat = 0.2; <span class="comment">%A</span>
0783 
0784 <span class="comment">%% QC13</span>
0785 ifam = <span class="string">'QC13'</span>;
0786 
0787 AO.(ifam).FamilyName             = ifam;
0788 AO.(ifam).MemberOf               = {ifam;<span class="string">'PlotFamily'</span>};
0789 AO.(ifam).FamilyType             = <span class="string">'QUAD'</span>;
0790 AO.(ifam).Mode                   = Mode;
0791 AO.(ifam).DeviceName             = {<span class="string">'ANS-C13/AE/Q1'</span>; <span class="string">'ANS-C13/AE/Q2'</span>; <span class="string">'ANS-C13/AE/Q3'</span>;  <span class="string">'ANS-C13/AE/Q4.1'</span>; 
0792                                     <span class="string">'ANS-C13/AE/Q5.1'</span>; <span class="string">'ANS-C13/AE/Q5.2'</span>; <span class="string">'ANS-C13/AE/Q4.2'</span>; <span class="string">'ANS-C13/AE/Q6'</span>; 
0793                                     <span class="string">'ANS-C13/AE/Q7'</span>; <span class="string">'ANS-C13/AE/Q8'</span> };
0794 AO.(ifam).DeviceList             = [13 1; 13 2; 13 3; 13 4; 13 5; 13 6; 13 7; 13 8; 13 9; 13 10];
0795 nb = length(AO.(ifam).DeviceList);
0796 AO.(ifam).ElementList            = (1:nb)';
0797 AO.(ifam).Status = ones(nb,1);
0798 AO.(ifam).Monitor.Mode           = Mode;
0799 AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(nb,1);
0800 AO.(ifam).Monitor.DataType       = <span class="string">'Scalar'</span>;
0801 AO.(ifam).Monitor.Units          = <span class="string">'Hardware'</span>;
0802 AO.(ifam).Monitor.HWUnits        = <span class="string">'ampere'</span>;
0803 AO.(ifam).Monitor.PhysicsUnits   = <span class="string">'meter^-2'</span>;
0804 AO.(ifam).Monitor.HW2PhysicsFcn  = @amp2k;
0805 AO.(ifam).Monitor.Physics2HWFcn  = @k2amp;
0806 AO.(ifam).Monitor.TangoNames     = strcat(AO.(ifam).DeviceName, <span class="string">'/current'</span>);
0807 AO.(ifam).Setpoint               = AO.(ifam).Monitor;
0808 AO.(ifam).Desired                = AO.(ifam).Monitor;
0809 AO.(ifam).Setpoint.MemberOf      = {<span class="string">'PlotFamily'</span>};
0810 AO.(ifam).Setpoint.TangoNames(:,:)  = strcat(AO.(ifam).DeviceName,<span class="string">'/currentPM'</span>);
0811 
0812 
0813 clear tune
0814 
0815 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0816 <span class="comment">%% SEXTUPOLE MAGNETS</span>
0817 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0818 
0819 <span class="keyword">for</span> k = 1:10,
0820     ifam = [<span class="string">'S'</span> num2str(k)];
0821 
0822     AO.(ifam).FamilyName                = ifam;
0823     AO.(ifam).FamilyType                = <span class="string">'SEXT'</span>;
0824     AO.(ifam).MemberOf                  = {<span class="string">'MachineConfig'</span>; <span class="string">'SEXT'</span>; <span class="string">'Magnet'</span>; <span class="string">'PlotFamily'</span>; <span class="string">'Archivable'</span>};
0825     [C, Leff, MagnetType, coefficients]= magnetcoefficients(AO.(ifam).FamilyName);
0826     HW2PhysicsParams                   = C;
0827     Physics2HWParams                   = HW2PhysicsParams;
0828 
0829     AO.(ifam).Monitor.Mode              = Mode;
0830     AO.(ifam).Monitor.DataType          = <span class="string">'Scalar'</span>;
0831     AO.(ifam).Monitor.Units             = <span class="string">'Hardware'</span>;
0832     AO.(ifam).Monitor.HW2PhysicsFcn     = @amp2k;
0833     AO.(ifam).Monitor.Physics2HWFcn     = @k2amp;
0834     AO.(ifam).Monitor.HWUnits           = <span class="string">'A'</span>;
0835     AO.(ifam).Monitor.PhysicsUnits      = <span class="string">'meter^-3'</span>;
0836     AO.(ifam).DeviceList                = [1 1];
0837     AO.(ifam).ElementList               = 1;
0838 
0839     AO.(ifam).DeviceName    = [<span class="string">'ANS/AE/S'</span> num2str(k)];
0840     AO.(ifam).CommonNames   = ifam;
0841 
0842     dev = AO.(ifam).DeviceName;
0843     AO.(ifam).Monitor.TangoNames  = strcat(dev,<span class="string">'/current'</span>);
0844  
0845     AO.(ifam).Status          = 1;
0846     AO.(ifam).Monitor.Handles = NaN;
0847     
0848     val = 1.0; <span class="comment">% scaling factor</span>
0849     
0850     AO.(ifam).Monitor.HW2PhysicsParams{1}(1,:)               = HW2PhysicsParams;
0851     AO.(ifam).Monitor.HW2PhysicsParams{2}(1,:)               = val;
0852     AO.(ifam).Monitor.Physics2HWParams{1}(1,:)               = Physics2HWParams;
0853     AO.(ifam).Monitor.Physics2HWParams{2}(1,:)               = val;
0854 
0855     AO.(ifam).Monitor.Range(:,:) = [0 400]; <span class="comment">% 343 A for 320 Tm-2</span>
0856 
0857     AO.(ifam).Setpoint.MemberOf  = {<span class="string">'PlotFamily'</span>};
0858     AO.(ifam).Setpoint = AO.(ifam).Monitor;
0859     AO.(ifam).Desired  = AO.(ifam).Monitor;
0860     AO.(ifam).Setpoint.TangoNames   = strcat(dev,<span class="string">'/currentPM'</span>);
0861     
0862     AO.(ifam).Setpoint.Tolerance     = 0.05;
0863     AO.(ifam).Setpoint.DeltaRespMat  = 2e7; <span class="comment">% Physics units for a thin sextupole</span>
0864  
0865     <span class="comment">%convert response matrix kicks to HWUnits (after AO is loaded to AppData)</span>
0866     setao(AO);   <span class="comment">%required to make physics2hw function</span>
0867     AO.(ifam).Setpoint.DeltaRespMat=physics2hw(AO.(ifam).FamilyName,<span class="string">'Setpoint'</span>,AO.(ifam).Setpoint.DeltaRespMat,AO.(ifam).DeviceList);
0868 <span class="keyword">end</span>
0869 
0870 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
0871 <span class="comment">%% Pulsed Magnet</span>
0872 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
0873 
0874 <span class="comment">%% All Injection kicker</span>
0875 ifam = <span class="string">'K_INJ'</span>; 
0876 AO.(ifam).FamilyName           = ifam;
0877 AO.(ifam).FamilyType           = ifam;
0878 AO.(ifam).MemberOf             = {<span class="string">'Injection'</span>;<span class="string">'Archivable'</span>;<span class="string">'EP'</span>};
0879 AO.(ifam).Monitor.Mode         = Mode;
0880 AO.(ifam).Monitor.DataType     = <span class="string">'Scalar'</span>;
0881 
0882 AO.(ifam).Status                   = ones(4,1);
0883 AO.(ifam).DeviceName               = [<span class="string">'ANS-C01/EP/AL_K.1'</span>; <span class="string">'ANS-C01/EP/AL_K.2'</span>; <span class="string">'ANS-C01/EP/AL_K.3'</span>; <span class="string">'ANS-C01/EP/AL_K.4'</span>];
0884 AO.(ifam).CommonNames              = ifam;
0885 AO.(ifam).ElementList              = [1 2 3 4]';
0886 AO.(ifam).DeviceList(:,:)          = [1 1; 1 2; 1 3; 1 4];
0887 AO.(ifam).Monitor.Handles(:,1)     = NaN*ones(4,1);
0888 AO.(ifam).Monitor.TangoNames       = strcat(AO.(ifam).DeviceName, <span class="string">'/voltage'</span>);
0889 AO.(ifam).Monitor.Units            = <span class="string">'Hardware'</span>;   
0890 AO.(ifam).Monitor.HWUnits          = <span class="string">'V'</span>;
0891 AO.(ifam).Monitor.PhysicsUnits     = <span class="string">'mrad'</span>;
0892 AO.(ifam).Monitor.HW2PhysicsFcn     = @amp2k;
0893 AO.(ifam).Monitor.Physics2HWFcn     = @k2amp;
0894 HW2PhysicsParams                    = magnetcoefficients(ifam);
0895 Physics2HWParams                    = HW2PhysicsParams;
0896 AO.(ifam).Monitor.HW2PhysicsParams{1}(:,:) = HW2PhysicsParams;
0897 AO.(ifam).Monitor.HW2PhysicsParams{2}(:,:) = 1;
0898 AO.(ifam).Monitor.Physics2HWParams{1}(:,:) = Physics2HWParams;
0899 AO.(ifam).Monitor.Physics2HWParams{2}(:,:) = 1;
0900 AO.(ifam).Setpoint = AO.(ifam).Monitor;
0901 AO.(ifam).Desired = AO.(ifam).Monitor;
0902 
0903 <span class="comment">%% K1 and K4 Injection kicker</span>
0904 ifam = <span class="string">'K_INJ1'</span>; 
0905 AO.(ifam).FamilyName           = ifam;
0906 AO.(ifam).FamilyType           = ifam;
0907 AO.(ifam).MemberOf             = {<span class="string">'Injection'</span>;<span class="string">'Archivable'</span>;<span class="string">'EP'</span>};
0908 AO.(ifam).Monitor.Mode         = Mode;
0909 AO.(ifam).Monitor.DataType     = <span class="string">'Scalar'</span>;
0910 
0911 AO.(ifam).Status                   = ones(2,1);
0912 AO.(ifam).DeviceName               = [<span class="string">'ANS-C01/EP/AL_K.1'</span>; <span class="string">'ANS-C01/EP/AL_K.4'</span>];
0913 AO.(ifam).CommonNames              = ifam;
0914 AO.(ifam).ElementList              = [1 2]';
0915 AO.(ifam).DeviceList(:,:)          = [1 1;  1 4];
0916 AO.(ifam).Monitor.Handles(:,1)     = NaN*ones(2,1);
0917 AO.(ifam).Monitor.TangoNames       = strcat(AO.(ifam).DeviceName, <span class="string">'/voltage'</span>);
0918 AO.(ifam).Monitor.Units            = <span class="string">'Hardware'</span>;   
0919 AO.(ifam).Monitor.HWUnits          = <span class="string">'V'</span>;
0920 AO.(ifam).Monitor.PhysicsUnits     = <span class="string">'mrad'</span>;
0921 AO.(ifam).Monitor.HW2PhysicsFcn     = @amp2k;
0922 AO.(ifam).Monitor.Physics2HWFcn     = @k2amp;
0923 HW2PhysicsParams                    = magnetcoefficients(ifam);
0924 Physics2HWParams                    = HW2PhysicsParams;
0925 AO.(ifam).Monitor.HW2PhysicsParams{1}(:,:) = HW2PhysicsParams;
0926 AO.(ifam).Monitor.HW2PhysicsParams{2}(:,:) = 1;
0927 AO.(ifam).Monitor.Physics2HWParams{1}(:,:) = Physics2HWParams;
0928 AO.(ifam).Monitor.Physics2HWParams{2}(:,:) = 1;
0929 AO.(ifam).Setpoint = AO.(ifam).Monitor;
0930 AO.(ifam).Desired = AO.(ifam).Monitor;
0931 
0932 <span class="comment">%% K2 and K3 Injection kicker</span>
0933 ifam = <span class="string">'K_INJ2'</span>; 
0934 AO.(ifam).FamilyName           = ifam;
0935 AO.(ifam).FamilyType           = ifam;
0936 AO.(ifam).MemberOf             = {<span class="string">'Injection'</span>;<span class="string">'Archivable'</span>;<span class="string">'EP'</span>};
0937 AO.(ifam).Monitor.Mode         = Mode;
0938 AO.(ifam).Monitor.DataType     = <span class="string">'Scalar'</span>;
0939 
0940 AO.(ifam).Status                   = ones(2,1);
0941 AO.(ifam).DeviceName               = [<span class="string">'ANS-C01/EP/AL_K.2'</span>; <span class="string">'ANS-C01/EP/AL_K.3'</span>];
0942 AO.(ifam).CommonNames              = ifam;
0943 AO.(ifam).ElementList              = [1 2]';
0944 AO.(ifam).DeviceList(:,:)          = [1 2;  1 3];
0945 AO.(ifam).Monitor.Handles(:,1)     = NaN*ones(2,1);
0946 AO.(ifam).Monitor.TangoNames       = strcat(AO.(ifam).DeviceName, <span class="string">'/voltage'</span>);
0947 AO.(ifam).Monitor.Units            = <span class="string">'Hardware'</span>;   
0948 AO.(ifam).Monitor.HWUnits          = <span class="string">'V'</span>;
0949 AO.(ifam).Monitor.PhysicsUnits     = <span class="string">'mrad'</span>;
0950 AO.(ifam).Monitor.HW2PhysicsFcn     = @amp2k;
0951 AO.(ifam).Monitor.Physics2HWFcn     = @k2amp;
0952 HW2PhysicsParams                    = magnetcoefficients(ifam);
0953 Physics2HWParams                    = HW2PhysicsParams;
0954 AO.(ifam).Monitor.HW2PhysicsParams{1}(:,:) = HW2PhysicsParams;
0955 AO.(ifam).Monitor.HW2PhysicsParams{2}(:,:) = 1;
0956 AO.(ifam).Monitor.Physics2HWParams{1}(:,:) = Physics2HWParams;
0957 AO.(ifam).Monitor.Physics2HWParams{2}(:,:) = 1;
0958 AO.(ifam).Setpoint = AO.(ifam).Monitor;
0959 AO.(ifam).Desired = AO.(ifam).Monitor;
0960 
0961 <span class="comment">%% Septum Passif</span>
0962 ifam = <span class="string">'SEP_P'</span>; 
0963 AO.(ifam).FamilyName           =  ifam;
0964 AO.(ifam).FamilyType           =  ifam;
0965 AO.(ifam).MemberOf             =  {<span class="string">'Injection'</span>;<span class="string">'Archivable'</span>;<span class="string">'EP'</span>};
0966 AO.(ifam).Monitor.Mode         =   Mode;
0967 AO.(ifam).Monitor.DataType     =  <span class="string">'Scalar'</span>;
0968 
0969 AO.(ifam).Status                   = 1;
0970 AO.(ifam).DeviceName               = cellstr(<span class="string">'ANS-C01/EP/AL_SEP_P.1'</span>);
0971 AO.(ifam).CommonNames              = ifam;
0972 AO.(ifam).ElementList              = 1;
0973 AO.(ifam).DeviceList(:,:)          = [1 1];
0974 AO.(ifam).Monitor.Handles(:,1)     = NaN;
0975 AO.(ifam).Monitor.TangoNames       = strcat(AO.(ifam).DeviceName, <span class="string">'/serialVoltage'</span>);
0976 AO.(ifam).Monitor.HW2PhysicsFcn    = @amp2k;
0977 AO.(ifam).Monitor.Physics2HWFcn    = @k2amp;
0978 HW2PhysicsParams                   = magnetcoefficients(ifam);
0979 Physics2HWParams                   = HW2PhysicsParams;
0980 AO.(ifam).Monitor.HW2PhysicsParams{1}(:,:) = HW2PhysicsParams;
0981 AO.(ifam).Monitor.HW2PhysicsParams{2}(:,:) = 1;
0982 AO.(ifam).Monitor.Physics2HWParams{1}(:,:) = Physics2HWParams;
0983 AO.(ifam).Monitor.Physics2HWParams{2}(:,:) = 1;
0984 AO.(ifam).Monitor.Units            = <span class="string">'Hardware'</span>;   
0985 AO.(ifam).Monitor.HWUnits          = <span class="string">'V'</span>;
0986 AO.(ifam).Monitor.PhysicsUnits     = <span class="string">'mrad'</span>;
0987 AO.(ifam).Desired  = AO.(ifam).Monitor;
0988 AO.(ifam).Setpoint = AO.(ifam).Monitor;
0989 
0990 
0991 <span class="comment">%% Septum Actif</span>
0992 ifam = <span class="string">'SEP_A'</span>; 
0993 AO.(ifam).FamilyName           = ifam;
0994 AO.(ifam).FamilyType           = ifam;
0995 AO.(ifam).MemberOf             = {<span class="string">'Injection'</span>;<span class="string">'Archivable'</span>;<span class="string">'EP'</span>};
0996 AO.(ifam).Monitor.Mode         = Mode;
0997 AO.(ifam).Monitor.DataType     = <span class="string">'Scalar'</span>;
0998 
0999 AO.(ifam).Status                   = 1;
1000 AO.(ifam).DeviceName               = cellstr(<span class="string">'ANS-C01/EP/AL_SEP_A'</span>);
1001 AO.(ifam).CommonNames              = <span class="string">'SEP_A_INJ'</span>;
1002 AO.(ifam).ElementList              = 1;
1003 AO.(ifam).DeviceList(:,:)           = [1 1];
1004 AO.(ifam).Monitor.Handles(:,1)     = NaN;
1005 AO.(ifam).Monitor.TangoNames       = strcat(AO.(ifam).DeviceName, <span class="string">'/voltage'</span>);
1006 AO.(ifam).Monitor.HW2PhysicsFcn     = @amp2k;
1007 AO.(ifam).Monitor.Physics2HWFcn     = @k2amp;
1008 HW2PhysicsParams                    = magnetcoefficients(ifam);
1009 Physics2HWParams                    = HW2PhysicsParams;
1010 AO.(ifam).Monitor.HW2PhysicsParams{1}(:,:) = HW2PhysicsParams;
1011 AO.(ifam).Monitor.HW2PhysicsParams{2}(:,:) = 1;
1012 AO.(ifam).Monitor.Physics2HWParams{1}(:,:) = Physics2HWParams;
1013 AO.(ifam).Monitor.Physics2HWParams{2}(:,:) = 1;
1014 AO.(ifam).Monitor.Units            = <span class="string">'Hardware'</span>;   
1015 AO.(ifam).Monitor.HWUnits          = <span class="string">'V'</span>;
1016 AO.(ifam).Monitor.PhysicsUnits     = <span class="string">'mrad'</span>;
1017 AO.(ifam).Setpoint = AO.(ifam).Monitor;
1018 AO.(ifam).Desired = AO.(ifam).Monitor;
1019 
1020 
1021 <span class="comment">%% tune correctors</span>
1022 AO.Q7.MemberOf  = {AO.Q7.MemberOf{:} <span class="string">'Tune Corrector'</span>}';
1023 AO.Q9.MemberOf = {AO.Q9.MemberOf{:} <span class="string">'Tune Corrector'</span>}';
1024 
1025 <span class="comment">%% chromaticity correctors</span>
1026 AO.S9.MemberOf  = {AO.S9.MemberOf{:} <span class="string">'Chromaticity Corrector'</span>}';
1027 AO.S10.MemberOf = {AO.S10.MemberOf{:} <span class="string">'Chromaticity Corrector'</span>}';
1028 
1029 
1030 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
1031 <span class="comment">%% CYCLAGE</span>
1032 <span class="comment">%%%%%%%%%%%%%%%%%</span>
1033 
1034 disp(<span class="string">'cycling configuration ...'</span>);
1035 
1036 <span class="comment">%% cycleramp For dipole magnet</span>
1037 ifam = <span class="string">'CycleBEND'</span>;
1038 
1039 AO.(ifam).FamilyName             = <span class="string">'CycleBEND'</span>;
1040 AO.(ifam).MemberOf               = {<span class="string">'CycleBEND'</span>; <span class="string">'Cyclage'</span>};
1041 AO.(ifam).Mode                   = Mode;
1042 AO.(ifam).GroupId                = tango_group_create(<span class="string">'Dipole'</span>); 
1043 AO.(ifam).DeviceName             = <span class="string">'ANS/AE/cycleDipole'</span>;
1044 AO.(ifam).DeviceList             = [1 1]; 
1045 AO.(ifam).ElementList            = 1;
1046 <span class="comment">%add devices to group</span>
1047 tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName);
1048 AO.(ifam).Inom = 541.789;
1049 AO.(ifam).Imax = 579.9;
1050 AO.(ifam).Status = 1;
1051 
1052 <span class="comment">% %% cycleramp For H-corrector magnets</span>
1053 <span class="comment">% ifam  = 'CycleHCOR';</span>
1054 <span class="comment">% ifamQ = 'HCOR';</span>
1055 <span class="comment">%</span>
1056 <span class="comment">% AO.(ifam).FamilyName             = ifam;</span>
1057 <span class="comment">% AO.(ifam).MemberOf               = {'CycleCOR'; ifam; 'Cyclage'};</span>
1058 <span class="comment">% AO.(ifam).Mode                   = Mode;</span>
1059 <span class="comment">% AO.(ifam).GroupId                = tango_group_create('COR');</span>
1060 <span class="comment">% dev = getfamilydata(ifamQ,'DeviceName');</span>
1061 <span class="comment">% AO.(ifam).DeviceName             = regexprep(dev,'/S','/cycleS');</span>
1062 <span class="comment">% AO.(ifam).DeviceList             = family2dev(ifamQ);</span>
1063 <span class="comment">% AO.(ifam).ElementList            = family2elem(ifamQ);</span>
1064 <span class="comment">% %add devices to group</span>
1065 <span class="comment">% tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName');</span>
1066 <span class="comment">% nb = length(AO.(ifam).ElementList);</span>
1067 <span class="comment">% AO.(ifam).Inom = 1.*ones(1,nb);</span>
1068 <span class="comment">% AO.(ifam).Imax = 13.99*ones(1,nb);</span>
1069 <span class="comment">% AO.(ifam).Status = ones(nb,1);</span>
1070 <span class="comment">% AO.(ifam).Monitor.Mode           = Mode;</span>
1071 <span class="comment">% AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(nb,1);</span>
1072 <span class="comment">% AO.(ifam).Monitor.DataType       = 'Scalar';</span>
1073 <span class="comment">% AO.(ifam).Monitor.Units          = 'Hardware';</span>
1074 <span class="comment">% AO.(ifam).Monitor.HWUnits        = 'ampere';</span>
1075 <span class="comment">% AO.(ifam).Monitor.PhysicsUnits   = 'rad';</span>
1076 <span class="comment">% AO.(ifam).Monitor.TangoNames   = strcat(AO.(ifam).DeviceName, '/totalProgression');</span>
1077 <span class="comment">%</span>
1078 <span class="comment">% %% cycleramp For V-corrector magnets</span>
1079 <span class="comment">% ifam = 'CycleVCOR';</span>
1080 <span class="comment">% ifamQ = 'VCOR';</span>
1081 <span class="comment">%</span>
1082 <span class="comment">% AO.(ifam).FamilyName             = ifam;</span>
1083 <span class="comment">% AO.(ifam).MemberOf               = {'CycleCOR'; ifam; 'Cyclage'};</span>
1084 <span class="comment">% AO.(ifam).Mode                   = Mode;</span>
1085 <span class="comment">% dev = getfamilydata(ifamQ,'DeviceName');</span>
1086 <span class="comment">% AO.(ifam).DeviceName             = regexprep(dev,'/S','/cycleS');</span>
1087 <span class="comment">% AO.(ifam).DeviceList             = family2dev(ifamQ);</span>
1088 <span class="comment">% AO.(ifam).ElementList            = family2elem(ifamQ);</span>
1089 <span class="comment">% %add devices to group</span>
1090 <span class="comment">% AO.(ifam).GroupId                = tango_group_create('COR');</span>
1091 <span class="comment">% tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName');</span>
1092 <span class="comment">% nb = length(AO.(ifam).ElementList);</span>
1093 <span class="comment">% AO.(ifam).Inom = 1.*ones(1,nb);</span>
1094 <span class="comment">% AO.(ifam).Imax = 13.99*ones(1,nb);</span>
1095 <span class="comment">% AO.(ifam).Status = ones(nb,1);</span>
1096 <span class="comment">% AO.(ifam).Monitor.Mode           = Mode;</span>
1097 <span class="comment">% AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(nb,1);</span>
1098 <span class="comment">% AO.(ifam).Monitor.DataType       = 'Scalar';</span>
1099 <span class="comment">% AO.(ifam).Monitor.Units          = 'Hardware';</span>
1100 <span class="comment">% AO.(ifam).Monitor.HWUnits        = 'ampere';</span>
1101 <span class="comment">% AO.(ifam).Monitor.PhysicsUnits   = 'rad';</span>
1102 <span class="comment">% AO.(ifam).Monitor.TangoNames   = strcat(AO.(ifam).DeviceName, '/totalProgression');</span>
1103 
1104 <span class="comment">% cycleramp For quadrupoles magnets</span>
1105 <span class="comment">%% CYCLEQ1</span>
1106 ifam = <span class="string">'CycleQ1'</span>;
1107 ifamQ = <span class="string">'Q1'</span>;
1108 
1109 AO.(ifam).FamilyName             = ifam;
1110 AO.(ifam).MemberOf               = {ifam; <span class="string">'CycleQP'</span>; <span class="string">'Cyclage'</span>};
1111 AO.(ifam).Mode                   = Mode;
1112 dev = getfamilydata(ifamQ,<span class="string">'DeviceName'</span>);
1113 AO.(ifam).DeviceName             = regexprep(dev,<span class="string">'/Q'</span>,<span class="string">'/cycleQ'</span>);
1114 AO.(ifam).DeviceList             = family2dev(ifamQ);
1115 AO.(ifam).ElementList            = family2elem(ifamQ);
1116 <span class="comment">%add devices to group</span>
1117 AO.(ifam).GroupId                = tango_group_create(ifamQ); 
1118 tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName');
1119 nb = length(AO.(ifam).ElementList);
1120 <span class="comment">%AO.(ifam).Inom = 200.*ones(1,nb);</span>
1121 AO.(ifam).Imax = -249*ones(1,nb);
1122 AO.(ifam).Status = ones(nb,1);
1123 AO.(ifam).Monitor.Mode           = Mode;
1124 AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(nb,1);
1125 AO.(ifam).Monitor.DataType       = <span class="string">'Scalar'</span>;
1126 AO.(ifam).Monitor.Units          = <span class="string">'Hardware'</span>;
1127 AO.(ifam).Monitor.HWUnits        = <span class="string">'ampere'</span>;
1128 AO.(ifam).Monitor.PhysicsUnits   = <span class="string">'rad'</span>;
1129 AO.(ifam).Monitor.TangoNames   = strcat(AO.(ifam).DeviceName, <span class="string">'/totalProgression'</span>);
1130 
1131 <span class="comment">%% CYCLEQ2</span>
1132 ifam = <span class="string">'CycleQ2'</span>;
1133 ifamQ = <span class="string">'Q2'</span>;
1134 
1135 AO.(ifam).FamilyName             = ifam;
1136 AO.(ifam).MemberOf               = {ifam;<span class="string">'CycleQP'</span>; <span class="string">'Cyclage'</span>};
1137 AO.(ifam).Mode                   = Mode;
1138 AO.(ifam).GroupId                = tango_group_create(ifamQ); 
1139 dev = getfamilydata(ifamQ,<span class="string">'DeviceName'</span>);
1140 AO.(ifam).DeviceName             = regexprep(dev,<span class="string">'/Q'</span>,<span class="string">'/cycleQ'</span>);
1141 AO.(ifam).DeviceList             = family2dev(ifamQ);
1142 AO.(ifam).ElementList            = family2elem(ifamQ);
1143 <span class="comment">%add devices to group</span>
1144 tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName');
1145 nb = length(AO.(ifam).ElementList);
1146 <span class="comment">%AO.(ifam).Inom = 150*ones(1,nb);</span>
1147 AO.(ifam).Imax = 249*ones(1,nb);
1148 AO.(ifam).Status = ones(nb,1);
1149 AO.(ifam).Monitor.Mode           = Mode;
1150 AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(nb,1);
1151 AO.(ifam).Monitor.DataType       = <span class="string">'Scalar'</span>;
1152 AO.(ifam).Monitor.Units          = <span class="string">'Hardware'</span>;
1153 AO.(ifam).Monitor.HWUnits        = <span class="string">'ampere'</span>;
1154 AO.(ifam).Monitor.PhysicsUnits   = <span class="string">'rad'</span>;
1155 AO.(ifam).Monitor.TangoNames   = strcat(AO.(ifam).DeviceName, <span class="string">'/totalProgression'</span>);
1156 
1157 <span class="comment">%% CYCLEQ3</span>
1158 ifam = <span class="string">'CycleQ3'</span>;
1159 ifamQ = <span class="string">'Q3'</span>;
1160 
1161 AO.(ifam).FamilyName             = ifam;
1162 AO.(ifam).MemberOf               = {ifam;<span class="string">'CycleQP'</span>; <span class="string">'Cyclage'</span>};
1163 AO.(ifam).Mode                   = Mode;
1164 AO.(ifam).GroupId                = tango_group_create(ifamQ); 
1165 dev = getfamilydata(ifamQ,<span class="string">'DeviceName'</span>);
1166 AO.(ifam).DeviceName             = regexprep(dev,<span class="string">'/Q'</span>,<span class="string">'/cycleQ'</span>);
1167 AO.(ifam).DeviceList             = family2dev(ifamQ);
1168 AO.(ifam).ElementList            = family2elem(ifamQ);
1169 <span class="comment">%add devices to group</span>
1170 tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName');
1171 nb = length(AO.(ifam).ElementList);
1172 <span class="comment">%AO.(ifam).Inom = 150*ones(1,nb);</span>
1173 AO.(ifam).Imax = -249*ones(1,nb);
1174 AO.(ifam).Status = ones(nb,1);
1175 AO.(ifam).Monitor.Mode           = Mode;
1176 AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(nb,1);
1177 AO.(ifam).Monitor.DataType       = <span class="string">'Scalar'</span>;
1178 AO.(ifam).Monitor.Units          = <span class="string">'Hardware'</span>;
1179 AO.(ifam).Monitor.HWUnits        = <span class="string">'ampere'</span>;
1180 AO.(ifam).Monitor.PhysicsUnits   = <span class="string">'rad'</span>;
1181 AO.(ifam).Monitor.TangoNames   = strcat(AO.(ifam).DeviceName, <span class="string">'/totalProgression'</span>);
1182 
1183 <span class="comment">%% CYCLEQ4</span>
1184 ifam = <span class="string">'CycleQ4'</span>;
1185 ifamQ = <span class="string">'Q4'</span>;
1186 
1187 AO.(ifam).FamilyName             = ifam;
1188 AO.(ifam).MemberOf               = {ifam;<span class="string">'CycleQP'</span>; <span class="string">'Cyclage'</span>};
1189 AO.(ifam).Mode                   = Mode;
1190 AO.(ifam).GroupId                = tango_group_create(ifamQ); 
1191 dev = getfamilydata(ifamQ,<span class="string">'DeviceName'</span>);
1192 AO.(ifam).DeviceName             = regexprep(dev,<span class="string">'/Q'</span>,<span class="string">'/cycleQ'</span>);
1193 AO.(ifam).DeviceList             = family2dev(ifamQ);
1194 AO.(ifam).ElementList            = family2elem(ifamQ);
1195 <span class="comment">%add devices to group</span>
1196 tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName');
1197 nb = length(AO.(ifam).ElementList);
1198 <span class="comment">%AO.(ifam).Inom = 150*ones(1,nb);</span>
1199 AO.(ifam).Imax = -249*ones(1,nb);
1200 AO.(ifam).Status = ones(nb,1);
1201 AO.(ifam).Monitor.Mode           = Mode;
1202 AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(nb,1);
1203 AO.(ifam).Monitor.DataType       = <span class="string">'Scalar'</span>;
1204 AO.(ifam).Monitor.Units          = <span class="string">'Hardware'</span>;
1205 AO.(ifam).Monitor.HWUnits        = <span class="string">'ampere'</span>;
1206 AO.(ifam).Monitor.PhysicsUnits   = <span class="string">'rad'</span>;
1207 AO.(ifam).Monitor.TangoNames   = strcat(AO.(ifam).DeviceName, <span class="string">'/totalProgression'</span>);
1208 
1209 <span class="comment">%% CYCLEQ5</span>
1210 ifam = <span class="string">'CycleQ5'</span>;
1211 ifamQ = <span class="string">'Q5'</span>;
1212 
1213 AO.(ifam).FamilyName             = ifam;
1214 AO.(ifam).MemberOf               = {ifam;<span class="string">'CycleQP'</span>; <span class="string">'Cyclage'</span>};
1215 AO.(ifam).Mode                   = Mode;
1216 AO.(ifam).GroupId                = tango_group_create(ifamQ); 
1217 dev = getfamilydata(ifamQ,<span class="string">'DeviceName'</span>);
1218 AO.(ifam).DeviceName             = regexprep(dev,<span class="string">'/Q'</span>,<span class="string">'/cycleQ'</span>);
1219 AO.(ifam).DeviceList             = family2dev(ifamQ);
1220 AO.(ifam).ElementList            = family2elem(ifamQ);
1221 <span class="comment">%add devices to group</span>
1222 tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName');
1223 nb = length(AO.(ifam).ElementList);
1224 <span class="comment">%AO.(ifam).Inom = 150*ones(1,nb);</span>
1225 AO.(ifam).Imax = 249*ones(1,nb);
1226 AO.(ifam).Status = ones(nb,1);
1227 AO.(ifam).Monitor.Mode           = Mode;
1228 AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(nb,1);
1229 AO.(ifam).Monitor.DataType       = <span class="string">'Scalar'</span>;
1230 AO.(ifam).Monitor.Units          = <span class="string">'Hardware'</span>;
1231 AO.(ifam).Monitor.HWUnits        = <span class="string">'ampere'</span>;
1232 AO.(ifam).Monitor.PhysicsUnits   = <span class="string">'rad'</span>;
1233 AO.(ifam).Monitor.TangoNames   = strcat(AO.(ifam).DeviceName, <span class="string">'/totalProgression'</span>);
1234 
1235 <span class="comment">%% CYCLEQ6</span>
1236 ifam = <span class="string">'CycleQ6'</span>;
1237 ifamQ = <span class="string">'Q6'</span>;
1238 
1239 AO.(ifam).FamilyName             = ifam;
1240 AO.(ifam).MemberOf               = {ifam;<span class="string">'CycleQP'</span>; <span class="string">'Cyclage'</span>};
1241 AO.(ifam).Mode                   = Mode;
1242 AO.(ifam).GroupId                = tango_group_create(ifamQ); 
1243 dev = getfamilydata(ifamQ,<span class="string">'DeviceName'</span>);
1244 AO.(ifam).DeviceName             = regexprep(dev,<span class="string">'/Q'</span>,<span class="string">'/cycleQ'</span>);
1245 AO.(ifam).DeviceList             = family2dev(ifamQ);
1246 AO.(ifam).ElementList            = family2elem(ifamQ);
1247 <span class="comment">%add devices to group</span>
1248 tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName');
1249 nb = length(AO.(ifam).ElementList);
1250 <span class="comment">%AO.(ifam).Inom = 150*ones(1,nb);</span>
1251 AO.(ifam).Imax = -249*ones(1,nb);
1252 AO.(ifam).Status = ones(nb,1);
1253 AO.(ifam).Monitor.Mode           = Mode;
1254 AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(nb,1);
1255 AO.(ifam).Monitor.DataType       = <span class="string">'Scalar'</span>;
1256 AO.(ifam).Monitor.Units          = <span class="string">'Hardware'</span>;
1257 AO.(ifam).Monitor.HWUnits        = <span class="string">'ampere'</span>;
1258 AO.(ifam).Monitor.PhysicsUnits   = <span class="string">'rad'</span>;
1259 AO.(ifam).Monitor.TangoNames   = strcat(AO.(ifam).DeviceName, <span class="string">'/totalProgression'</span>);
1260 
1261 <span class="comment">%% CYCLEQ7</span>
1262 ifam = <span class="string">'CycleQ7'</span>;
1263 ifamQ = <span class="string">'Q7'</span>;
1264 
1265 AO.(ifam).FamilyName             = ifam;
1266 AO.(ifam).MemberOf               = {ifam;<span class="string">'CycleQP'</span>; <span class="string">'Cyclage'</span>};
1267 AO.(ifam).Mode                   = Mode;
1268 AO.(ifam).GroupId                = tango_group_create(ifamQ); 
1269 dev = getfamilydata(ifamQ,<span class="string">'DeviceName'</span>);
1270 AO.(ifam).DeviceName             = regexprep(dev,<span class="string">'/Q'</span>,<span class="string">'/cycleQ'</span>);
1271 AO.(ifam).DeviceList             = family2dev(ifamQ);
1272 AO.(ifam).ElementList            = family2elem(ifamQ);
1273 <span class="comment">%add devices to group</span>
1274 tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName');
1275 nb = length(AO.(ifam).ElementList);
1276 <span class="comment">%AO.(ifam).Inom = 150*ones(1,nb);</span>
1277 AO.(ifam).Imax = 249*ones(1,nb);
1278 AO.(ifam).Status = ones(nb,1);
1279 AO.(ifam).Monitor.Mode           = Mode;
1280 AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(nb,1);
1281 AO.(ifam).Monitor.DataType       = <span class="string">'Scalar'</span>;
1282 AO.(ifam).Monitor.Units          = <span class="string">'Hardware'</span>;
1283 AO.(ifam).Monitor.HWUnits        = <span class="string">'ampere'</span>;
1284 AO.(ifam).Monitor.PhysicsUnits   = <span class="string">'rad'</span>;
1285 AO.(ifam).Monitor.TangoNames   = strcat(AO.(ifam).DeviceName, <span class="string">'/totalProgression'</span>);
1286 
1287 <span class="comment">%% CYCLEQ8</span>
1288 ifam = <span class="string">'CycleQ8'</span>;
1289 ifamQ = <span class="string">'Q8'</span>;
1290 
1291 AO.(ifam).FamilyName             = ifam;
1292 AO.(ifam).MemberOf               = {ifam;<span class="string">'CycleQP'</span>; <span class="string">'Cyclage'</span>};
1293 AO.(ifam).Mode                   = Mode;
1294 AO.(ifam).GroupId                = tango_group_create(ifamQ); 
1295 dev = getfamilydata(ifamQ,<span class="string">'DeviceName'</span>);
1296 AO.(ifam).DeviceName             = regexprep(dev,<span class="string">'/Q'</span>,<span class="string">'/cycleQ'</span>);
1297 AO.(ifam).DeviceList             = family2dev(ifamQ);
1298 AO.(ifam).ElementList            = family2elem(ifamQ);
1299 <span class="comment">%add devices to group</span>
1300 tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName');
1301 nb = length(AO.(ifam).ElementList);
1302 <span class="comment">%AO.(ifam).Inom = 150*ones(1,nb);</span>
1303 AO.(ifam).Imax = -249*ones(1,nb);
1304 AO.(ifam).Status = ones(nb,1);
1305 AO.(ifam).Monitor.Mode           = Mode;
1306 AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(nb,1);
1307 AO.(ifam).Monitor.DataType       = <span class="string">'Scalar'</span>;
1308 AO.(ifam).Monitor.Units          = <span class="string">'Hardware'</span>;
1309 AO.(ifam).Monitor.HWUnits        = <span class="string">'ampere'</span>;
1310 AO.(ifam).Monitor.PhysicsUnits   = <span class="string">'rad'</span>;
1311 AO.(ifam).Monitor.TangoNames   = strcat(AO.(ifam).DeviceName, <span class="string">'/totalProgression'</span>);
1312 
1313 <span class="comment">%% CYCLEQ9</span>
1314 ifam = <span class="string">'CycleQ9'</span>;
1315 ifamQ = <span class="string">'Q9'</span>;
1316 
1317 AO.(ifam).FamilyName             = ifam;
1318 AO.(ifam).MemberOf               = {ifam;<span class="string">'CycleQP'</span>; <span class="string">'Cyclage'</span>};
1319 AO.(ifam).Mode                   = Mode;
1320 AO.(ifam).GroupId                = tango_group_create(ifamQ); 
1321 dev = getfamilydata(ifamQ,<span class="string">'DeviceName'</span>);
1322 AO.(ifam).DeviceName             = regexprep(dev,<span class="string">'/Q'</span>,<span class="string">'/cycleQ'</span>);
1323 AO.(ifam).DeviceList             = family2dev(ifamQ);
1324 AO.(ifam).ElementList            = family2elem(ifamQ);
1325 <span class="comment">%add devices to group</span>
1326 tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName');
1327 nb = length(AO.(ifam).ElementList);
1328 <span class="comment">%AO.(ifam).Inom = 150*ones(1,nb);</span>
1329 AO.(ifam).Imax = -249*ones(1,nb);
1330 AO.(ifam).Status = ones(nb,1);
1331 AO.(ifam).Monitor.Mode           = Mode;
1332 AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(nb,1);
1333 AO.(ifam).Monitor.DataType       = <span class="string">'Scalar'</span>;
1334 AO.(ifam).Monitor.Units          = <span class="string">'Hardware'</span>;
1335 AO.(ifam).Monitor.HWUnits        = <span class="string">'ampere'</span>;
1336 AO.(ifam).Monitor.PhysicsUnits   = <span class="string">'rad'</span>;
1337 AO.(ifam).Monitor.TangoNames   = strcat(AO.(ifam).DeviceName, <span class="string">'/totalProgression'</span>);
1338 
1339 <span class="comment">%% CYCLEQ10</span>
1340 ifam = <span class="string">'CycleQ10'</span>;
1341 ifamQ = <span class="string">'Q10'</span>;
1342 
1343 AO.(ifam).FamilyName             = ifam;
1344 AO.(ifam).MemberOf               = {ifam;<span class="string">'CycleQP'</span>; <span class="string">'Cyclage'</span>};
1345 AO.(ifam).Mode                   = Mode;
1346 AO.(ifam).GroupId                = tango_group_create(ifamQ); 
1347 dev = getfamilydata(ifamQ,<span class="string">'DeviceName'</span>);
1348 AO.(ifam).DeviceName             = regexprep(dev,<span class="string">'/Q'</span>,<span class="string">'/cycleQ'</span>);
1349 AO.(ifam).DeviceList             = family2dev(ifamQ);
1350 AO.(ifam).ElementList            = family2elem(ifamQ);
1351 <span class="comment">%add devices to group</span>
1352 tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName');
1353 nb = length(AO.(ifam).ElementList);
1354 <span class="comment">%AO.(ifam).Inom = 150*ones(1,nb);</span>
1355 AO.(ifam).Imax = 249*ones(1,nb);
1356 AO.(ifam).Status = ones(nb,1);
1357 AO.(ifam).Monitor.Mode           = Mode;
1358 AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(nb,1);
1359 AO.(ifam).Monitor.DataType       = <span class="string">'Scalar'</span>;
1360 AO.(ifam).Monitor.Units          = <span class="string">'Hardware'</span>;
1361 AO.(ifam).Monitor.HWUnits        = <span class="string">'ampere'</span>;
1362 AO.(ifam).Monitor.PhysicsUnits   = <span class="string">'rad'</span>;
1363 AO.(ifam).Monitor.TangoNames   = strcat(AO.(ifam).DeviceName, <span class="string">'/totalProgression'</span>);
1364 
1365 <span class="comment">%% CYCLEQC13</span>
1366 ifam = <span class="string">'CycleQC13'</span>;
1367 
1368 AO.(ifam).FamilyName             = ifam;
1369 AO.(ifam).MemberOf               = {ifam;<span class="string">'CycleQP'</span>; <span class="string">'Cyclage'</span>};
1370 AO.(ifam).Mode                   = Mode;
1371 AO.(ifam).GroupId                = tango_group_create(ifam); 
1372 <span class="comment">%dev = getfamilydata(ifamQ,'DeviceName');</span>
1373 AO.(ifam).DeviceName             = {<span class="string">'ANS-C13/AE/cycleQ1'</span>; <span class="string">'ANS-C13/AE/cycleQ2'</span>; <span class="string">'ANS-C13/AE/cycleQ3'</span>;  <span class="string">'ANS-C13/AE/cycleQ4.1'</span>; 
1374                                     <span class="string">'ANS-C13/AE/cycleQ5.1'</span>; <span class="string">'ANS-C13/AE/cycleQ5.2'</span>; <span class="string">'ANS-C13/AE/cycleQ4.2'</span>; <span class="keyword">...</span>
1375                                     <span class="string">'ANS-C13/AE/cycleQ6'</span>; <span class="string">'ANS-C13/AE/cycleQ7'</span>; <span class="string">'ANS-C13/AE/cycleQ8'</span> };
1376 AO.(ifam).DeviceList             = [13 1; 13 2; 13 3; 13 4; 13 5; 13 6; 13 7; 13 8; 13 9; 13 10];
1377 AO.(ifam).ElementList            = (1:10)';
1378 <span class="comment">%add devices to group</span>
1379 tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName');
1380 nb = length(AO.(ifam).ElementList);
1381 AO.(ifam).Imax = 249*[-1 1 -1 -1 1 1 -1 -1 1 -1];
1382 AO.(ifam).Status = ones(nb,1);
1383 AO.(ifam).Monitor.Mode           = Mode;
1384 AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(nb,1);
1385 AO.(ifam).Monitor.DataType       = <span class="string">'Scalar'</span>;
1386 AO.(ifam).Monitor.Units          = <span class="string">'Hardware'</span>;
1387 AO.(ifam).Monitor.HWUnits        = <span class="string">'ampere'</span>;
1388 AO.(ifam).Monitor.PhysicsUnits   = <span class="string">'rad'</span>;
1389 AO.(ifam).Monitor.TangoNames   = strcat(AO.(ifam).DeviceName, <span class="string">'/totalProgression'</span>);
1390 
1391 <span class="comment">%% cycleramp for sextupole magnets</span>
1392 <span class="comment">%% CYCLES1</span>
1393 ifam = <span class="string">'CycleS1'</span>;
1394 ifamQ = <span class="string">'S1'</span>;
1395 
1396 AO.(ifam).FamilyName             = ifam;
1397 AO.(ifam).MemberOf               = {ifam; <span class="string">'Cyclage'</span>};
1398 AO.(ifam).Mode                   = Mode;
1399 dev = getfamilydata(ifamQ,<span class="string">'DeviceName'</span>);
1400 AO.(ifam).DeviceName             = regexprep(dev,<span class="string">'/S'</span>,<span class="string">'/cycleS'</span>);
1401 AO.(ifam).DeviceList             = family2dev(ifamQ);
1402 AO.(ifam).ElementList            = family2elem(ifamQ);
1403 <span class="comment">%add devices to group</span>
1404 AO.(ifam).GroupId                = tango_group_create(ifamQ); 
1405 tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName');
1406 nb = length(AO.(ifam).ElementList);
1407 AO.(ifam).Imax = 349*ones(1,nb);
1408 AO.(ifam).Status = ones(nb,1);
1409 AO.(ifam).Monitor.Mode           = Mode;
1410 AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(nb,1);
1411 AO.(ifam).Monitor.DataType       = <span class="string">'Scalar'</span>;
1412 AO.(ifam).Monitor.Units          = <span class="string">'Hardware'</span>;
1413 AO.(ifam).Monitor.HWUnits        = <span class="string">'ampere'</span>;
1414 AO.(ifam).Monitor.PhysicsUnits   = <span class="string">'rad'</span>;
1415 AO.(ifam).Monitor.TangoNames   = strcat(AO.(ifam).DeviceName, <span class="string">'/totalProgression'</span>);
1416 
1417 <span class="comment">%% CYCLES2</span>
1418 ifam = <span class="string">'CycleS2'</span>;
1419 ifamQ = <span class="string">'S2'</span>;
1420 
1421 AO.(ifam).FamilyName             = ifam;
1422 AO.(ifam).MemberOf               = {ifam; <span class="string">'Cyclage'</span>};
1423 AO.(ifam).Mode                   = Mode;
1424 dev = getfamilydata(ifamQ,<span class="string">'DeviceName'</span>);
1425 AO.(ifam).DeviceName             = regexprep(dev,<span class="string">'/S'</span>,<span class="string">'/cycleS'</span>);
1426 AO.(ifam).DeviceList             = family2dev(ifamQ);
1427 AO.(ifam).ElementList            = family2elem(ifamQ);
1428 <span class="comment">%add devices to group</span>
1429 AO.(ifam).GroupId                = tango_group_create(ifamQ); 
1430 tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName');
1431 nb = length(AO.(ifam).ElementList);
1432 AO.(ifam).Imax = -349*ones(1,nb);
1433 AO.(ifam).Status = ones(nb,1);
1434 AO.(ifam).Monitor.Mode           = Mode;
1435 AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(nb,1);
1436 AO.(ifam).Monitor.DataType       = <span class="string">'Scalar'</span>;
1437 AO.(ifam).Monitor.Units          = <span class="string">'Hardware'</span>;
1438 AO.(ifam).Monitor.HWUnits        = <span class="string">'ampere'</span>;
1439 AO.(ifam).Monitor.PhysicsUnits   = <span class="string">'rad'</span>;
1440 AO.(ifam).Monitor.TangoNames   = strcat(AO.(ifam).DeviceName, <span class="string">'/totalProgression'</span>);
1441 
1442 <span class="comment">%% CYCLES3</span>
1443 ifam = <span class="string">'CycleS3'</span>;
1444 ifamQ = <span class="string">'S3'</span>;
1445 
1446 AO.(ifam).FamilyName             = ifam;
1447 AO.(ifam).MemberOf               = {ifam; <span class="string">'Cyclage'</span>};
1448 AO.(ifam).Mode                   = Mode;
1449 dev = getfamilydata(ifamQ,<span class="string">'DeviceName'</span>);
1450 AO.(ifam).DeviceName             = regexprep(dev,<span class="string">'/S'</span>,<span class="string">'/cycleS'</span>);
1451 AO.(ifam).DeviceList             = family2dev(ifamQ);
1452 AO.(ifam).ElementList            = family2elem(ifamQ);
1453 <span class="comment">%add devices to group</span>
1454 AO.(ifam).GroupId                = tango_group_create(ifamQ); 
1455 tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName');
1456 nb = length(AO.(ifam).ElementList);
1457 AO.(ifam).Imax = -349*ones(1,nb);
1458 AO.(ifam).Status = ones(nb,1);
1459 AO.(ifam).Monitor.Mode           = Mode;
1460 AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(nb,1);
1461 AO.(ifam).Monitor.DataType       = <span class="string">'Scalar'</span>;
1462 AO.(ifam).Monitor.Units          = <span class="string">'Hardware'</span>;
1463 AO.(ifam).Monitor.HWUnits        = <span class="string">'ampere'</span>;
1464 AO.(ifam).Monitor.PhysicsUnits   = <span class="string">'rad'</span>;
1465 AO.(ifam).Monitor.TangoNames   = strcat(AO.(ifam).DeviceName, <span class="string">'/totalProgression'</span>);
1466 
1467 <span class="comment">%% CYCLES4</span>
1468 ifam = <span class="string">'CycleS4'</span>;
1469 ifamQ = <span class="string">'S4'</span>;
1470 
1471 AO.(ifam).FamilyName             = ifam;
1472 AO.(ifam).MemberOf               = {ifam; <span class="string">'Cyclage'</span>};
1473 AO.(ifam).Mode                   = Mode;
1474 dev = getfamilydata(ifamQ,<span class="string">'DeviceName'</span>);
1475 AO.(ifam).DeviceName             = regexprep(dev,<span class="string">'/S'</span>,<span class="string">'/cycleS'</span>);
1476 AO.(ifam).DeviceList             = family2dev(ifamQ);
1477 AO.(ifam).ElementList            = family2elem(ifamQ);
1478 <span class="comment">%add devices to group</span>
1479 AO.(ifam).GroupId                = tango_group_create(ifamQ); 
1480 tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName');
1481 nb = length(AO.(ifam).ElementList);
1482 AO.(ifam).Imax = 349*ones(1,nb);
1483 AO.(ifam).Status = ones(nb,1);
1484 AO.(ifam).Monitor.Mode           = Mode;
1485 AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(nb,1);
1486 AO.(ifam).Monitor.DataType       = <span class="string">'Scalar'</span>;
1487 AO.(ifam).Monitor.Units          = <span class="string">'Hardware'</span>;
1488 AO.(ifam).Monitor.HWUnits        = <span class="string">'ampere'</span>;
1489 AO.(ifam).Monitor.PhysicsUnits   = <span class="string">'rad'</span>;
1490 AO.(ifam).Monitor.TangoNames   = strcat(AO.(ifam).DeviceName, <span class="string">'/totalProgression'</span>);
1491 
1492 <span class="comment">%% CYCLES5</span>
1493 ifam = <span class="string">'CycleS5'</span>;
1494 ifamQ = <span class="string">'S5'</span>;
1495 
1496 AO.(ifam).FamilyName             = ifam;
1497 AO.(ifam).MemberOf               = {ifam; <span class="string">'Cyclage'</span>};
1498 AO.(ifam).Mode                   = Mode;
1499 dev = getfamilydata(ifamQ,<span class="string">'DeviceName'</span>);
1500 AO.(ifam).DeviceName             = regexprep(dev,<span class="string">'/S'</span>,<span class="string">'/cycleS'</span>);
1501 AO.(ifam).DeviceList             = family2dev(ifamQ);
1502 AO.(ifam).ElementList            = family2elem(ifamQ);
1503 <span class="comment">%add devices to group</span>
1504 AO.(ifam).GroupId                = tango_group_create(ifamQ); 
1505 tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName');
1506 nb = length(AO.(ifam).ElementList);
1507 AO.(ifam).Imax = -349*ones(1,nb);
1508 AO.(ifam).Status = ones(nb,1);
1509 AO.(ifam).Monitor.Mode           = Mode;
1510 AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(nb,1);
1511 AO.(ifam).Monitor.DataType       = <span class="string">'Scalar'</span>;
1512 AO.(ifam).Monitor.Units          = <span class="string">'Hardware'</span>;
1513 AO.(ifam).Monitor.HWUnits        = <span class="string">'ampere'</span>;
1514 AO.(ifam).Monitor.PhysicsUnits   = <span class="string">'rad'</span>;
1515 AO.(ifam).Monitor.TangoNames   = strcat(AO.(ifam).DeviceName, <span class="string">'/totalProgression'</span>);
1516 
1517 <span class="comment">%% CYCLES6</span>
1518 ifam = <span class="string">'CycleS6'</span>;
1519 ifamQ = <span class="string">'S6'</span>;
1520 
1521 AO.(ifam).FamilyName             = ifam;
1522 AO.(ifam).MemberOf               = {ifam; <span class="string">'Cyclage'</span>};
1523 AO.(ifam).Mode                   = Mode;
1524 dev = getfamilydata(ifamQ,<span class="string">'DeviceName'</span>);
1525 AO.(ifam).DeviceName             = regexprep(dev,<span class="string">'/S'</span>,<span class="string">'/cycleS'</span>);
1526 AO.(ifam).DeviceList             = family2dev(ifamQ);
1527 AO.(ifam).ElementList            = family2elem(ifamQ);
1528 <span class="comment">%add devices to group</span>
1529 AO.(ifam).GroupId                = tango_group_create(ifamQ); 
1530 tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName');
1531 nb = length(AO.(ifam).ElementList);
1532 AO.(ifam).Imax = 349*ones(1,nb);
1533 AO.(ifam).Status = ones(nb,1);
1534 AO.(ifam).Monitor.Mode           = Mode;
1535 AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(nb,1);
1536 AO.(ifam).Monitor.DataType       = <span class="string">'Scalar'</span>;
1537 AO.(ifam).Monitor.Units          = <span class="string">'Hardware'</span>;
1538 AO.(ifam).Monitor.HWUnits        = <span class="string">'ampere'</span>;
1539 AO.(ifam).Monitor.PhysicsUnits   = <span class="string">'rad'</span>;
1540 AO.(ifam).Monitor.TangoNames   = strcat(AO.(ifam).DeviceName, <span class="string">'/totalProgression'</span>);
1541 
1542 <span class="comment">%% CYCLES7</span>
1543 ifam = <span class="string">'CycleS7'</span>;
1544 ifamQ = <span class="string">'S7'</span>;
1545 
1546 AO.(ifam).FamilyName             = ifam;
1547 AO.(ifam).MemberOf               = {ifam; <span class="string">'Cyclage'</span>};
1548 AO.(ifam).Mode                   = Mode;
1549 dev = getfamilydata(ifamQ,<span class="string">'DeviceName'</span>);
1550 AO.(ifam).DeviceName             = regexprep(dev,<span class="string">'/S'</span>,<span class="string">'/cycleS'</span>);
1551 AO.(ifam).DeviceList             = family2dev(ifamQ);
1552 AO.(ifam).ElementList            = family2elem(ifamQ);
1553 <span class="comment">%add devices to group</span>
1554 AO.(ifam).GroupId                = tango_group_create(ifamQ); 
1555 tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName');
1556 nb = length(AO.(ifam).ElementList);
1557 AO.(ifam).Imax = -349*ones(1,nb);
1558 AO.(ifam).Status = ones(nb,1);
1559 AO.(ifam).Monitor.Mode           = Mode;
1560 AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(nb,1);
1561 AO.(ifam).Monitor.DataType       = <span class="string">'Scalar'</span>;
1562 AO.(ifam).Monitor.Units          = <span class="string">'Hardware'</span>;
1563 AO.(ifam).Monitor.HWUnits        = <span class="string">'ampere'</span>;
1564 AO.(ifam).Monitor.PhysicsUnits   = <span class="string">'rad'</span>;
1565 AO.(ifam).Monitor.TangoNames   = strcat(AO.(ifam).DeviceName, <span class="string">'/totalProgression'</span>);
1566 
1567 <span class="comment">%% CYCLES8</span>
1568 ifam = <span class="string">'CycleS8'</span>;
1569 ifamQ = <span class="string">'S8'</span>;
1570 
1571 AO.(ifam).FamilyName             = ifam;
1572 AO.(ifam).MemberOf               = {ifam; <span class="string">'Cyclage'</span>};
1573 AO.(ifam).Mode                   = Mode;
1574 dev = getfamilydata(ifamQ,<span class="string">'DeviceName'</span>);
1575 AO.(ifam).DeviceName             = regexprep(dev,<span class="string">'/S'</span>,<span class="string">'/cycleS'</span>);
1576 AO.(ifam).DeviceList             = family2dev(ifamQ);
1577 AO.(ifam).ElementList            = family2elem(ifamQ);
1578 <span class="comment">%add devices to group</span>
1579 AO.(ifam).GroupId                = tango_group_create(ifamQ); 
1580 tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName');
1581 nb = length(AO.(ifam).ElementList);
1582 AO.(ifam).Imax = 349*ones(1,nb);
1583 AO.(ifam).Status = ones(nb,1);
1584 AO.(ifam).Monitor.Mode           = Mode;
1585 AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(nb,1);
1586 AO.(ifam).Monitor.DataType       = <span class="string">'Scalar'</span>;
1587 AO.(ifam).Monitor.Units          = <span class="string">'Hardware'</span>;
1588 AO.(ifam).Monitor.HWUnits        = <span class="string">'ampere'</span>;
1589 AO.(ifam).Monitor.PhysicsUnits   = <span class="string">'rad'</span>;
1590 AO.(ifam).Monitor.TangoNames   = strcat(AO.(ifam).DeviceName, <span class="string">'/totalProgression'</span>);
1591 
1592 <span class="comment">%% CYCLES9</span>
1593 ifam = <span class="string">'CycleS9'</span>;
1594 ifamQ = <span class="string">'S9'</span>;
1595 
1596 AO.(ifam).FamilyName             = ifam;
1597 AO.(ifam).MemberOf               = {ifam; <span class="string">'Cyclage'</span>};
1598 AO.(ifam).Mode                   = Mode;
1599 dev = getfamilydata(ifamQ,<span class="string">'DeviceName'</span>);
1600 AO.(ifam).DeviceName             = regexprep(dev,<span class="string">'/S'</span>,<span class="string">'/cycleS'</span>);
1601 AO.(ifam).DeviceList             = family2dev(ifamQ);
1602 AO.(ifam).ElementList            = family2elem(ifamQ);
1603 <span class="comment">%add devices to group</span>
1604 AO.(ifam).GroupId                = tango_group_create(ifamQ); 
1605 tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName');
1606 nb = length(AO.(ifam).ElementList);
1607 AO.(ifam).Imax = -349*ones(1,nb);
1608 AO.(ifam).Status = ones(nb,1);
1609 AO.(ifam).Monitor.Mode           = Mode;
1610 AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(nb,1);
1611 AO.(ifam).Monitor.DataType       = <span class="string">'Scalar'</span>;
1612 AO.(ifam).Monitor.Units          = <span class="string">'Hardware'</span>;
1613 AO.(ifam).Monitor.HWUnits        = <span class="string">'ampere'</span>;
1614 AO.(ifam).Monitor.PhysicsUnits   = <span class="string">'rad'</span>;
1615 AO.(ifam).Monitor.TangoNames   = strcat(AO.(ifam).DeviceName, <span class="string">'/totalProgression'</span>);
1616 
1617 <span class="comment">%% CYCLES10</span>
1618 ifam = <span class="string">'CycleS10'</span>;
1619 ifamQ = <span class="string">'S10'</span>;
1620 
1621 AO.(ifam).FamilyName             = ifam;
1622 AO.(ifam).MemberOf               = {ifam; <span class="string">'Cyclage'</span>};
1623 AO.(ifam).Mode                   = Mode;
1624 dev = getfamilydata(ifamQ,<span class="string">'DeviceName'</span>);
1625 AO.(ifam).DeviceName             = regexprep(dev,<span class="string">'/S'</span>,<span class="string">'/cycleS'</span>);
1626 AO.(ifam).DeviceList             = family2dev(ifamQ);
1627 AO.(ifam).ElementList            = family2elem(ifamQ);
1628 <span class="comment">%add devices to group</span>
1629 AO.(ifam).GroupId                = tango_group_create(ifamQ); 
1630 tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName');
1631 nb = length(AO.(ifam).ElementList);
1632 AO.(ifam).Imax = 349*ones(1,nb);
1633 AO.(ifam).Status = ones(nb,1);
1634 AO.(ifam).Monitor.Mode           = Mode;
1635 AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(nb,1);
1636 AO.(ifam).Monitor.DataType       = <span class="string">'Scalar'</span>;
1637 AO.(ifam).Monitor.Units          = <span class="string">'Hardware'</span>;
1638 AO.(ifam).Monitor.HWUnits        = <span class="string">'ampere'</span>;
1639 AO.(ifam).Monitor.PhysicsUnits   = <span class="string">'rad'</span>;
1640 AO.(ifam).Monitor.TangoNames   = strcat(AO.(ifam).DeviceName, <span class="string">'/totalProgression'</span>);
1641 
1642 <span class="comment">%============</span>
1643 <span class="comment">%% RF System</span>
1644 <span class="comment">%============</span>
1645 ifam = <span class="string">'RF'</span>;
1646 AO.(ifam).FamilyName                = ifam;
1647 AO.(ifam).FamilyType                = <span class="string">'RF'</span>;
1648 AO.(ifam).MemberOf                  = {<span class="string">'RF'</span>,<span class="string">'RFSystem'</span>};
1649 AO.(ifam).Status                    = 1;
1650 AO.(ifam).CommonNames               = <span class="string">'RF'</span>;
1651 AO.(ifam).DeviceList                = [1 1];
1652 AO.(ifam).ElementList               = 1;
1653 AO.(ifam).DeviceName(:,:)           = {<span class="string">'ANS/RF/MasterClock/'</span>};
1654 
1655 <span class="comment">%Frequency Readback</span>
1656 AO.(ifam).Monitor.Mode                = Mode;
1657 <span class="comment">% AO.(ifam).Monitor.Mode                = 'Special';</span>
1658 <span class="comment">% AO.(ifam).Monitor.SpecialFunctionGet = 'getrf2';</span>
1659 AO.(ifam).Monitor.DataType            = <span class="string">'Scalar'</span>;
1660 AO.(ifam).Monitor.Units               = <span class="string">'Hardware'</span>;
1661 AO.(ifam).Monitor.HW2PhysicsParams    = 1e+6;       <span class="comment">%no hw2physics function necessary</span>
1662 AO.(ifam).Monitor.Physics2HWParams    = 1e-6;
1663 AO.(ifam).Monitor.HWUnits             = <span class="string">'MHz'</span>;
1664 AO.(ifam).Monitor.PhysicsUnits        = <span class="string">'Hz'</span>;
1665 AO.(ifam).Monitor.TangoNames          = {<span class="string">'ANS/RF/MasterClock/frequency'</span>};
1666 AO.(ifam).Monitor.Handles             = NaN;
1667 AO.(ifam).Monitor.Range               = [351 353];
1668 
1669 AO.(ifam).Setpoint = AO.(ifam).Monitor;
1670 AO.(ifam).Desired  = AO.(ifam).Monitor;
1671 
1672 <span class="comment">%Voltage control</span>
1673 AO.(ifam).VoltageCtrl.Mode               = Mode;
1674 AO.(ifam).VoltageCtrl.DataType           = <span class="string">'Scalar'</span>;
1675 AO.(ifam).VoltageCtrl.Units              = <span class="string">'Hardware'</span>;
1676 AO.(ifam).VoltageCtrl.HW2PhysicsParams   = 1;
1677 AO.(ifam).VoltageCtrl.Physics2HWParams   = 1;
1678 AO.(ifam).VoltageCtrl.HWUnits            = <span class="string">'Volts'</span>;
1679 AO.(ifam).VoltageCtrl.PhysicsUnits       = <span class="string">'Volts'</span>;
1680 <span class="comment">% AO.(ifam).VoltageCtrl.ChannelNames       = 'SRF1:STN:VOLT:CTRL';</span>
1681 AO.(ifam).VoltageCtrl.TangoNames          = <span class="string">'ANS/DGsim/tracy/nux'</span>;
1682 AO.(ifam).VoltageCtrl.Range              = [-inf inf];
1683 AO.(ifam).VoltageCtrl.Tolerance          = inf;
1684 AO.(ifam).VoltageCtrl.Handles            = NaN;
1685 
1686 <span class="comment">%Voltage monitor</span>
1687 AO.(ifam).Voltage.Mode               = Mode;
1688 AO.(ifam).Voltage.DataType           = <span class="string">'Scalar'</span>;
1689 AO.(ifam).Voltage.Units              = <span class="string">'Hardware'</span>;
1690 AO.(ifam).Voltage.HW2PhysicsParams   = 1;
1691 AO.(ifam).Voltage.Physics2HWParams   = 1;
1692 AO.(ifam).Voltage.HWUnits            = <span class="string">'Volts'</span>;
1693 AO.(ifam).Voltage.PhysicsUnits       = <span class="string">'Volts'</span>;
1694 <span class="comment">% AO.(ifam).Voltage.ChannelNames       = 'SRF1:STN:VOLT';</span>
1695 AO.(ifam).Voltage.Range              = [-inf inf];
1696 AO.(ifam).Voltage.Tolerance          = inf;
1697 AO.(ifam).Voltage.Handles            = NaN;
1698 
1699 <span class="comment">% %Power Control</span>
1700 <span class="comment">% AO.(ifam).PowerCtrl.Mode               = Mode;</span>
1701 <span class="comment">% AO.(ifam).PowerCtrl.DataType           = 'Scalar';</span>
1702 <span class="comment">% AO.(ifam).PowerCtrl.Units              = 'Hardware';</span>
1703 <span class="comment">% AO.(ifam).PowerCtrl.HW2PhysicsParams   = 1;</span>
1704 <span class="comment">% AO.(ifam).PowerCtrl.Physics2HWParams   = 1;</span>
1705 <span class="comment">% AO.(ifam).PowerCtrl.HWUnits            = 'MWatts';</span>
1706 <span class="comment">% AO.(ifam).PowerCtrl.PhysicsUnits       = 'MWatts';</span>
1707 <span class="comment">% AO.(ifam).PowerCtrl.ChannelNames       = 'SRF1:KLYSDRIVFRWD:POWER:ON';</span>
1708 <span class="comment">% AO.(ifam).PowerCtrl.Range              = [-inf inf];</span>
1709 <span class="comment">% AO.(ifam).PowerCtrl.Tolerance          = inf;</span>
1710 <span class="comment">% AO.(ifam).PowerCtrl.Handles            = NaN;</span>
1711 <span class="comment">%</span>
1712 <span class="comment">% %Power Monitor</span>
1713 <span class="comment">% AO.(ifam).Power.Mode               = Mode;</span>
1714 <span class="comment">% AO.(ifam).Power.DataType           = 'Scalar';</span>
1715 <span class="comment">% AO.(ifam).Power.Units              = 'Hardware';</span>
1716 <span class="comment">% AO.(ifam).Power.HW2PhysicsParams   = 1;</span>
1717 <span class="comment">% AO.(ifam).Power.Physics2HWParams   = 1;</span>
1718 <span class="comment">% AO.(ifam).Power.HWUnits            = 'MWatts';</span>
1719 <span class="comment">% AO.(ifam).Power.PhysicsUnits       = 'MWatts';</span>
1720 <span class="comment">% AO.(ifam).Power.ChannelNames       = 'SRF1:KLYSDRIVFRWD:POWER';</span>
1721 <span class="comment">% AO.(ifam).Power.Range              = [-inf inf];</span>
1722 <span class="comment">% AO.(ifam).Power.Tolerance          = inf;</span>
1723 <span class="comment">% AO.(ifam).Power.Handles            = NaN;</span>
1724 <span class="comment">%</span>
1725 <span class="comment">% %Station Phase Control</span>
1726 <span class="comment">% AO.(ifam).PhaseCtrl.Mode               = Mode;</span>
1727 <span class="comment">% AO.(ifam).PhaseCtrl.DataType           = 'Scalar';</span>
1728 <span class="comment">% AO.(ifam).PhaseCtrl.Units              = 'Hardware';</span>
1729 <span class="comment">% AO.(ifam).PhaseCtrl.HW2PhysicsParams   = 1;</span>
1730 <span class="comment">% AO.(ifam).PhaseCtrl.Physics2HWParams   = 1;</span>
1731 <span class="comment">% AO.(ifam).PhaseCtrl.HWUnits            = 'Degrees';</span>
1732 <span class="comment">% AO.(ifam).PhaseCtrl.PhysicsUnits       = 'Degrees';</span>
1733 <span class="comment">% AO.(ifam).PhaseCtrl.ChannelNames       = 'SRF1:STN:PHASE';</span>
1734 <span class="comment">% AO.(ifam).PhaseCtrl.Range              = [-200 200];</span>
1735 <span class="comment">% AO.(ifam).PhaseCtrl.Tolerance          = inf;</span>
1736 <span class="comment">% AO.(ifam).PhaseCtrl.Handles            = NaN;</span>
1737 <span class="comment">%</span>
1738 <span class="comment">% %Station Phase Monitor</span>
1739 <span class="comment">% AO.(ifam).Phase.Mode               = Mode;</span>
1740 <span class="comment">% AO.(ifam).Phase.DataType           = 'Scalar';</span>
1741 <span class="comment">% AO.(ifam).Phase.Units              = 'Hardware';</span>
1742 <span class="comment">% AO.(ifam).Phase.HW2PhysicsParams   = 1;</span>
1743 <span class="comment">% AO.(ifam).Phase.Physics2HWParams   = 1;</span>
1744 <span class="comment">% AO.(ifam).Phase.HWUnits            = 'Degrees';</span>
1745 <span class="comment">% AO.(ifam).Phase.PhysicsUnits       = 'Degrees';</span>
1746 <span class="comment">% AO.(ifam).Phase.ChannelNames       = 'SRF1:STN:PHASE:CALC';</span>
1747 <span class="comment">% AO.(ifam).Phase.Range              = [-200 200];</span>
1748 <span class="comment">% AO.(ifam).Phase.Tolerance          = inf;</span>
1749 <span class="comment">% AO.(ifam).Phase.Handles            = NaN;</span>
1750 
1751 <span class="comment">%=======</span>
1752 <span class="comment">%% CHROMATICITIES: Soft Family</span>
1753 <span class="comment">%=======</span>
1754 ifam = <span class="string">'CHRO'</span>;
1755 AO.(ifam).FamilyName  = ifam;
1756 AO.(ifam).FamilyType  = <span class="string">'Diagnostic'</span>;
1757 AO.(ifam).MemberOf    = {<span class="string">'Diagnostics'</span>};
1758 AO.(ifam).CommonNames = [<span class="string">'xix'</span>;<span class="string">'xiz'</span>];
1759 AO.(ifam).DeviceList  = [ 1 1; 1 2;];
1760 AO.(ifam).ElementList = [1; 2];
1761 AO.(ifam).Status      = [1; 1];
1762 
1763 <span class="comment">%======</span>
1764 <span class="comment">%% Dipole B-FIELD from RMN probe</span>
1765 <span class="comment">%======</span>
1766 ifam = <span class="string">'RMN'</span>;
1767 AO.(ifam).FamilyName                     = ifam;
1768 AO.(ifam).FamilyType                     = <span class="string">'EM'</span>;
1769 AO.(ifam).MemberOf                       = {<span class="string">'EM'</span>,ifam};
1770 AO.(ifam).CommonNames                    = ifam;
1771 AO.(ifam).DeviceList                     = [1 1];
1772 AO.(ifam).ElementList                    = 1;
1773 AO.(ifam).Status                         = AO.(ifam).ElementList;
1774 
1775 AO.(ifam).Monitor.Mode                   = Mode;
1776 AO.(ifam).Monitor.DataType               = <span class="string">'Scalar'</span>;
1777 AO.(ifam).Monitor.TangoNames             = <span class="string">'ANS-C13/EM/RMN/magneticField'</span>; <span class="comment">%afin de ne pas avoir de bug</span>
1778 AO.(ifam).Monitor.Units                  = <span class="string">'Hardware'</span>;
1779 AO.(ifam).Monitor.Handles                = NaN;
1780 AO.(ifam).Monitor.HWUnits                = <span class="string">'mGauss'</span>;
1781 AO.(ifam).Monitor.PhysicsUnits           = <span class="string">'T'</span>;
1782 AO.(ifam).Monitor.HW2PhysicsParams       = 1;
1783 AO.(ifam).Monitor.Physics2HWParams       = 1;
1784 
1785 <span class="comment">%=======</span>
1786 <span class="comment">%% TUNE</span>
1787 <span class="comment">%=======</span>
1788 ifam = <span class="string">'TUNE'</span>;
1789 AO.(ifam).FamilyName  = ifam;
1790 AO.(ifam).FamilyType  = <span class="string">'Diagnostic'</span>;
1791 AO.(ifam).MemberOf    = {<span class="string">'Diagnostics'</span>};
1792 AO.(ifam).CommonNames = [<span class="string">'nux'</span>;<span class="string">'nuz'</span>;<span class="string">'nus'</span>];
1793 AO.(ifam).DeviceList  = [1 1; 1 2; 1 3];
1794 AO.(ifam).ElementList = [1 2 3]';
1795 AO.(ifam).Status      = [1 1 1]';
1796 
1797 AO.(ifam).Monitor.Mode                   = Mode; <span class="comment">%'Simulator';  % Mode;</span>
1798 AO.(ifam).Monitor.DataType               = <span class="string">'Scalar'</span>;
1799 AO.(ifam).Monitor.DataTypeIndex          = [1 2];
1800 AO.(ifam).Monitor.TangoNames             = [<span class="string">'ANS/DG/BPM-TUNEX/Nu'</span>;<span class="string">'ANS/DG/BPM-TUNEZ/Nu'</span>;<span class="string">'ANS/DG/BPM-TUNEZ/Nu'</span>];
1801 AO.(ifam).Monitor.Units                  = <span class="string">'Hardware'</span>;
1802 AO.(ifam).Monitor.Handles                = NaN;
1803 AO.(ifam).Monitor.HW2PhysicsParams       = 1;
1804 AO.(ifam).Monitor.Physics2HWParams       = 1;
1805 AO.(ifam).Monitor.HWUnits                = <span class="string">'fractional tune'</span>;
1806 AO.(ifam).Monitor.PhysicsUnits           = <span class="string">'fractional tune'</span>;
1807 
1808 
1809 <span class="comment">%======</span>
1810 <span class="comment">%% DCCT</span>
1811 <span class="comment">%======</span>
1812 ifam = <span class="string">'DCCT'</span>;
1813 AO.(ifam).FamilyName                     = ifam;
1814 AO.(ifam).FamilyType                     = <span class="string">'Diagnostic'</span>;
1815 AO.(ifam).MemberOf                       = {<span class="string">'Diagnostics'</span>,<span class="string">'DCCT'</span>};
1816 AO.(ifam).CommonNames                    = <span class="string">'DCCT'</span>;
1817 AO.(ifam).DeviceList                     = [1 1];
1818 AO.(ifam).ElementList                    = 1;
1819 AO.(ifam).Status                         = AO.(ifam).ElementList;
1820 
1821 AO.(ifam).Monitor.Mode                   = Mode;
1822 AO.(ifam).FamilyName                     = <span class="string">'DCCT'</span>;
1823 AO.(ifam).Monitor.DataType               = <span class="string">'Scalar'</span>;
1824 AO.(ifam).Monitor.TangoNames             = <span class="string">'ANS-C03/DG/DCCT/current'</span>; <span class="comment">%afin de ne pas avoir de bug</span>
1825 AO.(ifam).Monitor.Units                  = <span class="string">'Hardware'</span>;
1826 AO.(ifam).Monitor.Handles                = NaN;
1827 AO.(ifam).Monitor.HWUnits                = <span class="string">'mA'</span>;
1828 AO.(ifam).Monitor.PhysicsUnits           = <span class="string">'A'</span>;
1829 AO.(ifam).Monitor.HW2PhysicsParams       = 1;
1830 AO.(ifam).Monitor.Physics2HWParams       = 1;
1831 
1832 <span class="comment">% On une famille ???</span>
1833 ifam = <span class="string">'DCCT1'</span>;
1834 AO.(ifam).FamilyName                     = ifam;
1835 AO.(ifam).FamilyType                     = <span class="string">'Diagnostic'</span>;
1836 AO.(ifam).MemberOf                       = {<span class="string">'Diagnostics'</span>,<span class="string">'DCCT'</span>};
1837 AO.(ifam).CommonNames                    = <span class="string">'DCCT1'</span>;
1838 AO.(ifam).DeviceList                     = [1 1];
1839 AO.(ifam).ElementList                    = 1;
1840 AO.(ifam).Status                         = AO.(ifam).ElementList;
1841 
1842 AO.(ifam).Monitor.Mode                   = Mode;
1843 AO.(ifam).FamilyName                     = <span class="string">'DCCT'</span>;
1844 AO.(ifam).Monitor.DataType               = <span class="string">'Scalar'</span>;
1845 AO.(ifam).Monitor.TangoNames              = <span class="string">'ANS-C03/DG/DCCT/current'</span>; <span class="comment">%afin de ne pas avoir de bug</span>
1846 AO.(ifam).Monitor.Units                  = <span class="string">'Hardware'</span>;
1847 AO.(ifam).Monitor.Handles                = NaN;
1848 AO.(ifam).Monitor.HWUnits                = <span class="string">'mA'</span>;
1849 AO.(ifam).Monitor.PhysicsUnits           = <span class="string">'A'</span>;
1850 AO.(ifam).Monitor.HW2PhysicsParams       = 1;
1851 AO.(ifam).Monitor.Physics2HWParams       = 1;
1852 
1853 ifam = <span class="string">'DCCT2'</span>;
1854 AO.(ifam).FamilyName                     = ifam;
1855 AO.(ifam).FamilyType                     = <span class="string">'Diagnostic'</span>;
1856 AO.(ifam).MemberOf                       = {<span class="string">'Diagnostics'</span>,<span class="string">'DCCT'</span>};
1857 AO.(ifam).CommonNames                    = <span class="string">'ANS-C14/DG/DCCT'</span>;
1858 AO.(ifam).DeviceList                     = [1 1];
1859 AO.(ifam).ElementList                    = 1;
1860 AO.(ifam).Status                         = AO.(ifam).ElementList;
1861 
1862 AO.(ifam).Monitor.Mode                   = Mode;
1863 AO.(ifam).FamilyName                     = <span class="string">'DCCT'</span>;
1864 AO.(ifam).Monitor.DataType               = <span class="string">'Scalar'</span>;
1865 AO.(ifam).Monitor.TangoNames             = <span class="string">'ANS-C03/DG/DCCT/current'</span>; <span class="comment">%afin de ne pas avoir de bug</span>
1866 AO.(ifam).Monitor.Units                  = <span class="string">'Hardware'</span>;
1867 AO.(ifam).Monitor.Handles                = NaN;
1868 AO.(ifam).Monitor.HWUnits                = <span class="string">'mA'</span>;
1869 AO.(ifam).Monitor.PhysicsUnits           = <span class="string">'A'</span>;
1870 AO.(ifam).Monitor.HW2PhysicsParams       = 1;
1871 AO.(ifam).Monitor.Physics2HWParams       = 1;
1872 
1873 ifam = <span class="string">'LifeTime'</span>;
1874 AO.(ifam).FamilyName                     = ifam;
1875 AO.(ifam).FamilyType                     = <span class="string">'Diagnostic'</span>;
1876 AO.(ifam).MemberOf                       = {<span class="string">'Diagnostics'</span>,<span class="string">'DCCT'</span>};
1877 AO.(ifam).CommonNames                    = <span class="string">'DCCT'</span>;
1878 AO.(ifam).DeviceList                     = [1 1];
1879 AO.(ifam).ElementList                    = 1;
1880 AO.(ifam).Status                         = AO.(ifam).ElementList;
1881 
1882 AO.(ifam).Monitor.Mode                   = Mode;
1883 AO.(ifam).FamilyName                     = <span class="string">'DCCT'</span>;
1884 AO.(ifam).Monitor.DataType               = <span class="string">'Scalar'</span>;
1885 AO.(ifam).Monitor.TangoNames             = <span class="string">'ANS-C03/DG/DCCT/lifeTime'</span>; <span class="comment">%afin de ne pas avoir de bug</span>
1886 AO.(ifam).Monitor.Units                  = <span class="string">'Hardware'</span>;
1887 AO.(ifam).Monitor.Handles                = NaN;
1888 AO.(ifam).Monitor.HWUnits                = <span class="string">'Hours'</span>;
1889 AO.(ifam).Monitor.PhysicsUnits           = <span class="string">'Hours'</span>;
1890 AO.(ifam).Monitor.HW2PhysicsParams       = 1;
1891 AO.(ifam).Monitor.Physics2HWParams       = 1;
1892 
1893 
1894 <span class="comment">% %% cycleramp For quadrupoles magnets</span>
1895 <span class="comment">% ifam = 'CycleQP';</span>
1896 <span class="comment">%</span>
1897 <span class="comment">% AO.(ifam).FamilyName             = ifam;</span>
1898 <span class="comment">% AO.(ifam).MemberOf               = {'CycleQP'; 'Cyclage'};</span>
1899 <span class="comment">% AO.(ifam).Mode                   = Mode;</span>
1900 <span class="comment">% AO.(ifam).GroupId                = tango_group_create('Quadrupole');</span>
1901 <span class="comment">% AO.(ifam).DeviceList             = [1 1; 1 2; 1 3; 1 4; 1 5; 1 6; 1 7];</span>
1902 <span class="comment">% AO.(ifam).ElementList            = (1:7)';</span>
1903 <span class="comment">% AO.(ifam).DeviceName             = {'LT1/AE/cycleQ.1';'LT1/AE/cycleQ.2'; ...</span>
1904 <span class="comment">%                                     'LT1/AE/cycleQ.3';'LT1/AE/cycleQ.4'; ...</span>
1905 <span class="comment">%                                     'LT1/AE/cycleQ.5';'LT1/AE/cycleQ.6'; ...</span>
1906 <span class="comment">%                                     'LT1/AE/cycleQ.7'};</span>
1907 <span class="comment">% %add devices to group</span>
1908 <span class="comment">% tango_group_add(AO.(ifam).GroupId, AO.(ifam).DeviceName');</span>
1909 <span class="comment">% %AO.(ifam).Imax = 8*ones(1,7);</span>
1910 <span class="comment">% % modification mars 2006</span>
1911 <span class="comment">% AO.(ifam).Imax = [8  -8  -8  8  8  -8  8 ];</span>
1912 <span class="comment">% AO.(ifam).Status = ones(7,1);</span>
1913 <span class="comment">% AO.(ifam).Monitor.Mode           = Mode;</span>
1914 <span class="comment">% AO.(ifam).Monitor.Handles(:,1)   = NaN*ones(7,1);</span>
1915 <span class="comment">% AO.(ifam).Monitor.DataType       = 'Scalar';</span>
1916 <span class="comment">% AO.(ifam).Monitor.Units          = 'Hardware';</span>
1917 <span class="comment">% AO.(ifam).Monitor.HWUnits        = 'ampere';</span>
1918 <span class="comment">% AO.(ifam).Monitor.PhysicsUnits   = 'rad';</span>
1919 <span class="comment">% AO.(ifam).Monitor.TangoNames   = strcat(AO.(ifam).DeviceName, '/totalProgression');</span>
1920 
1921 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
1922 <span class="comment">%% Alignment</span>
1923 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
1924 
1925 disp(<span class="string">'aligment configuration ...'</span>)
1926 
1927 <span class="comment">%% HLS</span>
1928 ifam = <span class="string">'HLS'</span>;
1929 AO.(ifam).FamilyName           = ifam;
1930 AO.(ifam).FamilyType           = ifam;
1931 AO.(ifam).MemberOf             = {<span class="string">'PlotFamily'</span>; <span class="string">'Alignment'</span>; <span class="string">'HLS'</span>; <span class="string">'Archivable'</span>};
1932 AO.(ifam).Monitor.Mode         = Mode;
1933 AO.(ifam).Monitor.DataType     = <span class="string">'Scalar'</span>;
1934 
1935 map       = tango_get_db_property(<span class="string">'anneau'</span>,<span class="string">'HLS'</span>);
1936 cellindex = cell2mat(regexpi(map,<span class="string">'C[0-9]'</span>,<span class="string">'once'</span>))+1;
1937 <span class="comment">%numindex  = cell2mat(regexpi(map,'\.[0-9]','once'))+1;</span>
1938 
1939 <span class="comment">% builds up devicelist</span>
1940 nb = size(map,2);
1941 ik = 0; cellnum = 1;
1942 <span class="keyword">for</span> k = 1:nb,
1943     <span class="keyword">if</span> cellnum - str2double(map{k}(cellindex(k):cellindex(k)+1)) ~=0
1944         ik = 1;
1945     <span class="keyword">else</span>
1946         ik = ik+1;
1947     <span class="keyword">end</span>
1948     cellnum = str2double(map{k}(cellindex(k):cellindex(k)+1));
1949     AO.(ifam).DeviceList(k,:)  = [cellnum ik];
1950     AO.(ifam).CommonNames(k,:)      = map{k}(12:17);
1951 <span class="keyword">end</span>
1952 
1953 AO.(ifam).ElementList = (1:nb)';
1954 
1955 AO.(ifam).Status                   = ones(nb,1);
1956 AO.(ifam).DeviceName               = map';
1957 AO.(ifam).ElementList              = (1:nb)';
1958 AO.(ifam).Monitor.Handles(:,1)     = NaN*ones(nb,1);
1959 AO.(ifam).Monitor.TangoNames       = strcat(AO.(ifam).DeviceName, <span class="string">'/average'</span>);
1960 AO.(ifam).Monitor.HW2PhysicsParams = 1;
1961 AO.(ifam).Monitor.Physics2HWParams = 1;
1962 AO.(ifam).Monitor.Units            = <span class="string">'Hardware'</span>;   
1963 AO.(ifam).Monitor.HWUnits          = <span class="string">'mm'</span>;
1964 AO.(ifam).Monitor.PhysicsUnits     = <span class="string">'m'</span>;
1965 
1966 
1967 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
1968 <span class="comment">%% VACUUM SYSTEM</span>
1969 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
1970 
1971 disp(<span class="string">'vacuum configuration ...'</span>)
1972 
1973 <span class="comment">%% IonPump</span>
1974 ifam = <span class="string">'PI'</span>;
1975 AO.(ifam).FamilyName           = <span class="string">'PI'</span>;
1976 AO.(ifam).FamilyType           = <span class="string">'PI'</span>;
1977 AO.(ifam).MemberOf             = {<span class="string">'PlotFamily'</span>; <span class="string">'IonPump'</span>; <span class="string">'Pressure'</span>; <span class="string">'Archivable'</span>;<span class="string">'PlotFamily'</span>};
1978 AO.(ifam).Monitor.Mode         = Mode;
1979 AO.(ifam).Monitor.DataType     = <span class="string">'Scalar'</span>;
1980 
1981 map       = tango_get_db_property(<span class="string">'anneau'</span>,<span class="string">'pompe_ionique'</span>);
1982 cellindex = cell2mat(regexpi(map,<span class="string">'C[0-9]'</span>,<span class="string">'once'</span>))+1;
1983 numindex  = cell2mat(regexpi(map,<span class="string">'\.[0-9]'</span>,<span class="string">'once'</span>))+1;
1984 
1985 
1986 nb = size(map,2);
1987 <span class="keyword">for</span> k = 1:nb,
1988     AO.(ifam).DeviceList(k,:)  = [str2double(map{k}(cellindex(k):cellindex(k)+1)) str2double(map{k}(numindex(k):end))];
1989 <span class="keyword">end</span>
1990 
1991 AO.(ifam).ElementList = (1:nb)';
1992 
1993 
1994 AO.(ifam).Status                   = ones(nb,1);
1995 AO.(ifam).DeviceName               = map';
1996 AO.(ifam).CommonNames              = [repmat(<span class="string">'PI'</span>,nb,1) num2str((1:nb)',<span class="string">'%02d'</span>)];
1997 AO.(ifam).ElementList              = (1:nb)';
1998 AO.(ifam).Monitor.Handles(:,1)     = NaN*ones(nb,1);
1999 AO.(ifam).Monitor.TangoNames       = strcat(AO.(ifam).DeviceName, <span class="string">'/pressure'</span>);
2000 AO.(ifam).Monitor.HW2PhysicsParams = 1;
2001 AO.(ifam).Monitor.Physics2HWParams = 1;
2002 AO.(ifam).Monitor.Units            = <span class="string">'Hardware'</span>;   
2003 AO.(ifam).Monitor.HWUnits          = <span class="string">'mbar'</span>;
2004 AO.(ifam).Monitor.PhysicsUnits     = <span class="string">'mbar'</span>;
2005 
2006 <span class="comment">%% Penning Gauges</span>
2007 ifam = <span class="string">'JPEN'</span>;
2008 AO.(ifam).FamilyName           = <span class="string">'JPEN'</span>;
2009 AO.(ifam).MemberOf             = {<span class="string">'PlotFamily'</span>; <span class="string">'PenningGauge'</span>; <span class="string">'Pressure'</span>; <span class="string">'Archivable'</span>;<span class="string">'PlotFamily'</span>};
2010 AO.(ifam).Monitor.Mode         = Mode;
2011 AO.(ifam).Monitor.DataType     = <span class="string">'Scalar'</span>;
2012 
2013 map     = tango_get_db_property(<span class="string">'anneau'</span>,<span class="string">'jauge_penning'</span>);
2014 cellindex = cell2mat(regexpi(map,<span class="string">'C[0-9]'</span>,<span class="string">'once'</span>))+1;
2015 numindex  = cell2mat(regexpi(map,<span class="string">'\.[0-9]'</span>,<span class="string">'once'</span>))+1;
2016 
2017 nb = size(map,2);
2018 <span class="keyword">for</span> k = 1:nb,
2019     AO.(ifam).DeviceList(k,:)  = [str2double(map{k}(cellindex(k):cellindex(k)+1)) str2double(map{k}(numindex(k):end))];
2020 <span class="keyword">end</span>
2021 
2022 AO.(ifam).ElementList = (1:nb)';
2023 
2024 AO.(ifam).Status                   = ones(nb,1);
2025 AO.(ifam).DeviceName               = map';
2026 AO.(ifam).CommonNames              = [repmat(<span class="string">'JPEN'</span>,nb,1) num2str((1:nb)',<span class="string">'%02d'</span>)];
2027 AO.(ifam).ElementList              = (1:nb)';
2028 AO.(ifam).Monitor.Handles(:,1)     = NaN*ones(nb,1);
2029 AO.(ifam).Monitor.TangoNames       = strcat(AO.(ifam).DeviceName, <span class="string">'/pressure'</span>);
2030 AO.(ifam).Monitor.HW2PhysicsParams = 1;
2031 AO.(ifam).Monitor.Physics2HWParams = 1;
2032 AO.(ifam).Monitor.Units            = <span class="string">'Hardware'</span>;   
2033 AO.(ifam).Monitor.HWUnits          = <span class="string">'mbar'</span>;
2034 AO.(ifam).Monitor.PhysicsUnits     = <span class="string">'mbar'</span>;
2035 
2036 <span class="comment">%% Pirani Gauges</span>
2037 ifam = <span class="string">'JPIR'</span>;
2038 AO.(ifam).FamilyName           = <span class="string">'JPIR'</span>;
2039 AO.(ifam).MemberOf             = {<span class="string">'PlotFamily'</span>; <span class="string">'PiraniGauge'</span>; <span class="string">'Pressure'</span>; <span class="string">'Archivable'</span>;<span class="string">'PlotFamily'</span>};
2040 AO.(ifam).Monitor.Mode         = Mode;
2041 AO.(ifam).Monitor.DataType     = <span class="string">'Scalar'</span>;
2042 
2043 map     = tango_get_db_property(<span class="string">'anneau'</span>,<span class="string">'jauge_piranni'</span>);
2044 cellindex = cell2mat(regexpi(map,<span class="string">'C[0-9]'</span>,<span class="string">'once'</span>))+1;
2045 numindex  = cell2mat(regexpi(map,<span class="string">'\.[0-9]'</span>,<span class="string">'once'</span>))+1;
2046 
2047 nb = size(map,2);
2048 <span class="keyword">for</span> k = 1:nb,
2049     AO.(ifam).DeviceList(k,:)  = [str2double(map{k}(cellindex(k):cellindex(k)+1)) str2double(map{k}(numindex(k):end))];
2050 <span class="keyword">end</span>
2051 
2052 AO.(ifam).Status                   = ones(nb,1);
2053 AO.(ifam).DeviceName               = map';
2054 AO.(ifam).CommonNames              = [repmat(<span class="string">'JPIR'</span>,nb,1) num2str((1:nb)',<span class="string">'%02d'</span>)];
2055 AO.(ifam).ElementList              = (1:nb)';
2056 AO.(ifam).Monitor.Handles(:,1)     = NaN*ones(nb,1);
2057 AO.(ifam).Monitor.TangoNames       = strcat(AO.(ifam).DeviceName, <span class="string">'/pressure'</span>);
2058 AO.(ifam).Monitor.HW2PhysicsParams = 1;
2059 AO.(ifam).Monitor.Physics2HWParams = 1;
2060 AO.(ifam).Monitor.Units            = <span class="string">'Hardware'</span>;   
2061 AO.(ifam).Monitor.HWUnits          = <span class="string">'mbar'</span>;
2062 AO.(ifam).Monitor.PhysicsUnits     = <span class="string">'mbar'</span>;
2063 
2064 <span class="comment">%% Bayer Albert Gauges</span>
2065 ifam = <span class="string">'JBA'</span>;
2066 AO.(ifam).FamilyName           = ifam;
2067 AO.(ifam).MemberOf             = {<span class="string">'PlotFamily'</span>; <span class="string">'PiraniGauge'</span>; <span class="string">'Pressure'</span>; <span class="string">'Archivable'</span>;<span class="string">'PlotFamily'</span>};
2068 AO.(ifam).Monitor.Mode         = Mode;
2069 AO.(ifam).Monitor.DataType     = <span class="string">'Scalar'</span>;
2070 
2071 map     = tango_get_db_property(<span class="string">'anneau'</span>,<span class="string">'jauge_bayer_alpert'</span>);
2072 cellindex = cell2mat(regexpi(map,<span class="string">'C[0-9]'</span>,<span class="string">'once'</span>))+1;
2073 numindex  = cell2mat(regexpi(map,<span class="string">'\.[0-9]'</span>,<span class="string">'once'</span>))+1;
2074 
2075 nb = size(map,2);
2076 <span class="keyword">for</span> k = 1:nb,
2077     AO.(ifam).DeviceList(k,:)  = [str2double(map{k}(cellindex(k):cellindex(k)+1)) str2double(map{k}(numindex(k):end))];
2078 <span class="keyword">end</span>
2079 
2080 AO.(ifam).Status                   = ones(nb,1);
2081 AO.(ifam).DeviceName               = map';
2082 AO.(ifam).CommonNames              = [repmat(ifam,nb,1) num2str((1:nb)',<span class="string">'%02d'</span>)];
2083 AO.(ifam).ElementList              = (1:nb)';
2084 AO.(ifam).Monitor.Handles(:,1)     = NaN*ones(nb,1);
2085 AO.(ifam).Monitor.TangoNames       = strcat(AO.(ifam).DeviceName, <span class="string">'/pressure'</span>);
2086 AO.(ifam).Monitor.HW2PhysicsParams = 1;
2087 AO.(ifam).Monitor.Physics2HWParams = 1;
2088 AO.(ifam).Monitor.Units            = <span class="string">'Hardware'</span>;   
2089 AO.(ifam).Monitor.HWUnits          = <span class="string">'mbar'</span>;
2090 AO.(ifam).Monitor.PhysicsUnits     = <span class="string">'mbar'</span>;
2091 
2092 
2093 <span class="comment">%% Thermocouples</span>
2094 ifam = <span class="string">'TC'</span>;
2095 AO.(ifam).FamilyName           = ifam;
2096 AO.(ifam).MemberOf             = {<span class="string">'PlotFamily'</span>; <span class="string">'PiraniGauge'</span>; <span class="string">'Pressure'</span>; <span class="string">'Archivable'</span>;<span class="string">'PlotFamily'</span>};
2097 AO.(ifam).Monitor.Mode         = Mode;
2098 AO.(ifam).Monitor.DataType     = <span class="string">'Scalar'</span>;
2099 
2100 map     = tango_get_db_property(<span class="string">'anneau'</span>,<span class="string">'thermocouple'</span>);
2101 cellindex = cell2mat(regexpi(map,<span class="string">'C[0-9]'</span>,<span class="string">'once'</span>))+1;
2102 numindex  = cell2mat(regexpi(map,<span class="string">'\.[0-9]'</span>,<span class="string">'once'</span>))+1;
2103 
2104 nb = size(map,2);
2105 <span class="keyword">for</span> k = 1:nb,
2106     AO.(ifam).DeviceList(k,:)  = [str2double(map{k}(cellindex(k):cellindex(k)+1)) str2double(map{k}(numindex(k):end))];
2107 <span class="keyword">end</span>
2108 
2109 AO.(ifam).Status                   = ones(nb,1);
2110 AO.(ifam).DeviceName               = map';
2111 AO.(ifam).CommonNames              = [repmat(ifam,nb,1) num2str((1:nb)',<span class="string">'%02d'</span>)];
2112 AO.(ifam).ElementList              = (1:nb)';
2113 AO.(ifam).Monitor.Handles(:,1)     = NaN*ones(nb,1);
2114 AO.(ifam).Monitor.TangoNames       = strcat(AO.(ifam).DeviceName, <span class="string">'/temperature'</span>);
2115 AO.(ifam).Monitor.HW2PhysicsParams = 1;
2116 AO.(ifam).Monitor.Physics2HWParams = 1;
2117 AO.(ifam).Monitor.Units            = <span class="string">'Hardware'</span>;   
2118 AO.(ifam).Monitor.HWUnits          = <span class="string">'°C'</span>;
2119 AO.(ifam).Monitor.PhysicsUnits     = <span class="string">'°C'</span>;
2120 
2121 <span class="comment">%% DEBIMETRES</span>
2122 ifam = <span class="string">'DEB'</span>;
2123 AO.(ifam).FamilyName           = ifam;
2124 AO.(ifam).MemberOf             = {<span class="string">'Vaccuum'</span>};
2125 AO.(ifam).Monitor.Mode         = Mode;
2126 AO.(ifam).Monitor.DataType     = <span class="string">'Scalar'</span>;
2127 
2128 map     = tango_get_db_property(<span class="string">'anneau'</span>,<span class="string">'debitmetre'</span>);
2129 cellindex = cell2mat(regexpi(map,<span class="string">'C[0-9]'</span>,<span class="string">'once'</span>))+1;
2130 numindex  = cell2mat(regexpi(map,<span class="string">'\.[0-9]'</span>,<span class="string">'once'</span>))+1;
2131 
2132 nb = size(map,2);
2133 <span class="keyword">for</span> k = 1:nb,
2134     AO.(ifam).DeviceList(k,:)  = [str2double(map{k}(cellindex(k):cellindex(k)+1)) str2double(map{k}(numindex(k):end))];
2135 <span class="keyword">end</span>
2136 
2137 AO.(ifam).Status                   = ones(nb,1);
2138 AO.(ifam).DeviceName               = map';
2139 AO.(ifam).CommonNames              = [repmat(ifam,nb,1) num2str((1:nb)',<span class="string">'%02d'</span>)];
2140 AO.(ifam).ElementList              = (1:nb)';
2141 AO.(ifam).Monitor.Handles(:,1)     = NaN*ones(nb,1);
2142 AO.(ifam).Monitor.TangoNames       = strcat(AO.(ifam).DeviceName, <span class="string">'/temperature'</span>);
2143 AO.(ifam).Monitor.HW2PhysicsParams = 1;
2144 AO.(ifam).Monitor.Physics2HWParams = 1;
2145 AO.(ifam).Monitor.Units            = <span class="string">'Hardware'</span>;   
2146 AO.(ifam).Monitor.HWUnits          = <span class="string">'au'</span>;
2147 AO.(ifam).Monitor.PhysicsUnits     = <span class="string">'au'</span>;
2148 
2149 <span class="comment">%% VM</span>
2150 ifam = <span class="string">'VM'</span>;
2151 AO.(ifam).FamilyName           = ifam;
2152 AO.(ifam).MemberOf             = {<span class="string">'PlotFamily'</span>; <span class="string">'Vaccuum'</span>; <span class="string">'Archivable'</span>;<span class="string">'PlotFamily'</span>};
2153 AO.(ifam).Monitor.Mode         = Mode;
2154 AO.(ifam).Monitor.DataType     = <span class="string">'Scalar'</span>;
2155 
2156 map     = tango_get_db_property(<span class="string">'anneau'</span>,<span class="string">'vanne_manuelle'</span>);
2157 cellindex = cell2mat(regexpi(map,<span class="string">'C[0-9]'</span>,<span class="string">'once'</span>))+1;
2158 numindex  = cell2mat(regexpi(map,<span class="string">'\.[0-9]'</span>,<span class="string">'once'</span>))+1;
2159 
2160 nb = size(map,2);
2161 <span class="keyword">for</span> k = 1:nb,
2162     AO.(ifam).DeviceList(k,:)  = [str2double(map{k}(cellindex(k):cellindex(k)+1)) str2double(map{k}(numindex(k):end))];
2163 <span class="keyword">end</span>
2164 
2165 AO.(ifam).Status                   = ones(nb,1);
2166 AO.(ifam).DeviceName               = map';
2167 AO.(ifam).CommonNames              = [repmat(ifam,nb,1) num2str((1:nb)',<span class="string">'%02d'</span>)];
2168 AO.(ifam).ElementList              = (1:nb)';
2169 AO.(ifam).Monitor.Handles(:,1)     = NaN*ones(nb,1);
2170 AO.(ifam).Monitor.TangoNames       = strcat(AO.(ifam).DeviceName, <span class="string">'/temperature'</span>);
2171 AO.(ifam).Monitor.HW2PhysicsParams = 1;
2172 AO.(ifam).Monitor.Physics2HWParams = 1;
2173 AO.(ifam).Monitor.Units            = <span class="string">'Hardware'</span>;   
2174 AO.(ifam).Monitor.HWUnits          = <span class="string">'au'</span>;
2175 AO.(ifam).Monitor.PhysicsUnits     = <span class="string">'au'</span>;
2176 
2177 <span class="comment">%% VS</span>
2178 ifam = <span class="string">'VS'</span>;
2179 AO.(ifam).FamilyName           = ifam;
2180 AO.(ifam).MemberOf             = {<span class="string">'PlotFamily'</span>; <span class="string">'Vaccuum'</span>; <span class="string">'Archivable'</span>;<span class="string">'PlotFamily'</span>};
2181 AO.(ifam).Monitor.Mode         = Mode;
2182 AO.(ifam).Monitor.DataType     = <span class="string">'Scalar'</span>;
2183 
2184 map     = tango_get_db_property(<span class="string">'anneau'</span>,<span class="string">'vanne_secteur'</span>);
2185 cellindex = cell2mat(regexpi(map,<span class="string">'C[0-9]'</span>,<span class="string">'once'</span>))+1;
2186 numindex  = cell2mat(regexpi(map,<span class="string">'\.[0-9]'</span>,<span class="string">'once'</span>))+1;
2187 
2188 nb = size(map,2);
2189 <span class="keyword">for</span> k = 1:nb,
2190     AO.(ifam).DeviceList(k,:)  = [str2double(map{k}(cellindex(k):cellindex(k)+1)) str2double(map{k}(numindex(k):end))];
2191 <span class="keyword">end</span>
2192 
2193 AO.(ifam).Status                   = ones(nb,1);
2194 AO.(ifam).DeviceName               = map';
2195 AO.(ifam).CommonNames              = [repmat(ifam,nb,1) num2str((1:nb)',<span class="string">'%02d'</span>)];
2196 AO.(ifam).ElementList              = (1:nb)';
2197 AO.(ifam).Monitor.Handles(:,1)     = NaN*ones(nb,1);
2198 AO.(ifam).Monitor.TangoNames       = strcat(AO.(ifam).DeviceName, <span class="string">'/temperature'</span>);
2199 AO.(ifam).Monitor.HW2PhysicsParams = 1;
2200 AO.(ifam).Monitor.Physics2HWParams = 1;
2201 AO.(ifam).Monitor.Units            = <span class="string">'Hardware'</span>;   
2202 AO.(ifam).Monitor.HWUnits          = <span class="string">'au'</span>;
2203 AO.(ifam).Monitor.PhysicsUnits     = <span class="string">'au'</span>;
2204 
2205 <span class="comment">%=====================</span>
2206 <span class="comment">%% Gamma Monitors DOSE</span>
2207 <span class="comment">%====================</span>
2208 ifam = <span class="string">'CIGdose'</span>;
2209 AO.(ifam).FamilyName                     = <span class="string">'CIGdose'</span>;
2210 AO.(ifam).FamilyType                     = <span class="string">'Radioprotection'</span>;
2211 AO.(ifam).MemberOf                       = {<span class="string">'Radioprotection'</span>,<span class="string">'Archivable'</span>,<span class="string">'Plotfamily'</span>,<span class="string">'PlotFamily'</span>};
2212 AO.(ifam).CommonNames                    = <span class="string">'CIG'</span>;
2213 
2214 map = tango_get_db_property(<span class="string">'anneau'</span>,<span class="string">'gammamonitor_mapping'</span>);
2215 AO.(ifam).DeviceName = map';
2216 
2217 AO.(ifam).Monitor.Mode                   = Mode;
2218 AO.(ifam).FamilyName                     = <span class="string">'CIGdose'</span>;
2219 AO.(ifam).Monitor.DataType               = <span class="string">'Scalar'</span>;
2220 
2221 nb = length(AO.(ifam).DeviceName); 
2222 AO.(ifam).DeviceList                     = [ones(1,nb); (1:nb)]';
2223 AO.(ifam).ElementList                    = (1:nb)';
2224 AO.(ifam).Status                         = ones(nb,1);
2225 
2226 AO.(ifam).Monitor.TangoNames            = strcat(AO.(ifam).DeviceName,<span class="string">'/dose'</span>); 
2227 
2228 <span class="comment">%afin de ne pas avoir de bug</span>
2229 AO.(ifam).Monitor.Units                  = <span class="string">'Hardware'</span>;
2230 AO.(ifam).Monitor.Handles                = NaN;
2231 AO.(ifam).Monitor.HWUnits                = <span class="string">'uGy'</span>;
2232 AO.(ifam).Monitor.PhysicsUnits           = <span class="string">'uGy'</span>;
2233 AO.(ifam).Monitor.HW2PhysicsParams       = 1;
2234 AO.(ifam).Monitor.Physics2HWParams       = 1;
2235 
2236 <span class="comment">%=========================</span>
2237 <span class="comment">%% Gamma Monitors DOSErate</span>
2238 <span class="comment">%=========================</span>
2239 
2240 ifam = <span class="string">'CIGrate'</span>;
2241 AO.(ifam) = AO.CIGdose;
2242 AO.(ifam).FamilyName                     = ifam;
2243 AO.(ifam).CommonNames                    = ifam;
2244 
2245 nb = length(AO.(ifam).DeviceName); 
2246 AO.(ifam).Status                         = ones(nb,1);
2247 AO.(ifam).DeviceList                     = [ones(1,nb); (1:nb)]';
2248 AO.(ifam).ElementList                    = (1:nb)';
2249 
2250 AO.(ifam).Monitor.TangoNames            = strcat(AO.(ifam).DeviceName,<span class="string">'/doseRate'</span>); 
2251 
2252 <span class="comment">%afin de ne pas avoir de bug</span>
2253 AO.CIG.Monitor.HWUnits                = <span class="string">'uGy/h'</span>;
2254 AO.CIG.Monitor.PhysicsUnits           = <span class="string">'uGy/h'</span>;
2255 
2256 <span class="comment">%=====================</span>
2257 <span class="comment">%% Neutron Monitors DOSE</span>
2258 <span class="comment">%====================</span>
2259 ifam = <span class="string">'MONdose'</span>;
2260 AO.(ifam).FamilyName                     = ifam;
2261 AO.(ifam).FamilyType                     = <span class="string">'Radioprotection'</span>;
2262 AO.(ifam).MemberOf                       = {<span class="string">'Radioprotection'</span>,<span class="string">'Archivable'</span>,<span class="string">'Plotfamily'</span>,<span class="string">'PlotFamily'</span>};
2263 AO.(ifam).CommonNames                    = <span class="string">'MON'</span>;
2264 
2265 map = tango_get_db_property(<span class="string">'anneau'</span>,<span class="string">'neutronmonitor_mapping'</span>);
2266 AO.(ifam).DeviceName = map';
2267 
2268 AO.(ifam).Monitor.Mode                   = Mode;
2269 AO.(ifam).FamilyName                     = ifam;
2270 AO.(ifam).Monitor.DataType               = <span class="string">'Scalar'</span>;
2271 
2272 nb = length(AO.(ifam).DeviceName); 
2273 AO.(ifam).DeviceList                     = [ones(1,nb); (1:nb)]';
2274 AO.(ifam).ElementList                    = (1:nb)';
2275 AO.(ifam).Status                         = ones(nb,1);
2276 
2277 AO.(ifam).Monitor.TangoNames            = strcat(AO.(ifam).DeviceName,<span class="string">'/dDoseSinceReset'</span>); 
2278 
2279 <span class="comment">%afin de ne pas avoir de bug</span>
2280 AO.(ifam).Monitor.Units                  = <span class="string">'Hardware'</span>;
2281 AO.(ifam).Monitor.Handles                = NaN;
2282 AO.(ifam).Monitor.HWUnits                = <span class="string">'uGy'</span>;
2283 AO.(ifam).Monitor.PhysicsUnits           = <span class="string">'uGy'</span>;
2284 AO.(ifam).Monitor.HW2PhysicsParams       = 1;
2285 AO.(ifam).Monitor.Physics2HWParams       = 1;
2286 
2287 <span class="comment">%============================</span>
2288 <span class="comment">%% Neutron Monitors DOSE RATE</span>
2289 <span class="comment">%============================</span>
2290 ifam = <span class="string">'MONrate'</span>;
2291 AO.(ifam).FamilyName                     = ifam;
2292 AO.(ifam).FamilyType                     = <span class="string">'Radioprotection'</span>;
2293 AO.(ifam).MemberOf                       = {<span class="string">'Radioprotection'</span>,<span class="string">'Archivable'</span>,<span class="string">'Plotfamily'</span>,<span class="string">'PlotFamily'</span>};
2294 AO.(ifam).CommonNames                    = <span class="string">'MON'</span>;
2295 
2296 map = tango_get_db_property(<span class="string">'anneau'</span>,<span class="string">'neutronmonitor_mapping'</span>);
2297 AO.(ifam).DeviceName = map';
2298 
2299 AO.(ifam).Monitor.Mode                   = Mode;
2300 AO.(ifam).FamilyName                     = ifam;
2301 AO.(ifam).Monitor.DataType               = <span class="string">'Scalar'</span>;
2302 
2303 nb = length(AO.(ifam).DeviceName); 
2304 AO.(ifam).DeviceList                     = [ones(1,nb); (1:nb)]';
2305 AO.(ifam).ElementList                    = (1:nb)';
2306 AO.(ifam).Status                         = ones(nb,1);
2307 
2308 AO.(ifam).Monitor.TangoNames            = strcat(AO.(ifam).DeviceName,<span class="string">'/dCountsSinceReset'</span>); 
2309 
2310 <span class="comment">%afin de ne pas avoir de bug</span>
2311 AO.(ifam).Monitor.Units                  = <span class="string">'Hardware'</span>;
2312 AO.(ifam).Monitor.Handles                = NaN;
2313 AO.(ifam).Monitor.HWUnits                = <span class="string">'uGy'</span>;
2314 AO.(ifam).Monitor.PhysicsUnits           = <span class="string">'uGy'</span>;
2315 AO.(ifam).Monitor.HW2PhysicsParams       = 1;
2316 AO.(ifam).Monitor.Physics2HWParams       = 1;
2317 
2318 <span class="comment">% %====================</span>
2319 <span class="comment">% %% Machine Parameters</span>
2320 <span class="comment">% %====================</span>
2321 <span class="comment">% AO.MachineParameters.FamilyName                = 'MachineParameters';</span>
2322 <span class="comment">% AO.MachineParameters.FamilyType                = 'Parameter';</span>
2323 <span class="comment">% AO.MachineParameters.MemberOf                  = {'Diagnostics'};</span>
2324 <span class="comment">% AO.MachineParameters.Status                    = [1 1 1 1]';</span>
2325 <span class="comment">%</span>
2326 <span class="comment">% AO.MachineParameters.Monitor.Mode              = Mode;</span>
2327 <span class="comment">% AO.MachineParameters.Monitor.DataType          = 'Scalar';</span>
2328 <span class="comment">% AO.MachineParameters.Monitor.Units             = 'Hardware';</span>
2329 <span class="comment">%</span>
2330 <span class="comment">% %use spear2 process variable names</span>
2331 <span class="comment">% mp={</span>
2332 <span class="comment">%     'mode    '    'SPEAR:BeamStatus  '          [1 1]  1; ...</span>
2333 <span class="comment">%     'energy  '    'SPEAR:Energy      '          [1 2]  2; ...</span>
2334 <span class="comment">%     'current '    'SPEAR:BeamCurrAvg '          [1 3]  3; ...</span>
2335 <span class="comment">%     'lifetime'    'SPEAR:BeamLifetime'          [1 4]  4; ...</span>
2336 <span class="comment">%     };</span>
2337 <span class="comment">% AO.MachineParameters.Monitor.HWUnits          = ' ';</span>
2338 <span class="comment">% AO.MachineParameters.Monitor.PhysicsUnits     = ' ';</span>
2339 <span class="comment">%</span>
2340 <span class="comment">% AO.MachineParameters.Setpoint.HWUnits         = ' ';</span>
2341 <span class="comment">% AO.MachineParameters.Setpoint.PhysicsUnits    = ' ';</span>
2342 <span class="comment">%</span>
2343 <span class="comment">% for ii=1:size(mp,1),</span>
2344 <span class="comment">%     name  =mp(ii,1);    AO.MachineParameters.CommonNames(ii,:)            = char(name{1});</span>
2345 <span class="comment">%     %     name  =mp(ii,2);    AO.MachineParameters.Monitor.ChannelNames(ii,:)   = char(name{1});</span>
2346 <span class="comment">%     %     name  =mp(ii,2);    AO.MachineParameters.Setpoint.ChannelNames(ii,:)  = char(name{1});</span>
2347 <span class="comment">%     val   =mp(ii,3);    AO.MachineParameters.DeviceList(ii,:)             = val{1};</span>
2348 <span class="comment">%     val   =mp(ii,4);    AO.MachineParameters.ElementList(ii,:)            = val{1};</span>
2349 <span class="comment">%</span>
2350 <span class="comment">%     AO.MachineParameters.Monitor.HW2PhysicsParams(ii,:)    = 1;</span>
2351 <span class="comment">%     AO.MachineParameters.Monitor.Physics2HWParams(ii,:)    = 1;</span>
2352 <span class="comment">%     AO.MachineParameters.Monitor.Handles(ii,1)  = NaN;</span>
2353 <span class="comment">%     AO.MachineParameters.Setpoint.HW2PhysicsParams(ii,:)   = 1;</span>
2354 <span class="comment">%     AO.MachineParameters.Setpoint.Physics2HWParams(ii,:)   = 1;</span>
2355 <span class="comment">%     AO.MachineParameters.Setpoint.Handles(ii,1)  = NaN;</span>
2356 <span class="comment">% end</span>
2357 
2358 
2359 <span class="comment">%======</span>
2360 <span class="comment">%% Septum</span>
2361 <span class="comment">%======</span>
2362 <span class="comment">% ifam=ifam+1;</span>
2363 <span class="comment">% AO.Septum.FamilyName                  = 'Septum';</span>
2364 <span class="comment">% AO.Septum.FamilyType                  = 'Septum';</span>
2365 <span class="comment">% AO.Septum.MemberOf                    = {'Injection'};</span>
2366 <span class="comment">% AO.Septum.Status                      = 1;</span>
2367 <span class="comment">%</span>
2368 <span class="comment">% AO.Septum.CommonNames                 = 'Septum  ';</span>
2369 <span class="comment">% AO.Septum.DeviceList                  = [3 1];</span>
2370 <span class="comment">% AO.Septum.ElementList                 = [1];</span>
2371 <span class="comment">%</span>
2372 <span class="comment">% AO.Septum.Monitor.Mode                = Mode;</span>
2373 <span class="comment">% AO.Septum.Monitor.DataType            = 'Scalar';</span>
2374 <span class="comment">% AO.Septum.Monitor.Units               = 'Hardware';</span>
2375 <span class="comment">% AO.Septum.Monitor.HWUnits             = 'ampere';</span>
2376 <span class="comment">% AO.Septum.Monitor.PhysicsUnits        = 'rad';</span>
2377 <span class="comment">% AO.Septum.Monitor.ChannelNames        = 'BTS-B9V:Curr';</span>
2378 <span class="comment">% AO.Septum.Monitor.Handles             = NaN;</span>
2379 <span class="comment">%</span>
2380 <span class="comment">% AO.Septum.Setpoint.Mode               = Mode;</span>
2381 <span class="comment">% AO.Septum.Setpoint.DataType           = 'Scalar';</span>
2382 <span class="comment">% AO.Septum.Setpoint.Units              = 'Hardware';</span>
2383 <span class="comment">% AO.Septum.Setpoint.HWUnits            = 'ampere';</span>
2384 <span class="comment">% AO.Septum.Setpoint.PhysicsUnits       = 'rad';</span>
2385 <span class="comment">% AO.Septum.Setpoint.ChannelNames       = 'BTS-B9V:CurrSetpt';</span>
2386 <span class="comment">% AO.Septum.Setpoint.Range              = [0, 249.90];</span>
2387 <span class="comment">% AO.Septum.Setpoint.Tolerance          = 100.0;</span>
2388 <span class="comment">% AO.Septum.Setpoint.Handles            = NaN;</span>
2389 <span class="comment">%</span>
2390 <span class="comment">% AO.Septum.Monitor.HW2PhysicsParams    = 1;</span>
2391 <span class="comment">% AO.Septum.Monitor.Physics2HWParams    = 1;</span>
2392 <span class="comment">% AO.Septum.Setpoint.HW2PhysicsParams   = 1;</span>
2393 <span class="comment">% AO.Septum.Setpoint.Physics2HWParams   = 1;</span>
2394 
2395 <span class="comment">% Save AO</span>
2396 setao(AO);
2397 
2398 <span class="comment">% The operational mode sets the path, filenames, and other important params</span>
2399 <span class="comment">% Run setoperationalmode after most of the AO is built so that the Units and Mode fields</span>
2400 <span class="comment">% can be set in setoperationalmode</span>
2401 
2402 <a href="setoperationalmode.html" class="code" title="function setoperationalmode(ModeNumber)">setoperationalmode</a>(OperationalMode);
2403 
2404 <span class="comment">%======================================================================</span>
2405 <span class="comment">%======================================================================</span>
2406 <span class="comment">%% Append Accelerator Toolbox information</span>
2407 <span class="comment">%======================================================================</span>
2408 <span class="comment">%======================================================================</span>
2409 disp(<span class="string">'** Initializing Accelerator Toolbox information'</span>);
2410 
2411 AO = getao;
2412 
2413 ATindx = atindex(THERING);  <span class="comment">%structure with fields containing indices</span>
2414 
2415 s = findspos(THERING,1:length(THERING)+1)';
2416 
2417 <span class="comment">%% Horizontal BPMs</span>
2418 <span class="comment">% WARNING: BPM1 is the one before the injection straigth section</span>
2419 <span class="comment">%          since a cell begins from begin of Straigths</span>
2420 <span class="comment">% CELL1 BPM1 to BPM7</span>
2421 ifam = (<span class="string">'BPMx'</span>);
2422 AO.(ifam).AT.ATType  = ifam;
2423 AO.(ifam).AT.ATIndex = ATindx.BPM(:);
2424 AO.(ifam).Position   = s(AO.(ifam).AT.ATIndex);
2425 
2426 <span class="comment">%% Vertical BPMs</span>
2427 ifam = (<span class="string">'BPMz'</span>);
2428 AO.(ifam).AT.ATType  = ifam;
2429 AO.(ifam).AT.ATIndex = ATindx.BPM(:);
2430 AO.(ifam).Position   = s(AO.(ifam).AT.ATIndex);  
2431 
2432 <span class="comment">%% SLOW HORIZONTAL CORRECTORS</span>
2433 ifam = (<span class="string">'HCOR'</span>);
2434 AO.(ifam).AT.ATType  = ifam;
2435 AO.(ifam).AT.ATIndex = ATindx.COR(:);
2436 AO.(ifam).AT.ATIndex = AO.(ifam).AT.ATIndex(AO.(ifam).ElementList);   <span class="comment">%not all correctors used</span>
2437 AO.(ifam).Position   = s(AO.(ifam).AT.ATIndex);
2438 
2439 <span class="comment">%% SLOW VERTICAL CORRECTORS</span>
2440 ifam = (<span class="string">'VCOR'</span>);
2441 AO.(ifam).AT.ATType  = ifam;
2442 AO.(ifam).AT.ATIndex = ATindx.COR(:);
2443 AO.(ifam).AT.ATIndex = AO.(ifam).AT.ATIndex(AO.(ifam).ElementList);   <span class="comment">%not all correctors used</span>
2444 AO.(ifam).Position   = s(AO.(ifam).AT.ATIndex);  <span class="comment">%for SPEAR 3 horizontal and vertical correctors at same s-position</span>
2445 
2446 <span class="comment">%% FAST HORIZONTAL CORRECTORS</span>
2447 ifam = (<span class="string">'FHCOR'</span>);
2448 AT.(ifam).AT.ATType  = ifam;
2449 AT.(ifam).AT.ATIndex = ATindx.FCOR([end 1:end-1])';
2450 AT.(ifam).Position   = s(AT.(ifam).AT.ATIndex);
2451 
2452 <span class="comment">%% FAST VERTICAL CORRECTORS</span>
2453 ifam = (<span class="string">'FVCOR'</span>);
2454 AO.(ifam).AT.ATType  = ifam;
2455 AO.(ifam).AT.ATIndex = ATindx.FCOR([end 1:end-1])';
2456 AO.(ifam).Position   = s(AO.(ifam).AT.ATIndex); 
2457 
2458 <span class="comment">%% SKEW QUADS</span>
2459 ifam = (<span class="string">'QT'</span>);
2460 AO.(ifam).AT.ATType  = <span class="string">'SkewQuad'</span>;
2461 AO.(ifam).AT.ATIndex = ATindx.SkewQuad(:);
2462 AO.(ifam).AT.ATIndex = AO.(ifam).AT.ATIndex(AO.(ifam).ElementList);   <span class="comment">%not all correctors used</span>
2463 AO.(ifam).Position   = s(AO.(ifam).AT.ATIndex);
2464 
2465 <span class="comment">%% BENDING magnets</span>
2466 ifam = (<span class="string">'BEND'</span>);
2467 AO.(ifam).AT.ATType  = ifam;
2468 AO.(ifam).AT.ATIndex = ATindx.BEND(:);
2469 <span class="comment">%AT.(ifam).Position   = s(AT.(ifam).AT.ATIndex);</span>
2470 <span class="comment">% One group of all dipoles</span>
2471 AO.(ifam).Position   = reshape(s(AO.(ifam).AT.ATIndex),1,32);
2472 <span class="comment">%AT.(ifam).AT.ATParamGroup = mkparamgroup(THERING,AT.(ifam).AT.ATIndex,'K2');</span>
2473 
2474 
2475 <span class="comment">%% QUADRUPOLES</span>
2476 <span class="keyword">for</span> k = 1:10,
2477     ifam = [<span class="string">'Q'</span> num2str(k)];
2478     AO.(ifam).AT.ATType  = <span class="string">'QUAD'</span>;
2479     AO.(ifam).AT.ATIndex = eval([<span class="string">'ATindx.'</span> ifam <span class="string">'(:)'</span>]);
2480     AO.(ifam).Position   = s(AO.(ifam).AT.ATIndex);
2481 <span class="keyword">end</span>
2482 
2483 <span class="comment">%% SEXTUPOLES</span>
2484 <span class="keyword">for</span> k = 1:10,
2485     ifam = [<span class="string">'S'</span> num2str(k)];
2486     AO.(ifam).AT.ATType  = <span class="string">'SEXT'</span>;
2487     AO.(ifam).AT.ATIndex = eval([<span class="string">'ATindx.'</span> ifam <span class="string">'(:)'</span>]);
2488     AO.(ifam).Position   = s(AO.(ifam).AT.ATIndex);
2489     AO.(ifam).AT.ATParamGroup = mkparamgroup(THERING,AO.(ifam).AT.ATIndex,<span class="string">'K2'</span>);
2490 <span class="keyword">end</span>
2491 
2492 <span class="comment">% %kickeramps</span>
2493 <span class="comment">% ifam = ('KickerAmp');</span>
2494 <span class="comment">% AT.(ifam).AT.ATType  = 'KickerAmp';</span>
2495 <span class="comment">% AT.(ifam).AT.ATIndex = ATindx.KICKER(:);</span>
2496 <span class="comment">% AT.(ifam).Position= s(AT.(ifam).AT.ATIndex);</span>
2497 <span class="comment">%</span>
2498 <span class="comment">% %kickerdelay</span>
2499 <span class="comment">% ifam = ('KickerDelay');</span>
2500 <span class="comment">% AT.(ifam).AT.ATType  = 'Kicker';</span>
2501 <span class="comment">% AT.(ifam).AT.ATIndex = ATindx.KICKER(:);</span>
2502 <span class="comment">% AT.(ifam).Position= s(AT.(ifam).AT.ATIndex);</span>
2503 <span class="comment">%</span>
2504 <span class="comment">% %septum</span>
2505 <span class="comment">% ifam = ('Septum');</span>
2506 <span class="comment">% AT.(ifam).AT.ATType  = 'Septum';</span>
2507 <span class="comment">% AT.(ifam).AT.ATIndex = ATindx.SEPTUM(:);</span>
2508 <span class="comment">% AT.(ifam).Position   = s(AT.(ifam).AT.ATIndex);</span>
2509 
2510 <span class="comment">%% RF Cavity</span>
2511 ifam = (<span class="string">'RF'</span>);
2512 AO.(ifam).AT.ATType = <span class="string">'RF Cavity'</span>;
2513 AO.(ifam).AT.ATIndex = findcells(THERING,<span class="string">'Frequency'</span>)';
2514 AO.(ifam).Position   = s(AO.(ifam).AT.ATIndex);
2515 
2516 <span class="comment">%% Machine Params</span>
2517 ifam = (<span class="string">'MachineParams'</span>);
2518 AO.(ifam).AT.ATType       = <span class="string">'MachineParams'</span>;
2519 AO.(ifam).AT.ATName(1,:)  = <span class="string">'Energy  '</span>;
2520 AO.(ifam).AT.ATName(2,:)  = <span class="string">'current '</span>;
2521 AO.(ifam).AT.ATName(3,:)  = <span class="string">'Lifetime'</span>;
2522 
2523 <span class="comment">% Save AO</span>
2524 setao(AO);
2525 
2526 disp(<span class="string">'Setting min max configuration from TANGO static database ...'</span>);
2527 
2528 <span class="comment">% set real min max value read from TANGO</span>
2529 <span class="comment">% setrange('HCOR');</span>
2530 <span class="comment">% setrange('VCOR');</span>
2531 <span class="comment">% %setrange('FHCOR');</span>
2532 <span class="comment">% %setrange('FVCOR');</span>
2533 <span class="comment">% setrange('BEND');</span>
2534 <span class="comment">% setrange('Q1');</span>
2535 <span class="comment">% setrange('Q2');</span>
2536 <span class="comment">% setrange('Q3');</span>
2537 <span class="comment">% setrange('Q4');</span>
2538 <span class="comment">% setrange('Q5');</span>
2539 <span class="comment">% setrange('Q6');</span>
2540 <span class="comment">% setrange('Q7');</span>
2541 <span class="comment">% setrange('Q8');</span>
2542 <span class="comment">% setrange('Q9');</span>
2543 <span class="comment">% setrange('Q10');</span>
2544 <span class="comment">% setrange('S1');</span>
2545 <span class="comment">% setrange('S2');</span>
2546 <span class="comment">% setrange('S3');</span>
2547 <span class="comment">% setrange('S4');</span>
2548 <span class="comment">% setrange('S5');</span>
2549 <span class="comment">% setrange('S6');</span>
2550 <span class="comment">% setrange('S7');</span>
2551 <span class="comment">% setrange('S8');</span>
2552 <span class="comment">% setrange('S9');</span>
2553 <span class="comment">% setrange('S10');</span>
2554 
2555 <span class="comment">%setrange('RF');</span>
2556 
2557 disp(<span class="string">'Setting gain offset configuration  ...'</span>);
2558 
2559 setfamilydata([0.20; 0.30; NaN],<span class="string">'TUNE'</span>,<span class="string">'Golden'</span>);
2560 setfamilydata([0.0; 0.0],<span class="string">'CHRO'</span>,<span class="string">'Golden'</span>);
2561 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'BPMx'</span>);
2562 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'BPMz'</span>);
2563 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'HCOR'</span>);
2564 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'VCOR'</span>);
2565 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'FHCOR'</span>);
2566 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'FVCOR'</span>);
2567 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'Q1'</span>);
2568 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'Q2'</span>);
2569 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'Q3'</span>);
2570 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'Q4'</span>);
2571 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'Q5'</span>);
2572 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'Q6'</span>);
2573 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'Q7'</span>);
2574 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'Q8'</span>);
2575 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'Q9'</span>);
2576 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'Q10'</span>);
2577 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'S1'</span>);
2578 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'S2'</span>);
2579 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'S3'</span>);
2580 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'S4'</span>);
2581 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'S5'</span>);
2582 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'S6'</span>);
2583 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'S7'</span>);
2584 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'S8'</span>);
2585 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'S9'</span>);
2586 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'S10'</span>);
2587 <a href="#_sub1" class="code" title="subfunction setfamilydata_local(Family)">setfamilydata_local</a>(<span class="string">'BEND'</span>);
2588 
2589 <span class="keyword">if</span> iscontrolroom
2590     switch2online;
2591 <span class="keyword">else</span>
2592     switch2sim;
2593 <span class="keyword">end</span>
2594 
2595 
2596 <span class="comment">% set close orbit</span>
2597 <span class="comment">% fprintf('%3d %3d  %10.6f  %10.6f\n', [family2dev('BPMx'), getgolden('BPMx'), getgolden('BPMz')]');</span>
2598 
2599 <span class="comment">% Golden = [</span>
2600 <span class="comment">%   1   2   -0.000000   -0.000000</span>
2601 <span class="comment">%   1   3   -0.000000   -0.000000</span>
2602 <span class="comment">%   1   4    0.000000    0.000000</span>
2603 <span class="comment">%   1   5   -0.000000   -0.000000</span>
2604 <span class="comment">%   1   6   -0.000000    0.000000</span>
2605 <span class="comment">%   1   7    0.000000   -0.000000</span>
2606 <span class="comment">%   2   1    0.000000    0.000000</span>
2607 <span class="comment">%   2   2    0.000000    0.000000</span>
2608 <span class="comment">%   2   3   -0.000000   -0.000000</span>
2609 <span class="comment">%   2   4    0.000000   -0.000000</span>
2610 <span class="comment">%   2   5   -0.000000    0.000000</span>
2611 <span class="comment">%   2   6    0.000000   -0.000000</span>
2612 <span class="comment">%   2   7    0.000000   -0.000000</span>
2613 <span class="comment">%   2   8    0.000000   -0.000000</span>
2614 <span class="comment">%   3   1    0.000000    0.000000</span>
2615 <span class="comment">%   3   2   -0.000000   -0.000000</span>
2616 <span class="comment">%   3   3    0.000000    0.000000</span>
2617 <span class="comment">%   3   4   -0.000000   -0.000000</span>
2618 <span class="comment">%   3   5    0.000000   -0.000000</span>
2619 <span class="comment">%   3   6    0.000000    0.000000</span>
2620 <span class="comment">%   3   7    0.000000   -0.000000</span>
2621 <span class="comment">%   3   8    0.000000    0.000000</span>
2622 <span class="comment">%   4   1    0.000000   -0.000000</span>
2623 <span class="comment">%   4   2    0.000000   -0.000000</span>
2624 <span class="comment">%   4   3   -0.000000   -0.000000</span>
2625 <span class="comment">%   4   4    0.000000    0.000000</span>
2626 <span class="comment">%   4   5    0.000000    0.000000</span>
2627 <span class="comment">%   4   6   -0.000000    0.000000</span>
2628 <span class="comment">%   4   7   -0.000000   -0.000000</span>
2629 <span class="comment">%   5   1   -0.000000    0.000000</span>
2630 <span class="comment">%   5   2   -0.000000    0.000000</span>
2631 <span class="comment">%   5   3    0.000000    0.000000</span>
2632 <span class="comment">%   5   4    0.000000   -0.000000</span>
2633 <span class="comment">%   5   5   -0.000000   -0.000000</span>
2634 <span class="comment">%   5   6    0.000000    0.000000</span>
2635 <span class="comment">%   5   7   -0.000000   -0.000000</span>
2636 <span class="comment">%   6   1   -0.000000    0.000000</span>
2637 <span class="comment">%   6   2    0.000000   -0.000000</span>
2638 <span class="comment">%   6   3    0.000000   -0.000000</span>
2639 <span class="comment">%   6   4   -0.000000    0.000000</span>
2640 <span class="comment">%   6   5    0.000000    0.000000</span>
2641 <span class="comment">%   6   6   -0.000000   -0.000000</span>
2642 <span class="comment">%   6   7   -0.000000    0.000000</span>
2643 <span class="comment">%   6   8    0.000000    0.000000</span>
2644 <span class="comment">%   7   1   -0.000000   -0.000000</span>
2645 <span class="comment">%   7   2   -0.000000   -0.000000</span>
2646 <span class="comment">%   7   3   -0.000000    0.000000</span>
2647 <span class="comment">%   7   4    0.000000   -0.000000</span>
2648 <span class="comment">%   7   5   -0.000000   -0.000000</span>
2649 <span class="comment">%   7   6    0.000000   -0.000000</span>
2650 <span class="comment">%   7   7    0.000000    0.000000</span>
2651 <span class="comment">%   7   8    0.000000    0.000000</span>
2652 <span class="comment">%   8   1   -0.000000   -0.000000</span>
2653 <span class="comment">%   8   2   -0.000000    0.000000</span>
2654 <span class="comment">%   8   3    0.000000   -0.000000</span>
2655 <span class="comment">%   8   4    0.000000   -0.000000</span>
2656 <span class="comment">%   8   5    0.000000   -0.000000</span>
2657 <span class="comment">%   8   6    0.000000   -0.000000</span>
2658 <span class="comment">%   8   7   -0.000000   -0.000000</span>
2659 <span class="comment">%   9   1   -0.000000   -0.000000</span>
2660 <span class="comment">%   9   2   -0.000000   -0.000000</span>
2661 <span class="comment">%   9   3    0.000000    0.000000</span>
2662 <span class="comment">%   9   4   -0.000000    0.000000</span>
2663 <span class="comment">%   9   5    0.000000   -0.000000</span>
2664 <span class="comment">%   9   6    0.000000    0.000000</span>
2665 <span class="comment">%   9   7   -0.000000    0.000000</span>
2666 <span class="comment">%  10   1    0.000000   -0.000000</span>
2667 <span class="comment">%  10   2    0.000000   -0.000000</span>
2668 <span class="comment">%  10   3   -0.000000    0.000000</span>
2669 <span class="comment">%  10   4   -0.000000    0.000000</span>
2670 <span class="comment">%  10   5   -0.000000    0.000000</span>
2671 <span class="comment">%  10   6   -0.000000   -0.000000</span>
2672 <span class="comment">%  10   7    0.000000   -0.000000</span>
2673 <span class="comment">%  10   8    0.000000    0.000000</span>
2674 <span class="comment">%  11   1    0.000000   -0.000000</span>
2675 <span class="comment">%  11   2    0.000000   -0.000000</span>
2676 <span class="comment">%  11   3    0.000000    0.000000</span>
2677 <span class="comment">%  11   4   -0.000000    0.000000</span>
2678 <span class="comment">%  11   5   -0.000000   -0.000000</span>
2679 <span class="comment">%  11   6    0.000000   -0.000000</span>
2680 <span class="comment">%  11   7   -0.000000   -0.000000</span>
2681 <span class="comment">%  11   8    0.000000   -0.000000</span>
2682 <span class="comment">%  12   1   -0.000000    0.000000</span>
2683 <span class="comment">%  12   2   -0.000000    0.000000</span>
2684 <span class="comment">%  12   3    0.000000    0.000000</span>
2685 <span class="comment">%  12   4    0.000000   -0.000000</span>
2686 <span class="comment">%  12   5   -0.000000    0.000000</span>
2687 <span class="comment">%  12   6    0.000000   -0.000000</span>
2688 <span class="comment">%  12   7    0.000000    0.000000</span>
2689 <span class="comment">%  13   1   -0.000000   -0.000000</span>
2690 <span class="comment">%  13   2    0.000000   -0.000000</span>
2691 <span class="comment">%  13   3   -0.000000    0.000000</span>
2692 <span class="comment">%  13   4    0.000000    0.000000</span>
2693 <span class="comment">%  13   5   -0.000000   -0.000000</span>
2694 <span class="comment">%  13   6    0.000000   -0.000000</span>
2695 <span class="comment">%  13   7    0.000000    0.000000</span>
2696 <span class="comment">%  14   1   -0.000000    0.000000</span>
2697 <span class="comment">%  14   2    0.000000   -0.000000</span>
2698 <span class="comment">%  14   3   -0.000000   -0.000000</span>
2699 <span class="comment">%  14   4    0.000000    0.000000</span>
2700 <span class="comment">%  14   5   -0.000000    0.000000</span>
2701 <span class="comment">%  14   6   -0.000000    0.000000</span>
2702 <span class="comment">%  14   7   -0.000000   -0.000000</span>
2703 <span class="comment">%  14   8    0.000000    0.000000</span>
2704 <span class="comment">%  15   1   -0.000000    0.000000</span>
2705 <span class="comment">%  15   2    0.000000    0.000000</span>
2706 <span class="comment">%  15   3   -0.000000   -0.000000</span>
2707 <span class="comment">%  15   4   -0.000000    0.000000</span>
2708 <span class="comment">%  15   5   -0.000000   -0.000000</span>
2709 <span class="comment">%  15   6    0.000000   -0.000000</span>
2710 <span class="comment">%  15   7    0.000000    0.000000</span>
2711 <span class="comment">%  15   8   -0.000000   -0.000000</span>
2712 <span class="comment">%  16   1   -0.000000   -0.000000</span>
2713 <span class="comment">%  16   2    0.000000    0.000000</span>
2714 <span class="comment">%  16   3   -0.000000   -0.000000</span>
2715 <span class="comment">%  16   4    0.000000    0.000000</span>
2716 <span class="comment">%  16   5   -0.000000   -0.000000</span>
2717 <span class="comment">%  16   6   -0.000000    0.000000</span>
2718 <span class="comment">%  16   7    0.000000   -0.000000</span>
2719 <span class="comment">%   1   1   -0.000000    0.000000</span>
2720 <span class="comment">% ];</span>
2721 <span class="comment">%  Golden = [</span>
2722 <span class="comment">%   1   2   -0.016109   -0.029329</span>
2723 <span class="comment">%   1   3   -0.004005    0.007886</span>
2724 <span class="comment">%   1   4    0.072212    0.062367</span>
2725 <span class="comment">%   1   5   -0.024518    0.055139</span>
2726 <span class="comment">%   1   6   -0.064471    0.013784</span>
2727 <span class="comment">%   1   7    0.013930    0.135550</span>
2728 <span class="comment">%   2   1   -0.011554   -0.070312</span>
2729 <span class="comment">%   2   2   -0.050394   -0.078194</span>
2730 <span class="comment">%   2   3    0.032176    0.082341</span>
2731 <span class="comment">%   2   4   -0.029317    0.117253</span>
2732 <span class="comment">%   2   5    0.015890   -0.007759</span>
2733 <span class="comment">%   2   6    0.016312    0.063036</span>
2734 <span class="comment">%   2   7   -0.032808   -0.177137</span>
2735 <span class="comment">%   2   8    0.039461   -0.045681</span>
2736 <span class="comment">%   3   1   -0.062566   -0.018802</span>
2737 <span class="comment">%   3   2   -0.006602    0.184429</span>
2738 <span class="comment">%   3   3    0.018723   -0.176785</span>
2739 <span class="comment">%   3   4   -0.116008   -0.105529</span>
2740 <span class="comment">%   3   5    0.097402   -0.028190</span>
2741 <span class="comment">%   3   6    0.045757   -0.097066</span>
2742 <span class="comment">%   3   7   -0.066598   -0.175309</span>
2743 <span class="comment">%   3   8   -0.007365    0.036844</span>
2744 <span class="comment">%   4   1    0.019824    0.142689</span>
2745 <span class="comment">%   4   2   -0.000176   -0.068519</span>
2746 <span class="comment">%   4   3   -0.006800   -0.041942</span>
2747 <span class="comment">%   4   4   -0.034004   -0.022842</span>
2748 <span class="comment">%   4   5    0.037034    0.059478</span>
2749 <span class="comment">%   4   6   -0.014433   -0.166529</span>
2750 <span class="comment">%   4   7   -0.061407    0.017149</span>
2751 <span class="comment">%   5   1    0.080897    0.076740</span>
2752 <span class="comment">%   5   2   -0.012038    0.040356</span>
2753 <span class="comment">%   5   3   -0.013179   -0.002226</span>
2754 <span class="comment">%   5   4    0.069290   -0.111001</span>
2755 <span class="comment">%   5   5    0.038943    0.008662</span>
2756 <span class="comment">%   5   6   -0.129630    0.011481</span>
2757 <span class="comment">%   5   7   -0.000920    0.036813</span>
2758 <span class="comment">%   6   1    0.016272   -0.052574</span>
2759 <span class="comment">%   6   2    0.031234    0.061241</span>
2760 <span class="comment">%   6   3   -0.009122   -0.018313</span>
2761 <span class="comment">%   6   4   -0.159022    0.006281</span>
2762 <span class="comment">%   6   5    0.139226   -0.058757</span>
2763 <span class="comment">%   6   6    0.100120   -0.090672</span>
2764 <span class="comment">%   6   7   -0.129504   -0.062824</span>
2765 <span class="comment">%   6   8    0.006805   -0.001487</span>
2766 <span class="comment">%   7   1    0.006808    0.106658</span>
2767 <span class="comment">%   7   2   -0.029256   -0.086426</span>
2768 <span class="comment">%   7   3    0.005422    0.016194</span>
2769 <span class="comment">%   7   4    0.055600    0.003513</span>
2770 <span class="comment">%   7   5   -0.042632   -0.001866</span>
2771 <span class="comment">%   7   6   -0.126872    0.026082</span>
2772 <span class="comment">%   7   7    0.140233   -0.081977</span>
2773 <span class="comment">%   7   8   -0.019330    0.079127</span>
2774 <span class="comment">%   8   1   -0.012088   -0.008979</span>
2775 <span class="comment">%   8   2    0.053612   -0.018187</span>
2776 <span class="comment">%   8   3   -0.014107    0.028316</span>
2777 <span class="comment">%   8   4   -0.157538   -0.013089</span>
2778 <span class="comment">%   8   5   -0.046621   -0.070002</span>
2779 <span class="comment">%   8   6    0.207227    0.065337</span>
2780 <span class="comment">%   8   7   -0.054266    0.021793</span>
2781 <span class="comment">%   9   1    0.017264   -0.015635</span>
2782 <span class="comment">%   9   2    0.030052   -0.042293</span>
2783 <span class="comment">%   9   3   -0.025084    0.007168</span>
2784 <span class="comment">%   9   4   -0.020432    0.075486</span>
2785 <span class="comment">%   9   5    0.110440   -0.049762</span>
2786 <span class="comment">%   9   6   -0.116610   -0.012532</span>
2787 <span class="comment">%   9   7   -0.011486    0.106592</span>
2788 <span class="comment">%  10   1    0.024628    0.050707</span>
2789 <span class="comment">%  10   2    0.021953   -0.143527</span>
2790 <span class="comment">%  10   3   -0.013703   -0.001596</span>
2791 <span class="comment">%  10   4   -0.049724    0.108386</span>
2792 <span class="comment">%  10   5    0.030980    0.098887</span>
2793 <span class="comment">%  10   6    0.108697    0.146079</span>
2794 <span class="comment">%  10   7   -0.121358    0.133295</span>
2795 <span class="comment">%  10   8   -0.033342   -0.219970</span>
2796 <span class="comment">%  11   1    0.062153    0.036616</span>
2797 <span class="comment">%  11   2    0.078471    0.011798</span>
2798 <span class="comment">%  11   3   -0.032535   -0.064236</span>
2799 <span class="comment">%  11   4   -0.225522    0.118926</span>
2800 <span class="comment">%  11   5    0.211643    0.060435</span>
2801 <span class="comment">%  11   6    0.046324    0.023765</span>
2802 <span class="comment">%  11   7   -0.084590   -0.050827</span>
2803 <span class="comment">%  11   8    0.003712   -0.108471</span>
2804 <span class="comment">%  12   1    0.002993    0.105625</span>
2805 <span class="comment">%  12   2    0.004842   -0.084366</span>
2806 <span class="comment">%  12   3   -0.001208    0.108071</span>
2807 <span class="comment">%  12   4   -0.083760   -0.032507</span>
2808 <span class="comment">%  12   5    0.084936   -0.059238</span>
2809 <span class="comment">%  12   6   -0.024508    0.018948</span>
2810 <span class="comment">%  12   7   -0.029985    0.033101</span>
2811 <span class="comment">%  13   1    0.043133    0.026918</span>
2812 <span class="comment">%  13   2   -0.034035   -0.122866</span>
2813 <span class="comment">%  13   3    0.000740    0.025621</span>
2814 <span class="comment">%  13   4    0.095937    0.106642</span>
2815 <span class="comment">%  13   5    0.045263    0.013359</span>
2816 <span class="comment">%  13   6   -0.171956    0.045738</span>
2817 <span class="comment">%  13   7    0.031641    0.052087</span>
2818 <span class="comment">%  14   1   -0.027082   -0.000829</span>
2819 <span class="comment">%  14   2    0.021254   -0.099073</span>
2820 <span class="comment">%  14   3   -0.019560    0.017342</span>
2821 <span class="comment">%  14   4   -0.004520    0.162526</span>
2822 <span class="comment">%  14   5    0.005853    0.059292</span>
2823 <span class="comment">%  14   6    0.008179   -0.047524</span>
2824 <span class="comment">%  14   7   -0.001401   -0.102715</span>
2825 <span class="comment">%  14   8   -0.055800    0.098121</span>
2826 <span class="comment">%  15   1    0.074795    0.023368</span>
2827 <span class="comment">%  15   2    0.038731   -0.095221</span>
2828 <span class="comment">%  15   3   -0.026061    0.115497</span>
2829 <span class="comment">%  15   4   -0.088833   -0.011771</span>
2830 <span class="comment">%  15   5    0.084328    0.015239</span>
2831 <span class="comment">%  15   6    0.037638   -0.097017</span>
2832 <span class="comment">%  15   7   -0.055234   -0.009165</span>
2833 <span class="comment">%  15   8    0.021390   -0.027726</span>
2834 <span class="comment">%  16   1   -0.036755    0.149702</span>
2835 <span class="comment">%  16   2   -0.002163   -0.181339</span>
2836 <span class="comment">%  16   3    0.014132    0.013743</span>
2837 <span class="comment">%  16   4   -0.133713    0.140012</span>
2838 <span class="comment">%  16   5    0.094131    0.004707</span>
2839 <span class="comment">%  16   6    0.016469    0.147084</span>
2840 <span class="comment">%  16   7   -0.008833   -0.018775</span>
2841 <span class="comment">%   1   1    0.001073   -0.109009</span>
2842 <span class="comment">% Golden du 27 mars 2007 100 mA</span>
2843 
2844 <span class="comment">% Golden = [</span>
2845 <span class="comment">%   1   2   -0.005797   -0.017312</span>
2846 <span class="comment">%   1   3    0.000919   -0.015076</span>
2847 <span class="comment">%   1   4    0.016414    0.026510</span>
2848 <span class="comment">%   1   5   -0.121497    0.059608</span>
2849 <span class="comment">%   1   6    0.119201    0.067078</span>
2850 <span class="comment">%   1   7   -0.010365    0.157920</span>
2851 <span class="comment">%   2   1   -0.013197   -0.098301</span>
2852 <span class="comment">%   2   2    0.027261   -0.062963</span>
2853 <span class="comment">%   2   3   -0.015684    0.035225</span>
2854 <span class="comment">%   2   4    0.012233    0.143302</span>
2855 <span class="comment">%   2   5   -0.009376    0.059353</span>
2856 <span class="comment">%   2   6   -0.071856    0.011451</span>
2857 <span class="comment">%   2   7    0.063409   -0.081142</span>
2858 <span class="comment">%   2   8    0.034665   -0.063435</span>
2859 <span class="comment">%   3   1   -0.066037    0.002726</span>
2860 <span class="comment">%   3   2   -0.000859    0.136815</span>
2861 <span class="comment">%   3   3    0.005278   -0.203492</span>
2862 <span class="comment">%   3   4    0.012004   -0.012404</span>
2863 <span class="comment">%   3   5   -0.019908    0.055614</span>
2864 <span class="comment">%   3   6   -0.002221   -0.089575</span>
2865 <span class="comment">%   3   7   -0.001831   -0.125075</span>
2866 <span class="comment">%   3   8    0.002154    0.032087</span>
2867 <span class="comment">%   4   1   -0.003133    0.071877</span>
2868 <span class="comment">%   4   2    0.014281   -0.002156</span>
2869 <span class="comment">%   4   3   -0.008564   -0.015328</span>
2870 <span class="comment">%   4   4   -0.006155   -0.087721</span>
2871 <span class="comment">%   4   5   -0.072595   -0.035561</span>
2872 <span class="comment">%   4   6    0.089426   -0.031385</span>
2873 <span class="comment">%   4   7   -0.051357    0.030795</span>
2874 <span class="comment">%   5   1    0.052918    0.072909</span>
2875 <span class="comment">%   5   2   -0.030896   -0.097133</span>
2876 <span class="comment">%   5   3    0.008768    0.026373</span>
2877 <span class="comment">%   5   4    0.033223    0.053668</span>
2878 <span class="comment">%   5   5   -0.007694    0.023427</span>
2879 <span class="comment">%   5   6   -0.029986    0.035607</span>
2880 <span class="comment">%   5   7   -0.002398    0.014364</span>
2881 <span class="comment">%   6   1    0.005333   -0.030141</span>
2882 <span class="comment">%   6   2    0.019401    0.023267</span>
2883 <span class="comment">%   6   3   -0.013229   -0.071641</span>
2884 <span class="comment">%   6   4   -0.038290    0.057127</span>
2885 <span class="comment">%   6   5    0.044439    0.032870</span>
2886 <span class="comment">%   6   6   -0.033921   -0.006965</span>
2887 <span class="comment">%   6   7    0.034656    0.009146</span>
2888 <span class="comment">%   6   8   -0.020039   -0.026317</span>
2889 <span class="comment">%   7   1    0.021750    0.100296</span>
2890 <span class="comment">%   7   2   -0.044471   -0.118606</span>
2891 <span class="comment">%   7   3    0.023370   -0.006066</span>
2892 <span class="comment">%   7   4   -0.010557    0.077161</span>
2893 <span class="comment">%   7   5    0.023680    0.111695</span>
2894 <span class="comment">%   7   6   -0.116233    0.089491</span>
2895 <span class="comment">%   7   7    0.124305   -0.080779</span>
2896 <span class="comment">%   7   8   -0.015208    0.036310</span>
2897 <span class="comment">%   8   1   -0.010741   -0.009796</span>
2898 <span class="comment">%   8   2    0.020530   -0.024978</span>
2899 <span class="comment">%   8   3   -0.008444    0.043667</span>
2900 <span class="comment">%   8   4   -0.025326   -0.012376</span>
2901 <span class="comment">%   8   5   -0.035473    0.007320</span>
2902 <span class="comment">%   8   6    0.065758    0.055126</span>
2903 <span class="comment">%   8   7   -0.036453    0.023429</span>
2904 <span class="comment">%   9   1    0.029467   -0.053588</span>
2905 <span class="comment">%   9   2    0.001633   -0.006234</span>
2906 <span class="comment">%   9   3    0.005615    0.007891</span>
2907 <span class="comment">%   9   4   -0.062090   -0.002766</span>
2908 <span class="comment">%   9   5    0.001910    0.010628</span>
2909 <span class="comment">%   9   6    0.058936    0.007838</span>
2910 <span class="comment">%   9   7   -0.042798    0.072547</span>
2911 <span class="comment">%  10   1    0.045262    0.073408</span>
2912 <span class="comment">%  10   2    0.028056   -0.154367</span>
2913 <span class="comment">%  10   3   -0.012088   -0.011784</span>
2914 <span class="comment">%  10   4   -0.073822    0.088175</span>
2915 <span class="comment">%  10   5    0.057591    0.178638</span>
2916 <span class="comment">%  10   6    0.064805    0.124674</span>
2917 <span class="comment">%  10   7   -0.081578    0.138036</span>
2918 <span class="comment">%  10   8   -0.024542   -0.172935</span>
2919 <span class="comment">%  11   1    0.046510    0.017614</span>
2920 <span class="comment">%  11   2    0.062073    0.000009</span>
2921 <span class="comment">%  11   3   -0.037480   -0.060397</span>
2922 <span class="comment">%  11   4   -0.041096    0.146472</span>
2923 <span class="comment">%  11   5    0.032956    0.081438</span>
2924 <span class="comment">%  11   6    0.018984    0.048677</span>
2925 <span class="comment">%  11   7   -0.033127   -0.079176</span>
2926 <span class="comment">%  11   8   -0.010214   -0.112762</span>
2927 <span class="comment">%  12   1    0.024785    0.113373</span>
2928 <span class="comment">%  12   2   -0.004146   -0.072407</span>
2929 <span class="comment">%  12   3    0.005921    0.070591</span>
2930 <span class="comment">%  12   4   -0.068544   -0.015913</span>
2931 <span class="comment">%  12   5    0.069606   -0.052789</span>
2932 <span class="comment">%  12   6   -0.014413    0.044067</span>
2933 <span class="comment">%  12   7   -0.033711    0.029776</span>
2934 <span class="comment">%  13   1    0.049872    0.020370</span>
2935 <span class="comment">%  13   2   -0.026395   -0.149377</span>
2936 <span class="comment">%  13   3    0.003372    0.039093</span>
2937 <span class="comment">%  13   4    0.062395    0.114775</span>
2938 <span class="comment">%  13   5   -0.023654    0.034983</span>
2939 <span class="comment">%  13   6   -0.046041    0.074071</span>
2940 <span class="comment">%  13   7    0.015033    0.025198</span>
2941 <span class="comment">%  14   1   -0.017785    0.007114</span>
2942 <span class="comment">%  14   2    0.014314   -0.103821</span>
2943 <span class="comment">%  14   3   -0.007818    0.005819</span>
2944 <span class="comment">%  14   4   -0.046975    0.152992</span>
2945 <span class="comment">%  14   5    0.040307    0.106990</span>
2946 <span class="comment">%  14   6    0.024887    0.000457</span>
2947 <span class="comment">%  14   7   -0.030497   -0.099698</span>
2948 <span class="comment">%  14   8   -0.015308    0.088554</span>
2949 <span class="comment">%  15   1    0.022300    0.006944</span>
2950 <span class="comment">%  15   2    0.023296   -0.082432</span>
2951 <span class="comment">%  15   3   -0.012034    0.129612</span>
2952 <span class="comment">%  15   4   -0.076630    0.008548</span>
2953 <span class="comment">%  15   5    0.074119   -0.030656</span>
2954 <span class="comment">%  15   6    0.014081   -0.082962</span>
2955 <span class="comment">%  15   7   -0.026948    0.012078</span>
2956 <span class="comment">%  15   8    0.013663   -0.070121</span>
2957 <span class="comment">%  16   1   -0.026518    0.147481</span>
2958 <span class="comment">%  16   2    0.002385   -0.127930</span>
2959 <span class="comment">%  16   3    0.006044   -0.040092</span>
2960 <span class="comment">%  16   4   -0.066371    0.131605</span>
2961 <span class="comment">%  16   5    0.044381    0.027604</span>
2962 <span class="comment">%  16   6    0.013263    0.111982</span>
2963 <span class="comment">%  16   7   -0.018533   -0.015504</span>
2964 <span class="comment">%   1   1    0.014970   -0.090054</span>
2965 <span class="comment">%  ];</span>
2966 
2967 <span class="comment">% Golden ci dessous orbite su 23 avril 2007</span>
2968 Golden = [
2969   1   2   -0.006983   -0.027905
2970   1   3   -0.003142   -0.015461
2971   1   4    0.016421    0.040723
2972   1   5   -0.114860    0.070363
2973   1   6    0.114470    0.077863
2974   1   7   -0.017136    0.142959
2975   2   1   -0.002380   -0.119856
2976   2   2    0.020268   -0.037834
2977   2   3   -0.016944    0.036558
2978   2   4    0.004818    0.125072
2979   2   5    0.003800    0.055701
2980   2   6   -0.067714   -0.020920
2981   2   7    0.064931   -0.124026
2982   2   8    0.030373   -0.049196
2983   3   1   -0.067756    0.042688
2984   3   2    0.005212    0.106980
2985   3   3   -0.000994   -0.206161
2986   3   4    0.008764   -0.040780
2987   3   5   -0.012362    0.065270
2988   3   6    0.008649   -0.071649
2989   3   7   -0.010105   -0.116539
2990   3   8    0.004831    0.033727
2991   4   1   -0.012951    0.069927
2992   4   2    0.018719   -0.016921
2993   4   3   -0.013218   -0.023794
2994   4   4    0.025955   -0.031911
2995   4   5   -0.087577   -0.055929
2996   4   6    0.073246   -0.043108
2997   4   7   -0.051022    0.013304
2998   5   1    0.054389    0.066226
2999   5   2   -0.030216   -0.082380
3000   5   3    0.014207    0.015782
3001   5   4    0.018652    0.040588
3002   5   5    0.007467    0.018579
3003   5   6   -0.035390    0.023740
3004   5   7   -0.011514    0.007948
3005   6   1    0.021412   -0.013609
3006   6   2    0.019742    0.016051
3007   6   3   -0.014610   -0.070518
3008   6   4   -0.012430    0.038418
3009   6   5    0.011704    0.077612
3010   6   6   -0.021676   -0.055172
3011   6   7    0.019028   -0.064592
3012   6   8   -0.017033   -0.085768
3013   7   1    0.027233    0.110291
3014   7   2   -0.044686   -0.035923
3015   7   3    0.025766   -0.035378
3016   7   4   -0.018853   -0.022782
3017   7   5    0.026612    0.040724
3018   7   6   -0.119231    0.069974
3019   7   7    0.122805   -0.064904
3020   7   8   -0.016395    0.040026
3021   8   1   -0.002400   -0.010129
3022   8   2    0.022870   -0.036095
3023   8   3   -0.014112    0.035739
3024   8   4   -0.020547    0.006218
3025   8   5   -0.043064    0.018189
3026   8   6    0.071954    0.071437
3027   8   7   -0.034260    0.040567
3028   9   1    0.028537   -0.064069
3029   9   2   -0.010896   -0.014936
3030   9   3    0.012216   -0.004277
3031   9   4   -0.068464    0.027311
3032   9   5    0.009988    0.010894
3033   9   6    0.063530    0.017090
3034   9   7   -0.053769    0.063549
3035  10   1    0.062576    0.054632
3036  10   2    0.017741   -0.146863
3037  10   3   -0.010410   -0.007074
3038  10   4   -0.074049    0.078694
3039  10   5    0.064659    0.188452
3040  10   6    0.069572    0.152665
3041  10   7   -0.079175    0.118005
3042  10   8   -0.029903   -0.160250
3043  11   1    0.050193    0.037427
3044  11   2    0.055632   -0.042655
3045  11   3   -0.035655   -0.054405
3046  11   4   -0.036151    0.149242
3047  11   5    0.035143    0.116151
3048  11   6    0.028927    0.086803
3049  11   7   -0.035726   -0.064940
3050  11   8   -0.011351   -0.092493
3051  12   1    0.021298    0.086223
3052  12   2    0.018891   -0.081681
3053  12   3   -0.006108    0.093825
3054  12   4   -0.073790   -0.017286
3055  12   5    0.077053   -0.049686
3056  12   6   -0.015203    0.047587
3057  12   7   -0.030149    0.022547
3058  13   1    0.046047    0.008691
3059  13   2   -0.022754   -0.168597
3060  13   3    0.003678    0.050055
3061  13   4    0.056820    0.126502
3062  13   5   -0.025694    0.041400
3063  13   6   -0.039813    0.096348
3064  13   7    0.014860    0.042901
3065  14   1   -0.018464   -0.017584
3066  14   2    0.025080   -0.093626
3067  14   3   -0.012440    0.002405
3068  14   4   -0.057945    0.140560
3069  14   5    0.051345    0.101783
3070  14   6    0.024152    0.011598
3071  14   7   -0.033475   -0.116291
3072  14   8   -0.001281    0.101211
3073  15   1   -0.002106    0.013078
3074  15   2    0.019324   -0.106988
3075  15   3   -0.007300    0.136143
3076  15   4   -0.070168    0.021354
3077  15   5    0.067422   -0.004631
3078  15   6    0.013393   -0.080552
3079  15   7   -0.025907    0.012427
3080  15   8    0.006644   -0.071089
3081  16   1   -0.015333    0.132740
3082  16   2    0.007727   -0.131224
3083  16   3    0.002030   -0.023141
3084  16   4   -0.067771    0.132597
3085  16   5    0.044049    0.024878
3086  16   6    0.014250    0.105506
3087  16   7   -0.017992   -0.006555
3088   1   1    0.017883   -0.087854
3089   ];
3090 
3091 
3092 setfamilydata(Golden(:,3),<span class="string">'BPMx'</span>,<span class="string">'Golden'</span>,Golden(:,1:2));
3093 setfamilydata(Golden(:,4),<span class="string">'BPMz'</span>,<span class="string">'Golden'</span>,Golden(:,1:2));
3094 
3095 <a name="_sub1" href="#_subfunctions" class="code">function setfamilydata_local(Family)</a>
3096 <span class="comment">% set all data in one command</span>
3097 
3098 <span class="keyword">if</span> ismemberof(Family,<span class="string">'QUAD'</span>) || ismemberof(Family,<span class="string">'COR'</span>) || <span class="keyword">...</span>
3099         ismemberof(Family,<span class="string">'COR'</span>) || ismemberof(Family,<span class="string">'SEXT'</span>) || <span class="keyword">...</span>
3100         ismemberof(Family,<span class="string">'BPM'</span>) || ismemberof(Family,<span class="string">'BEND'</span>)
3101     setfamilydata(1,Family,<span class="string">'Gain'</span>);
3102     setfamilydata(0,Family,<span class="string">'Offset'</span>);
3103     setfamilydata(0,Family,<span class="string">'Coupling'</span>);
3104 <span class="keyword">end</span>
3105 
3106 <span class="keyword">if</span> ismemberof(Family,<span class="string">'BPM'</span>)
3107     setfamilydata(0.001,Family,<span class="string">'Sigma'</span>);
3108     setfamilydata(0.0,Family,<span class="string">'Golden'</span>);
3109     setfamilydata(measdisp(Family,<span class="string">'struct'</span>,<span class="string">'model'</span>),Family,<span class="string">'Dispersion'</span>); <span class="comment">% needed for orbit correction w/ RF</span>
3110 <span class="keyword">end</span>
3111 
3112 <span class="comment">% Order fields for all families</span>
3113 AO = getao;
3114 Familylist = getfamilylist;
3115 <span class="keyword">for</span> k = 1:length(Familylist),
3116     FamilyName = deblank(Familylist(k,:));
3117     AO.(FamilyName) = orderfields(AO.(FamilyName));
3118     FieldNamelist = fieldnames(AO.(FamilyName));
3119     <span class="keyword">for</span> k1 = 1:length(FieldNamelist);
3120         FieldName = FieldNamelist{k1};
3121         <span class="keyword">if</span> isstruct((AO.(FamilyName).(FieldName)))
3122             AO.(FamilyName).(FieldName) = orderfields(AO.(FamilyName).(FieldName));
3123         <span class="keyword">end</span>
3124     <span class="keyword">end</span>
3125 <span class="keyword">end</span>
3126 setao(AO)
3127</pre></div>
<hr><address>Generated on Mon 21-May-2007 15:35:27 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>